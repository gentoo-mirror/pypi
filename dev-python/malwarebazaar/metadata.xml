<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># malwarebazaar**A [MalwareBazaar](https://bazaar.abuse.ch) and [YARAify](https://yaraify.abuse.ch) API wrapper and CLI**This python module provides a Python API for MalwareBazaar as well as YARAify which can be used very easy toaccess both APIs:```pythonfrom malwarebazaar import Bazaar, Yaraifyb = Bazaar(    api_key=&quot;my_api_key&quot;)b.query_hash(...)y = Yaraify(    api_key=&quot;my_api_key&quot;,    malpedia_key=&quot;optional_malpedia_api_key&quot;)y.query_hash(...)```Optionally, this module provides a CLI for both services, too:```text$ bazaar --help Usage: bazaar [OPTIONS] COMMAND [ARGS]...                                                                                                                                                         Query MalwareBazaar from the command line!                                                                                                                                                       ╭─ Options ─────────────────────────────────────────────────────────────────────────────────────╮│ --install-completion        [bash|zsh|fish|powershell|pwsh]  Install completion for the       ││                                                              specified shell.                 ││                                                              [default: None]                  ││ --show-completion           [bash|zsh|fish|powershell|pwsh]  Show completion for the          ││                                                              specified shell, to copy it or   ││                                                              customize the installation.      ││                                                              [default: None]                  ││ --help                                                       Show this message and exit.      │╰───────────────────────────────────────────────────────────────────────────────────────────────╯╭─ Commands ────────────────────────────────────────────────────────────────────────────────────╮│ batch    Download daily malware batches. The DATE_STR argument needs to be in the format of   ││          YYYY-mm-dd.                                                                          ││ init     Initialize bazaar config file.                                                       ││ query    Query the MalwareBazaar API.                                                         ││ recent   Get information about recently submitted samples. The API allows either the last 100 ││          samples or samples uploaded in the last 60 minutes. As the amount is quite big, the  ││          default output type is csv.                                                          ││ version  Print and check bazaar version.                                                      │╰───────────────────────────────────────────────────────────────────────────────────────────────╯``````text$ yaraify --help Usage: yaraify [OPTIONS] COMMAND [ARGS]...                                                                                                                                                        Query YARAify from your command line!                                                                                                                                                            ╭─ Options ─────────────────────────────────────────────────────────────────────────────────────╮│ --install-completion        [bash|zsh|fish|powershell|pwsh]  Install completion for the       ││                                                              specified shell.                 ││                                                              [default: None]                  ││ --show-completion           [bash|zsh|fish|powershell|pwsh]  Show completion for the          ││                                                              specified shell, to copy it or   ││                                                              customize the installation.      ││                                                              [default: None]                  ││ --help                                                       Show this message and exit.      │╰───────────────────────────────────────────────────────────────────────────────────────────────╯╭─ Commands ────────────────────────────────────────────────────────────────────────────────────╮│ download           Download all TLP:CLEAR YARAify rules.                                      ││ get                Fetch Yara rule by its UUID                                                ││ init               Initialize YARAify cli.                                                    ││ query              Query the YARAify API.                                                     ││ recent             Query for recent Yara rules.                                               ││ task               Fetch task results                                                         ││ version            Print and check yaraify version.                                           │╰───────────────────────────────────────────────────────────────────────────────────────────────╯```## InstallationUsually, this module will be distributed via PyPI. If you want to use pre-release versions, check the release section ofthis repository. If you don't intent to use the CLI, you do not need to install the &quot;cli eye candy modules&quot; and stick tothe pure Python API via:```pip install malwarebazaar```If you want to use the CLI, you need to include the `cli` extra:```pip install malwarebazaar[cli]```_**Note**: Previous versions also included pre-built binaries, however, I stopped adding them.Please just use a local python environment instead._## Usage### Python API```pythonfrom malwarebazaar import Bazaar, Yaraifyfrom malwarebazaar.models import Sample, YaraRuleb = Bazaar(    api_key=&quot;myapikey&quot;)y = Yaraify(    api_key=&quot;myapikey&quot;)response = b.query_recent()samples = [Sample(**sample_dict) for sample_dict in response[&quot;data&quot;]]file_content = b.download_file(samples[0].sha256_hash)  # or response[&quot;data&quot;][0][&quot;sha256_hash&quot;]response = y.query_recent_yara()yaras = [YaraRule(**yara_dict) for yara_dict in response[&quot;data&quot;]]for yara in yaras:    if yara.rule_name != &quot;classified&quot;:        rule = y.download_yara(yara.yarahub_uuid)        print(rule)        break```There is no dedicated API documentation, however, the function names are pretty self-explanatory and you can just takea look at the respective API functions here:- Bazaar: [bazaar.py](malwarebazaar/api/bazaar.py)- YARAify: [yaraify.py](malwarebazaar/api/yaraify.py)### CLIThis module provides two CLI commands: `bazaar` and `yaraify`.They use the same configuration file and must be initialized with the specific API key before they can be used.Optionally, auto-completion can be installed for your shell via `bazaar --install-completion &lt;shell&gt;` (same for`yaraify`).#### `bazaar` example```text$ bazaar init myapikeySuccessfully set API-Key!$ bazaar query hash f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807                ╷                                                                                  Filename      │ 03891ab57eb301579005f62953dfd21e.exe                                             Filesize      │ 21504 bytes                                                                      Filetype      │ application/x-dosexec                                                            Sightings     │ First-Seen: 2021-06-04 07:22:18                                                                │ Last-Seen:  None                                                                               │ Sightings:  None                                                                 Hashes        │ MD5:        03891ab57eb301579005f62953dfd21e                                                   │ SHA1:       41efd56ea49b72c6dd53b5341f295e549b1b64a5                                           │ SHA256:     f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807                   │ SHA3-384:                                                                                      │ 72399548d0b0c9c679b3c492bef7f5df38f24e772d0897116b443937c16102fe2b9009aa2f2d0                  │ b534ac7bfb710e4a394                                                                            │ Icon Dhash: None                                                                 Import Hashes │ Imphash:    f34d5f2d4577ed6d9ceec516c1f5a744                                                   │ Gimphash:   None                                                                               │ Telfhash:   None                                                                 Fuzzy Hashes  │ Ssdeep:     384:/SkWXcoDeR7tojS+hsQjouy9lda2zEaNc5jPp:Acie1Cj9hsQDOXEr                         │ Tlsh:                                                                                          │ 04A2196433DCD671ECEB0B71AAB28644E6F5F4855802FB2B1AC481C759A3758CE32793                         │                                                                                  Signature     │ RedLineStealer                                                                   Tags          │ exe, RedLineStealer                                                                            ╵                                                                                             ╷            ╷               ╷                                 ANY.RUN    │ No family  │ CERT-PL_MWDB  │ Undetected                                 │ malicious  │               │                                            │            │               │                                 YOROI_YOMI │ suspicious │ vxCube        │ malicious                                  │            │               │                                 InQuest    │ malicious  │ CAPE          │ RedLine                                    │            │               │                                 Triage     │ redline    │ ReversingLabs │ ByteCode-MSIL.Trojan.Wacatac               │ malicious  │               │ malicious                                  │            │               │                                 UnpacMe    │ Undetected │               │                                            │            │               │                                            │            │               │                                            ╵            ╵               ╵                               $ bazaar download f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807$ file f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807.zip f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807.zip: Zip archive data, at least v5.1 to extract$ bazaar download f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807 --unzip$ file f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807.exe f670080b1f42d1b70a37adda924976e6d7bd62bf77c35263aff97e7968291807.exe: PE32 executable (GUI) Intel 80386 Mono/.Net assembly, for MS Windows$ bazaar recent -s -l5c2ae8ce5833306a5f311cf95a75271d9f25c037f177f935dff1d27b99b9af549 [Undetected] [@andretavare5] (exe)b885520ef95e0c2159243d800bda652bd2b787098a9e1d29718a6e73b1204a36 [Undetected] [@andretavare5] (exe)8b4fa170c0a68f07870823524579484ec7ba31b058ae80e23b8a29d3bfe96d84 [Undetected] [@andretavare5] (exe)ed3d540886144d18a9f15c349cff1a89080dbb9e62ad224efbe83307af3171f2 [NanoCore] [@abuse_ch] (exe, NanoCore, RAT)26507309b1d73937d7f62b28e9065e1fe94a74b3b293b263140370fa6cfa90f8 [Undetected] [@andretavare5] (exe)```#### `yaraify` example```text$ yaraify init myapikey --malpedia mymalpediaapikeySuccessfully created config:{&quot;api_key&quot;: &quot;bazaar_api_key&quot;, &quot;yaraify&quot;: {&quot;api_key&quot;: &quot;myapikey&quot;, &quot;malpedia_key&quot;: &quot;mymalpediaapikey&quot;, &quot;csv_columns&quot;: {&quot;rule_name&quot;: &quot;rule_name&quot;, &quot;author&quot;: &quot;author&quot;, &quot;uuid&quot;: &quot;yarahub_uuid&quot;}}, &quot;csv_columns&quot;: {&quot;md5&quot;: &quot;md5_hash&quot;, &quot;sha1&quot;: &quot;sha1_hash&quot;, &quot;sha256&quot;: &quot;sha256_hash&quot;, &quot;imphash&quot;: &quot;imphash&quot;, &quot;signature&quot;: &quot;signature&quot;, &quot;tags&quot;: &quot;tags&quot;}}$ yaraify query hash 7a6fcc2f0115c73bc66e9eacf74af4e5c11b06d600fd2038a289d5ee2163d459Sample 1/1                ╷                                                                                  Filename      │ None                                                                             Filesize      │ 2691072 bytes                                                                    Filetype      │ application/x-dosexec                                                            Sightings     │ First-Seen: 2022-12-22 11:35:25                                                                │ Last-Seen:  None                                                                               │ Sightings:  1                                                                    Hashes        │ MD5:        6ae5d1343e41801bf5a501055f43818d                                                   │ SHA1:       18d068b535785ec16d56c0f421addb35232fe377                                           │ SHA256:     7a6fcc2f0115c73bc66e9eacf74af4e5c11b06d600fd2038a289d5ee2163d459                   │ SHA3-384:                                                                                      │ cc7dab7054f50e9bdcef92d4bdfbc2b27bcca1ea025f2d340703083ae819a2c6e312c20317804                  │ 078a4ce124e91f74a64                                                                            │ Icon Dhash: None                                                                 Import Hashes │ Imphash:    5c7397fd7c1832e37a3cb00b6ee7c377                                                   │ Gimphash:   None                                                                               │ Telfhash:   None                                                                 Fuzzy Hashes  │ Ssdeep:                                                                                        │ 49152:NWrMtlmeF2RBzD8CSkkZA2loXISPEB8ClDl1mZDdeP7RWUOIQ:aMtlmeF2RBz1SkkZAKWIS                  │ YFgDoPl8IQ                                                                                     │ Tlsh:                                                                                          │ T14EC5AE83B7C690F1DB963030051F976EEA7DBE285C749607B3A13A6F69302016B2D79D                       │                                                                                                ╵                                                                                Task 1/1                     ╷                                                   Task ID            │ ba3f2653-81ec-11ed-a7d0-42010aa4000b              YARAify Parameters │ ClamAV ✔ Unpack ✖ Share ✔                         Detections         │ Clam-AV:     No Clam-AV results                                      │ Name:        BitcoinAddress                                          │ Author:      Didier Stevens (@DidierStevens)                         │ Description: Contains a valid Bitcoin address                        │ TLP:         WHITE                                                   │                                                                      │ Name:        malware_shellcode_hash                                  │ Author:      JPCERT/CC Incident Response Group                       │ Description: detect shellcode api hash value                         │ TLP:         WHITE                                                   │                                                                      │ Name:        meth_get_eip                                            │ Author:      Willi Ballenthin                                        │ Description: No description provided.                                │ TLP:         WHITE                                                   │                                                                      │ Name:        pdb_YARAify                                             │ Author:      @wowabiy314                                             │ Description: PDB                                                     │ TLP:         WHITE                                                   │                                                                      ╵                             $ yaraify recent -s -l 5classified [classified] (4e00e916-1b7a-4020-b64a-701ff3390ca9)classified [classified] (8f965345-b8d2-4a55-a9c3-2ff23a03ed1e)win_aurora_stealer_a_706a [@viql] (706a5977-69fb-44ae-bfa7-f61e214148e7)classified [classified] (5d5e97ac-33f7-4823-9534-ca969d135556)win_phorpiex_a_84fc [@viql] (84fc2940-d204-4d75-9f17-89cce6b1dea2)$ yaraify get 706a5977-69fb-44ae-bfa7-f61e214148e7rule win_aurora_stealer_a_706a {    meta:        author                    = &quot;Johannes Bader&quot;        date                      = &quot;2022-12-14&quot;        description               = &quot;detects Aurora Stealer samples&quot;        hash1_md5                 = &quot;51c153501e991f6ce4901e6d9578d0c8&quot;        hash1_sha1                = &quot;3816f17052b28603855bde3e57db77a8455bdea4&quot;        hash1_sha256              = &quot;c148c449e1f6c4c53a7278090453d935d1ab71c3e8b69511f98993b6057f612d&quot;        hash2_md5                 = &quot;65692e1d5b98225dbfb1b6b2b8935689&quot;        hash2_sha1                = &quot;0b51765c175954c9e47c39309e020bcb0f90b783&quot;        hash2_sha256              = &quot;5a42aa4fc8180c7489ce54d7a43f19d49136bd15ed7decf81f6e9e638bdaee2b&quot;        malpedia_family           = &quot;win.aurora_stealer&quot;        tlp                       = &quot;TLP:WHITE&quot;        version                   = &quot;v1.0&quot;        yarahub_author_email      = &quot;yara@bin.re&quot;        yarahub_author_twitter    = &quot;@viql&quot;        yarahub_license           = &quot;CC BY-SA 4.0&quot;        yarahub_reference_md5     = &quot;51c153501e991f6ce4901e6d9578d0c8&quot;        yarahub_rule_matching_tlp = &quot;TLP:WHITE&quot;        yarahub_rule_sharing_tlp  = &quot;TLP:WHITE&quot;        yarahub_uuid              = &quot;706a5977-69fb-44ae-bfa7-f61e214148e7&quot;    strings:        $str_func_01 = &quot;main.(*DATA_BLOB).ToByteArray&quot;        $str_func_02 = &quot;main.Base64Encode&quot;        $str_func_03 = &quot;main.Capture&quot;        $str_func_04 = &quot;main.CaptureRect&quot;        $str_func_05 = &quot;main.ConnectToServer&quot;        $str_func_06 = &quot;main.CreateImage&quot;        $str_func_07 = &quot;main.FileExsist&quot;        $str_func_08 = &quot;main.GetDisplayBounds&quot;        $str_func_09 = &quot;main.GetInfoUser&quot;        $str_func_10 = &quot;main.GetOS&quot;        $str_func_11 = &quot;main.Grab&quot;        $str_func_12 = &quot;main.MachineID&quot;        $str_func_13 = &quot;main.NewBlob&quot;        $str_func_14 = &quot;main.NumActiveDisplays&quot;        $str_func_15 = &quot;main.PathTrans&quot;        $str_func_16 = &quot;main.SendToServer_NEW&quot;        $str_func_17 = &quot;main.SetUsermame&quot;        $str_func_18 = &quot;main.Zip&quot;        $str_func_19 = &quot;main.base64Decode&quot;        $str_func_20 = &quot;main.countupMonitorCallback&quot;        $str_func_21 = &quot;main.enumDisplayMonitors&quot;        $str_func_22 = &quot;main.getCPU&quot;        $str_func_23 = &quot;main.getDesktopWindow&quot;        $str_func_24 = &quot;main.getGPU&quot;        $str_func_25 = &quot;main.getMasterKey&quot;        $str_func_26 = &quot;main.getMonitorBoundsCallback&quot;        $str_func_27 = &quot;main.getMonitorRealSize&quot;        $str_func_28 = &quot;main.sysTotalMemory&quot;        $str_func_29 = &quot;main.xDecrypt&quot;        $str_type_01 = &quot;type..eq.main.Browser_G&quot;        $str_type_02 = &quot;type..eq.main.STRUSER&quot;        $str_type_03 = &quot;type..eq.main.Telegram_G&quot;        $str_type_04 = &quot;type..eq.main.Crypto_G&quot;        $str_type_05 = &quot;type..eq.main.ScreenShot_G&quot;        $str_type_06 = &quot;type..eq.main.FileGrabber_G&quot;        $str_type_07 = &quot;type..eq.main.FTP_G&quot;        $str_type_08 = &quot;type..eq.main.Steam_G&quot;        $str_type_09 = &quot;type..eq.main.DATA_BLOB&quot;        $str_type_10 = &quot;type..eq.main.Grabber&quot;        $varia_01 = &quot;\\User Data\\Local State&quot;        $varia_02 = &quot;\\\\Opera Stable\\\\Local State&quot;        $varia_03 = &quot;Reconnect 1&quot;        $varia_04 = &quot;@ftmone&quot;        $varia_05 = &quot;^user^&quot;        $varia_06 = &quot;wmic path win32_VideoController get name&quot;        $varia_07 = &quot;\\AppData\\Roaming\\Telegram Desktop\\tdata&quot;        $varia_08 = &quot;C:\\Windows.old\\Users\\&quot;        $varia_09 = &quot;ScreenShot&quot;        $varia_10 = &quot;Crypto&quot;    condition:        uint16(0) == 0x5A4D and        (            32 of ($str_*) or            9 of ($varia_*)        )}```</longdescription>
</pkgmetadata>