<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># ACT Workers## IntroductionThis repository contains workers for the [ACT platform](https://github.com/mnemonic-no/act-platform).The source code the workers are available on [github](https://github.com/mnemonic-no/act-workers).# Changelog## 2.0.0* Configuration is moved from `~/.config/actworkers/actworkers.ini` to `~/.config/act/act.ini`* The old scio worker is removed and the new scio-worker (act-scio2) is renamed to act-scio# SetupTo use the workers, install from PyPi:```bashsudo pip3 install act-workers```This will install scripts for all workers:* act-argus-case* act-attack* act-country-regions* act-fact-chain-helper (see usage below)* act-feed* act-ip-filter* act-misp-feeds* act-mnemonic-pdns* act-scio* act-search-graph* act-shadowserver-asn* act-uploader* act-url-shorter-unpack* act-ta-helper (see usage below)* act-veris* act-vt# OriginsAll workers support the optional arguments --origin-name and --origin-id. If they are not specified, facts will be added with the origin of the user performing the upload to the platform.For managing origins, use the tool `act-origin` in `act-admin` package on pypi.# Access modeBy default, all facts will have access-mode &quot;RoleBased&quot;, which means that the user needs access to the organization specified when creating the facts.The access mode can be explicit set with `--access-mode`, e.g. like this, to set all facts to Public access mode:```--access-mode Public```There are also some workers, e.g. `act-scio` and `act-mnemoninc-pdns` that will set access-mode based on the input document (TLP green/white -&gt; access-mode=Public), unless you explicit configures it to not do so.# OrganizationAll workers support the optional arguments `--organization` If they are not specified, facts will be added with the organization of the origin or the user performing the upload to the platform (if not set by the origin.# Worker usageTo print facts to stdout:```bash$ act-country-regions{&quot;type&quot;: &quot;memberOf&quot;, &quot;value&quot;: &quot;&quot;, &quot;accessMode&quot;: &quot;Public&quot;, &quot;sourceObject&quot;: {&quot;type&quot;: &quot;country&quot;, &quot;value&quot;: &quot;Afghanistan&quot;}, &quot;destinationObject&quot;: {&quot;type&quot;: &quot;subRegion&quot;, &quot;value&quot;: &quot;Southern Asia&quot;}, &quot;bidirectionalBinding&quot;: false}{&quot;type&quot;: &quot;memberOf&quot;, &quot;value&quot;: &quot;&quot;, &quot;accessMode&quot;: &quot;Public&quot;, &quot;sourceObject&quot;: {&quot;type&quot;: &quot;subRegion&quot;, &quot;value&quot;: &quot;Southern Asia&quot;}, &quot;destinationObject&quot;: {&quot;type&quot;: &quot;region&quot;, &quot;value&quot;: &quot;Asia&quot;}, &quot;bidirectionalBinding&quot;: false}(...)```Or print facts as text representation:```bash$ act-country-regions --output-format str(country/Afghanistan) -[memberOf]-&gt; (subRegion/Southern Asia)(subRegion/Southern Asia) -[memberOf]-&gt; (region/Asia)(...)```To add facts directly to the platform, include the act-baseurl and user-id options:```bash$ act-country-regions --act-baseurl http://localhost:8888 --user-id 1```# ConfigurationAll workers support options specified as command line arguments, environment variables and in a configuration file.A utility to show and start with a default ini file is also included:```bashact-worker-config --helpusage: ACT worker config [-h] {show,user,system}positional arguments:  {show,user,system}optional arguments:  -h, --help          show this help message and exit    show - Print default config    user - Copy default config to /home/fredrikb/.config/actworkers/actworkers.ini    system - Copy default config to /etc/actworkers.ini```You can see the default options in [act/workers/etc/actworkers.ini](act/workers/etc/actworkers.ini).The configuration presedence are (from lowest to highest):1. Defaults (shown in --help for each worker)2. INI file3. Environment variable4. Command line argument## INI-fileArguments are parsed in two phases. First, it will look for the argument --config argumentwhich can be used to specify an alternative location for the ini file. If not --config argumentis given it will look for an ini file in the following locations:    /etc/&lt;CONFIG_FILE_NAME&gt;    ~/.config/&lt;CONFIG_ID&gt;/&lt;CONFIG_FILE_NAME&gt; (or directory specified by $XDG_CONFIG_HOME)The ini file contains a &quot;[DEFAULT]&quot; section that will be used for all workers.In addition there are separate sections for each worker which you can use to configureworker-specific options, and override default options.## Environment variablesThe configuration step will also look for environment variables in uppercase andwith &quot;-&quot; replaced with &quot;_&quot;. For the example for the option &quot;cert-file&quot; it will look for theenviornment variable &quot;$CERT_FILE&quot;.## RequirementsAll workers requires python version &gt;= 3.5 and the act-api library:* [act-api](https://github.com/mnemonic-no/act-api-python) (act-api on [pypi](https://pypi.org/project/act-api/))In addition some of the libraries might have additional requirements. See requirements.txt for a full list of all requirements.# Proxy configurationWorkers will honor the `proxy-string` option on the command line when connecting to external APIs. However, if you need touse the proxy to connect to the ACT platform (--act-baseurl), you will need to add the &quot;--proxy-platform&quot; switch:```bashecho -n www.mnemonic.no | act-vt --proxy-string &lt;PROXY&gt; --user-id &lt;USER-ID&gt; --act-baseurl &lt;ACT-HOST&gt; --proxy-platform```# Local developmentUse pip to install in [local development mode](https://pip.pypa.io/en/stable/reference/pip_install/#editable-installs). act-workers (and act-api) uses namespacing, so it is not compatible with using `setup.py install` or `setup.py develop`.In repository, run:```bashpip3 install --user -e .```# searchA worker to run graph queries is also included. A sample search config is inscluded in `etc/searc_jobs.ini`:```bashact-search-graph etc/search_jobs.ini```# act-feed`act-feed` can be used to download feed bundles from a remote uri. Feed uri must have a file, manifest.json, that lists all bundle files that can be download by the feed worker:```json{     &quot;bundles&quot;: {          &quot;000bd93b8ce1fa2acfa448fa916083d76e64b008e336d6f54ad89f12f4232dcf.gz&quot;: 1636355543,          &quot;0598e898979bc851d58b440a3ea248fe64d9df4d2ab1665da3be73c6d13df411.gz&quot;: 1636681082,          &quot;0c03f87d142345a1bbea0867c145608e70ab2c0ea8282b5e06833f5f2b0f5f04.gz&quot;: 1636366321,     },     &quot;updated&quot;: 1636699081}```A local cache will be stored stored to keep track of the last bundle download, so bundles will not be downloaded multiple times.You can either let act-feed download files to a local directory:```bashact-feed --feed-uri https://act.mnemonic.no/feed --dump-dir [path]```output all facts to stdout:```bashact-feed --feed-uri https://act.mnemonic.no/feed ```or upload facts directory to the platform```bashact-feed --feed-uri https://act.mnemonic.no/feed --act-baseurl [platform UR] --user-id [USERID]```# act-fact-chain-helperThe act-fact-chain-helper is a utility that can be used to add facts chains based on known start and end nodes. This can be usefull when addinginformation from reports where do not have all the information availiable to you.## exampleWe know from a report that the threat actor APT 1 uses the tool Mimikatz```bash$ act-fact-chain-helper --output-format str --start threatActor/apt1 --end tool/mimikatz --avoid mentions --include content(incident/[placeholder[1194f1ba4ea8ded28250a0193327654e5ee305bce03741a3e6f183f03b5c6b35]]) -[attributedTo]-&gt; (threatActor/apt1)(event/[placeholder[1194f1ba4ea8ded28250a0193327654e5ee305bce03741a3e6f183f03b5c6b35]]) -[attributedTo]-&gt; (incident/[placeholder[1194f1ba4ea8ded28250a0193327654e5ee305bce03741a3e6f183f03b5c6b35]])(content/[placeholder[1194f1ba4ea8ded28250a0193327654e5ee305bce03741a3e6f183f03b5c6b35]]) -[observedIn]-&gt; (event/[placeholder[1194f1ba4ea8ded28250a0193327654e5ee305bce03741a3e6f183f03b5c6b35]])(content/[placeholder[1194f1ba4ea8ded28250a0193327654e5ee305bce03741a3e6f183f03b5c6b35]]) -[classifiedAs]-&gt; (tool/mimikatz)```In this case we do need to hint at the tool that it should include the &quot;content&quot; object and avoid &quot;mention&quot; facts.The source and destination is interchangeable. In the example above, the fact chain created by swapping the source and destination is identical.by adding the ```--act-baseurl``` option, the data will be stored to the platform.The tool works by finding the shortest path though the datamodel. The options --avoid and --include will modify the cost of traversing certain nodes or edges. This tool is considered experimental.l.# act-ta-helperYou can use `act-ta-helper` to create facts, including placeholders, for typical scenarios where you have someinformation of TA activity, but not all.This worker should not be used if any of objects listed as placeholders below are known.```bash  --ta THREAT-ACTOR             Threat Actor Name (Required)  --ta-located-in COUNTRY       Country where threat actor is located  --campaign CAMPAIGN           Campaign  --techniques TECHNIQUES       List of techniques (commaseparated).                                Support technique IDs, e.g. T1002 and name                                e.g &quot;Valid Accounts&quot;  --tools TOOLS                 List of tools (commaseparated)  --sectors SECTORS             List of Sectors (commaseparated)  --target-countries COUNTRIES  Target Countries (commaseparated)```You can run the tool with the options above, and add `--output-format str` to se a suggested list of facts.You can then add `--act-baseurl` and `--user-id` to add the facts to a platform instance.You can add all options on a single command line, like this example:```bashact-ta-helper \    --output-format str \    --ta HAFNIUM \    --sectors pharmaceuticals,education,defense,non-profit \    --tools PsExec,Procdump,7-Zip,Nishang,PowerCat,WinRar,SIMPLESEESHARP,SPORTSBALL,ChinaChopper,ASPXSPY,Covenant \    --target-countries &quot;Denmark,United States of America&quot; \    --campaign &quot;Operation Exchange Marauder&quot; \    --ta-located-in China \    --techniques T1588,T1003,T1190,T1560,T1583,T1071,T1114,T1567,T1136,T1021```The following facts/placeholders will be created based on the options (placeholders are marked with [*]):## `ta-located-in`Use this if you know the threat actor name and country where TA is located, but organization is unknown.```threatActor -[attributedTo]-&gt; organization[*] -[locatedIn]-&gt; country```## `campaign`Use this if you know the threat actor and campaign name, but incident is unknown.```threatActor -[attributedTo]-&gt; incident[*] -[attributedTo]-&gt; campaign```## `techniques`Use this if you know the threat actor and technique, but event and incident is unknown.```technique &lt;-[classifiedAs]- event[*] -[attributedTo]-&gt; incident[*] -[attributedTo]-&gt; threatActor```## `tools`Use if tool and threat actor is known, but incident, content and event is unknown.```threatActor &lt;-[attributedTo]- incident[*] &lt;-[observedIn]- content[*] -[classifiedAs]-&gt; tool```## `sectors`Use this if threat actor and target sector is known, but organization and incident is unknown.```threatActor -[attributedTo]-&gt; incident[*] -[targets]-&gt; organization[*] -[memberOf]-&gt; sector```## `target-countries`Use this if threat actor and target country is known, but organization and incident is unknown.```threatActor -[attributedTo]-&gt; incident[*] -[targets]-&gt; organization[*] -[locatedIn]-&gt; country```</longdescription>
</pkgmetadata>