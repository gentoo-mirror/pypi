<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>&lt;h1 align='center'&gt; Steel Toes&lt;/h1&gt;&lt;img src=&quot;https://user-images.githubusercontent.com/22648375/218914190-22fb1188-5587-4152-ae46-6fe7cb770ca2.png&quot; alt=&quot;steel-toes&quot; width=&quot;250&quot; align=right&gt;_a kedro hook to protect against breaking changes to data_[steel-toes](https://steel-toes.kedro.dev/) is a kedro hook designed to prevent stepping on your teammatestoes. It will branch your data automatically based on your git branch, ormanually by passing the branch name into the hook.&gt; see [docs](https://steel-toes.kedro.dev/)## Motivation`kedro` is a ‚ú® fantastic project that allows for super-fast prototyping ofdata pipelines, while yielding production-ready pipelines. `kedro` promotescollaborative projects by giving each team member access to the exact samedata. Team members will often make their own branch of the project and beginwork. Sometimes these changes will break existing functionality. Sometimes wemake mistakes as we develop, and fix them before merging in. Either case can bedetrimental to a teammate working downstream of your changes if not careful.### ü•º Wear the proper PPE during feature development`steel-toes` hooks into your catalog to prevent changing downstream data onyour teammates while developing in parallel.### on_catalog_created and before_pipeline_runWhen your project creates a catalog `steel-toes` will look to see if brancheddata exists, if it does it will swap the filepath to the branched path. So youwill be able to load the latest data from the perspective of any branchsimulaneusly.### after_node_runAfter your node is ran, before saving, `steel-toes` will check if your`filepath` was swapped, if not it will swap it to the branched `filepath`before saving.## Installation`steel-toes` is deployed to pypi and can be `pip` installed.```consolepip install steel-toes```For a real kedro project you should add to your requirements.## SetupTo add `SteelToes` to your kedro&gt;0.18.0 project add an instance of the`SteelToes` hook to your tuple of hooks in src/&lt;project_name&gt;/settings.py.```python# settings.pyfrom steel_toes import SteelToesHOOKS = (SteelToes(),)```### ignore_typesSome datasets have a `_filepath` attribute that is not meant for savingdatasets to and is not needed to be &quot;branched&quot;, and should be ignored fromsteel_toes, for example `SQLQueryDataSet`.```python# settings.pyfrom kedro.extras.datasets.pandas.sql_dataset import SQLQueryDataSet, SQLTableDataSetfrom steel_toes import SteelToesHOOKS = (SteelToes(ignore_types=[SQLQueryDataSet, SQLTableDataSet]),)```## Automatic branch naming`steel_toes` will automatically get the branch name from your git branch.## Override with environment variableIn certain situations such as using `kedro docker` in production, there is nogit branch to pull from. Setting an environment variable before `steel-toes`initializes will set the branch.### set environment variable in the shell```bashSTEEL_TOES_BRANCH='PROD'```### set environment variable with python```bashimport osos.environ[&quot;STEEL_TOES_BRANCH&quot;] = &quot;PROD&quot;```## Example filenamesHere is an example of what filepaths look like when I add parquet catalogentries to the spaceflights project, `steel_toes` will add the branch nameautomatically just before the file extension.```bashSTEEL-TOES |6 DATASETS PROETECTEDX_test: /home/waylon/git/spaceflights/data/X_test_main.pqX_train: /home/waylon/git/spaceflights/data/X_train_main.pqpreprocessed_companies: /home/waylon/git/spaceflights/data/02_intermediate/preprocessed_companies_main.pqpreprocessed_shuttles: /home/waylon/git/spaceflights/data/02_intermediate/preprocessed_shuttles_main.pqmodel_input_table: /home/waylon/git/spaceflights/data/03_primary/model_input_table_main.pqregressor: /home/waylon/git/spaceflights/data/06_models/regressor_main.pickle```## Logs on first runWhen first running your pipeline with `steel-toes` it will start the`_filepath` swap **after_node_run**, since the swapped file does not yet exist.&gt; At this point catalog.load('preprocessed_shuttles') will **not** load the&gt; branched dataset.```bash‚ùØ kedro runINFO     Kedro project spaceflights                                                               session.py:340...INFO     STEEL_TOES:after_node_run 'preprocessed_shuttles.pq' -&gt; 'preprocessed_shuttles_main.pq'  steel_toes.py:102...INFO     Completed 6 out of 6 tasks                                                               sequential_runner.py:85INFO     Pipeline execution completed successfully.                                               runner.py:90```## Logs after dataset existsSubsequent runs of kedro will swap the dataset to the branched filepathimmediately after the catalog has been created.&gt; Now catalog.load('preprocessed_shuttles') **will** load the branched dataset.````bashINFO     Kedro project spaceflights                                                                      session.py:340...INFO     STEEL_TOES:after_catalog_created 'preprocessed_shuttles.pq' -&gt; 'preprocessed_shuttles_main.pq'  steel_toes.py:102...INFO     Completed 6 out of 6 tasks                                                                      sequential_runner.py:85INFO     Pipeline execution completed successfully.                                                      runner.py:90### CLI UsageThe CLI provides a handy interface to clean up your branched datasets.```bash$ steel-toes --helpUsage: steel-toes [OPTIONS] COMMAND [ARGS]...  helpOptions:  -V, --version  Prints version and exits  --help         Show this message and exit.Commands:  clean-branch  finds branch datasets and removes them`````steel-toes` also registers itself as a `kedro` global cli plugin. You can run `kedro clean-branch` to clean your branched data.```bash$ kedro clean-branch --helpUsage: kedro clean-branch [OPTIONS]  finds branch datasets and removes themOptions:  --dryrun                   Displays the files that would be deleted using                             the specified command without actually deleting                             them.  -b, --branch TEXT          git branch to clean files from  -h, --help                 Show this message and exit.```## Cleaning up old branchesTo clean up your current branch, running `kedro clean-branch` will remove allthe datasets that have been swapped to the current branch. Adding `--dryrun`will only log what `steel-toes` intends to do, and will not delete.```‚ùØ kedro clean-branch --dryrunINFO     STEEL_TOES:after_catalog_created 'preprocessed_shuttles.pq' -&gt; 'preprocessed_shuttles_main.pq'                                         steel_toes.py:102...INFO     STEEL_TOES:dryrun-remove | '/home/waylon/git/spaceflights/data/02_intermediate/preprocessed_shuttles_main.pq'                          steel_toes.py:141```Dropping the `--dryrun` flag will delete all the branched datasets.```‚ùØ kedro clean-branchINFO     STEEL_TOES:after_catalog_created 'preprocessed_shuttles.pq' -&gt; 'preprocessed_shuttles_main.pq'                                         steel_toes.py:102...INFO     STEEL_TOES:deleting | '/home/waylon/git/spaceflights/data/02_intermediate/preprocessed_shuttles_main.pq'                          steel_toes.py:141```## Contributing**You're Awesome** for considering a contribution! Contributions are welcome,please check out the [ContributingGuide](https://github.com/WaylonWalker/steel-toes/blob/main/contributing.md)for more information. Please be a positive member of the community and embracefeedback## VersioningWe use [SemVer](https://semver.org/) for versioning. For the versionsavailable, see the [tags on this repository](./tags).## Author[![Waylon Walker](https://avatars1.githubusercontent.com/u/22648375?s=120&amp;v=4)](https://github.com/WaylonWalker) - Waylon Walker - _Original Author_## LicenseThis project is licensed under the MIT License - see the [LICENSE](./LICENSE).file for details</longdescription>
</pkgmetadata>