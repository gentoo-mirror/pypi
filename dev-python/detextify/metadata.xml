<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Detextify## What is this?**TL;DR**: A Python library to remove unwanted pseudo-text from images generated by your favorite generative AI models (Stable Diffusion, Midjourney, DALL¬∑E).| Before                      | After                                  ||-----------------------------|----------------------------------------|| ![before](data/octopus.png) | ![after](data/octopus_detextified.png) |## So, why should I care?We all know generative AI is the coolest thing since sliced bread üçû.But try using any off-the-shelf generative vision model and you'll quickly see that these systems can get... creative with interpretingyour prompts.Specifically, you'll observe all kinds of weird artifacts on your images from extra fingers on hands, to arms coming out of chests,to alien text written in random places.For generative systems to actually be usable in downstream applications, we need to better control these outputsand mitigate unwanted effects.We believe the next frontier for generative AI is about **robustness** and **trust**. In other words, how can we architectthese systems to be controllable, relevant, and predictably consistent with our needs?`Detextify` is the first phase in our vision of robustifying generative AI.If we get this right, we will unlock slews of new applications for generative systems that will change the landscape of human-AI collaboration. üåé## Cute, but what are you actually doing?`Detextify` runs text detection on your image, masks the text boxes, and in-paints the masked regionsuntil your image is text-free. `Detextify` can be run entirely on your local machine (using[Tesseract](https://github.com/tesseract-ocr/tesseract) for text detection and[Stable Diffusion](https://huggingface.co/stabilityai/stable-diffusion-2-inpainting) for in-painting), or can call existing APIs([Azure](https://azure.microsoft.com/en-us/products/cognitive-services/computer-vision/) for text detection and[OpenAI](https://openai.com/dall-e-2/) or [Replicate](https://replicate.com/) for in-painting).## Installation```commandlinepip install detextify```Additionally:- To run text detection locally (as opposed to using the Azure API), you need to [install Tesseract](https://tesseract-ocr.github.io/tessdoc/Installation.html).- To run in-painting locally (as opposed to using the OpenAI or Replicate APIs), you need a GPU with CUDA and cuDNN installed.## UsageYou can remove unwanted text from your image in just a few lines üí™:```pythonfrom detextify.text_detector import TesseractTextDetectorfrom detextify.inpainter import LocalSDInpainterfrom detextify.detextifier import Detextifiertext_detector = TesseractTextDetector(&quot;/path/to/tesseract/installation&quot;)detextifier = Detextifier(text_detector, LocalSDInpainter())detextifier.detextify(&quot;/my/input/image/path.png&quot;, &quot;/my/output/image/path.png&quot;)```and üí£üí•, just like that, your image is cleared of any bizarre text artifacts.Or if you want to clean up a directory of PNG images, just wrap it in a for-loop:```pythonimport globfrom detextify.text_detector import TesseractTextDetectorfrom detextify.inpainter import LocalSDInpainterfrom detextify.detextifier import Detextifiertext_detector = TesseractTextDetector(&quot;/path/to/tesseract/installation&quot;)detextifier = Detextifier(text_detector, LocalSDInpainter())for img_file in glob.glob(&quot;/path/to/dir/*.png&quot;):    detextifier.detextify(img_file, img_file.replace(&quot;.png&quot;, &quot;_detextified.png&quot;))```We provide multiple implementations for text detection and in-painting (both local and API-based), and you are also free to add your own.### Text Detectors1. `TesseractTextDetector` (based on [Tesseract](https://github.com/tesseract-ocr/tesseract)) runs locally.Follow [this guide](https://tesseract-ocr.github.io/tessdoc/Installation.html) to install the `tesseract` library locally. On Ubuntu:```sudo apt install tesseract-ocrsudo apt install libtesseract-dev```To find the path where it was installed (and pass it to the `TesseractTextDetector` constructor):```whereis tesseract```2. `AzureTextDetector` calls a computer vision API from Microsoft Azure. You will first need to create a[Computer Vision resource](https://portal.azure.com/#create/Microsoft.CognitiveServicesComputerVision) via the Azureportal. Once created, take note of the endpoint and the key.```pythonAZURE_CV_ENDPOINT = &quot;https://your-endpoint.cognitiveservices.azure.com&quot;AZURE_CV_KEY = &quot;your-azure-key&quot;text_detector = AzureTextDetector(AZURE_CV_ENDPOINT, AZURE_CV_KEY)```Our evaluation shows that the two text detectors produce comparable results.### In-painters1. `LocalSDInpainter` (implemented via Huggingface's `diffusers` library) runs locally and requires a GPU. Defaults to[Stable Diffusion v2 for in-painting](https://huggingface.co/stabilityai/stable-diffusion-2-inpainting).2. `ReplicateSDInpainter` calls the [Replicate](https://replicate.com) API. Defaults to Stable Diffusion v2 forin-painting (and requires an API key).3. `DalleInpainter` calls the [DALL¬∑E 2](https://labs.openai.com) API from OpenAI (and requires an API key).```python# You only need to instantiate one of the following:local_inpainter = LocalSDInpainter()replicate_inpainter = ReplicateSDInpainter(&quot;your-replicate-key&quot;)dalle_inpainter = DalleInpainter(&quot;your-openai-key&quot;)```## ContributingTo contribute, clone the repository, make your changes, commit and push to your clone, and submit a pull request.To build the library, you need to install [poetry](https://python-poetry.org/):```commandlinecurl -sSL https://install.python-poetry.org | python3 -# Add poetry to your PATH. Note the specific path will differ depending on your system.export PATH=&quot;/home/ubuntu/.local/bin:$PATH&quot;# Check the installation was successful:poetry --version```Install dependencies for `detextify`:```commandlinepoetry install```To execute a script, run:```commandlinepoetry run python your_script.py```Please run the unit tests to make sure that your changes are not breaking the codebase:```commandlinepoetry run pytest```## AuthorsThis project was authored by [Mihail Eric](https://twitter.com/mihail_eric) and [Julia Turc](https://twitter.com/juliarturc). If you are building in the generative AI space, we want to hear from you!</longdescription>
</pkgmetadata>