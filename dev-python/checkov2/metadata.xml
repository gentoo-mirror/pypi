<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>[![checkov](https://raw.githubusercontent.com/bridgecrewio/checkov/master/docs/web/images/checkov_by_bridgecrew.png)](#)[![Maintained by Bridgecrew.io](https://img.shields.io/badge/maintained%20by-bridgecrew.io-blueviolet)](https://bridgecrew.io/?utm_source=github&amp;utm_medium=organic_oss&amp;utm_campaign=checkov)[![build status](https://github.com/bridgecrewio/checkov/workflows/build/badge.svg)](https://github.com/bridgecrewio/checkov/actions?query=workflow%3Abuild)[![security status](https://github.com/bridgecrewio/checkov/workflows/security/badge.svg)](https://github.com/bridgecrewio/checkov/actions?query=event%3Apush+branch%3Amaster+workflow%3Asecurity) [![code_coverage](https://raw.githubusercontent.com/bridgecrewio/checkov/master/coverage.svg?sanitize=true)](https://github.com/bridgecrewio/checkov/actions?query=workflow%3Acoverage) [![docs](https://img.shields.io/badge/docs-passing-brightgreen)](https://www.checkov.io/documentation?utm_source=github&amp;utm_medium=organic_oss&amp;utm_campaign=checkov)[![PyPI](https://img.shields.io/pypi/v/checkov)](https://pypi.org/project/checkov/)[![Python Version](https://img.shields.io/github/pipenv/locked/python-version/bridgecrewio/checkov)](#)[![Terraform Version](https://img.shields.io/badge/tf-%3E%3D0.12.0-blue.svg)](#)[![Downloads](https://pepy.tech/badge/checkov)](https://pepy.tech/project/checkov)[![slack-community](https://slack.bridgecrew.io/badge.svg)](https://slack.bridgecrew.io/?utm_source=github&amp;utm_medium=organic_oss&amp;utm_campaign=checkov)**Checkov** is a static code analysis tool for infrastructure-as-code.It scans cloud infrastructure provisioned using [Terraform](https://terraform.io/), Terraform plan, [Cloudformation](https://aws.amazon.com/cloudformation/), [Kubernetes](https://kubernetes.io/), Dockerfile,  [Serverless](https://www.serverless.com/) or [ARM Templates](https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/overview) and detects security and compliance misconfigurations.Checkov also powers [**Bridgecrew**](https://bridgecrew.io/?utm_source=github&amp;utm_medium=organic_oss&amp;utm_campaign=checkov), the developer-first platform that codifies and streamlines cloud security throughout the development lifecycle. Bridgecrew identifies, fixes, and prevents misconfigurations in cloud resources and infrastructure-as-code files. &lt;a href=&quot;https://www.bridgecrew.cloud/login/signUp/?utm_campaign=checkov-github-repo&amp;utm_source=github.com&amp;utm_medium=get-started-button&quot; title=&quot;Try_Bridgecrew&quot;&gt;    &lt;img src=&quot;https://dabuttonfactory.com/button.png?t=Try+Bridgecrew&amp;f=Open+Sans-Bold&amp;ts=26&amp;tc=fff&amp;hp=45&amp;vp=20&amp;c=round&amp;bgt=unicolored&amp;bgc=662eff&quot; align=&quot;right&quot; width=&quot;120&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://docs.bridgecrew.io?utm_campaign=checkov-github-repo&amp;utm_source=github.com&amp;utm_medium=read-docs-button&quot; title=&quot;Docs&quot;&gt;    &lt;img src=&quot;https://dabuttonfactory.com/button.png?t=Read+the+Docs&amp;f=Open+Sans-Bold&amp;ts=26&amp;tc=fff&amp;hp=45&amp;vp=20&amp;c=round&amp;bgt=unicolored&amp;bgc=662eff&quot; align=&quot;right&quot; width=&quot;120&quot;&gt;&lt;/a&gt;## **Table of contents**- [Features](#features)- [Screenshots](#screenshots)- [Getting Started](#getting-started)- [Disclaimer](#disclaimer)- [Support](#support) ## Features * [Over 500 built-in policies](docs/3.Scans/resource-scans.md) cover security and compliance best practices for AWS, Azure and Google Cloud. * Scans Terraform, Terraform Plan, CloudFormation, Kubernetes, Serverless framework and ARM template files. * Detects [AWS credentials](docs/3.Scans/Credentials%20Scans.md) in EC2 Userdata, Lambda environment variables and Terraform providers. * Evaluates [Terraform Provider](https://registry.terraform.io/browse/providers) settings to regulate the creation, management, and updates of IaaS, PaaS or SaaS managed through Terraform. * Policies support evaluation of [variables](docs/2.Concepts/Evaluations.md) to their optional default value. * Supports in-line [suppression](docs/2.Concepts/Suppressions.md) of accepted risks or false-positives to reduce recurring scan failures. Also supports global skip from using CLI.* [Output](docs/1.Introduction/Results.md) currently available as CLI, JSON, JUnit XML and github markdown and link to remediation [guides](https://docs.bridgecrew.io/docs/aws-policy-index).## ScreenshotsScan results in CLI![scan-screenshot](https://raw.githubusercontent.com/bridgecrewio/checkov/master/docs/checkov-recording.gif)Scheduled scan result in Jenkins![jenikins-screenshot](https://raw.githubusercontent.com/bridgecrewio/checkov/master/docs/checkov-jenkins.png)## Getting started### Requrirements * Python &gt;= 3.7 (Data classes are available for Python 3.7+) * Terraform &gt;= 0.12### Installation```shpip3 install checkov```Installation on Alpine:```shpip3 install --upgrade pip &amp;&amp; pip3 install --upgrade setuptoolspip3 install checkov```Installation on Ubuntu 18.04 LTS:Ubuntu 18.04 ships with Python 3.6. Install python 3.7 (from ppa repository)```shsudo apt updatesudo apt install software-properties-commonsudo add-apt-repository ppa:deadsnakes/ppasudo apt install python3.7sudo apt install python3-pipsudo python3.7 -m pip install -U checkov #to install or upgrade checkov)```or using homebrew (MacOS only)```shbrew install checkov```or```shbrew upgrade checkov```### Upgradeif you installed checkov with pip3```shpip3 install -U checkov```### Configure an input folder or file```shcheckov --directory /user/path/to/iac/code```Or a specific file or files```shcheckov --file /user/tf/example.tf```Or```shcheckov -f /user/cloudformation/example1.yml -f /user/cloudformation/example2.yml```Or a terraform plan file in json format```shterraform initterraform plan -out tf.planterraform show -json tf.plan  &gt; tf.json checkov -f tf.json```Note: `terraform show` output  file `tf.json` will be single line. For that reason all findings will be reported line number 0 by checkov```shcheck: CKV_AWS_21: &quot;Ensure all data stored in the S3 bucket have versioning enabled&quot;FAILED for resource: aws_s3_bucket.customerFile: /tf/tf.json:0-0Guide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning  ```If you have installed `jq` you can convert json file into multiple lines with the following command:```shterraform show -json tf.plan | jq '.' &gt; tf.json ```Scan result would be much user friendly.```shcheckov -f tf.jsonCheck: CKV_AWS_21: &quot;Ensure all data stored in the S3 bucket have versioning enabled&quot;FAILED for resource: aws_s3_bucket.customerFile: /tf/tf1.json:224-268Guide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning225 |               &quot;values&quot;: {226 |                 &quot;acceleration_status&quot;: &quot;&quot;,227 |                 &quot;acl&quot;: &quot;private&quot;,228 |                 &quot;arn&quot;: &quot;arn:aws:s3:::mybucket&quot;,```### Scan result sample (CLI)```shPassed Checks: 1, Failed Checks: 1, Suppressed Checks: 0Check: &quot;Ensure all data stored in the S3 bucket is securely encrypted at rest&quot;/main.tf: Passed for resource: aws_s3_bucket.template_bucket Check: &quot;Ensure all data stored in the S3 bucket is securely encrypted at rest&quot;/../regionStack/main.tf: Failed for resource: aws_s3_bucket.sls_deployment_bucket_name       ```Start using Checkov by reading the [Getting Started](docs/1.Introduction/Getting%20Started.md) page.### Using Docker```shdocker pull bridgecrew/checkovdocker run --tty --volume /user/tf:/tf bridgecrew/checkov --directory /tf```Note: if you are using Python 3.6(Default version in Ubuntu 18.04) checkov will not work and it will fail with `ModuleNotFoundError: No module named 'dataclasses'`  error message. In this case, you can use the docker version instead.Note that there are certain cases where redirecting `docker run --tty` output to a file - for example, if you want to save the Checkov JUnit output to a file - will cause extra control characters to be printed. This can break file parsing. If you encounter this, remove the `--tty` flag.### Running or skipping checks Using command line flags you can specify to run only named checks (allow list) or run all checks except those listed (deny list).List available checks:```shcheckov --list ```Allow only 2 checks to run: ```shcheckov --directory . --check CKV_AWS_20,CKV_AWS_57```Run all checks except 1 specified:```shcheckov -d . --skip-check CKV_AWS_52```Run all checks except checks with specified patterns:```shcheckov -d . --skip-check CKV_AWS*```For Kubernetes workloads, you can also use allow/deny namespaces.  For example, do not report any results for the kube-system namespace:```shcheckov -d . --skip-check kube-system```### Suppressing/Ignoring a checkLike any static-analysis tool it is limited by its analysis scope. For example, if a resource is managed manually, or using subsequent configuration management tooling, a suppression can be inserted as a simple code annotation.#### Suppression comment formatTo skip a check on a given Terraform definition block or CloudFormation resource, apply the following comment pattern inside it's scope:`checkov:skip=&lt;check_id&gt;:&lt;suppression_comment&gt;`* `&lt;check_id&gt;` is one of the [available check scanners](docs/3.Scans/resource-scans.md)* `&lt;suppression_comment&gt;` is an optional suppression reason to be included in the output#### ExampleThe following comment skip the `CKV_AWS_20` check on the resource identified by `foo-bucket`, where the scan checks if an AWS S3 bucket is private.In the example, the bucket is configured with a public read access; Adding the suppress comment would skip the appropriate check instead of the check to fail.```hcl-terraformresource &quot;aws_s3_bucket&quot; &quot;foo-bucket&quot; {  region        = var.region    #checkov:skip=CKV_AWS_20:The bucket is a public static content host  bucket        = local.bucket_name  force_destroy = true  acl           = &quot;public-read&quot;}```The output would now contain a ``SKIPPED`` check result entry:```bash......Check: &quot;S3 Bucket has an ACL defined which allows public access.&quot;SKIPPED for resource: aws_s3_bucket.foo-bucketSuppress comment: The bucket is a public static content hostFile: /example_skip_acl.tf:1-25...```To suppress checks in Kubernetes manifests, annotations are used with the following format:`checkov.io/skip#: &lt;check_id&gt;=&lt;suppression_comment&gt;`For example: ```bashapiVersion: v1kind: Podmetadata:  name: mypod  annotations:    checkov.io/skip1: CKV_K8S_20=I don't care about Privilege Escalation :-O    checkov.io/skip2: CKV_K8S_14    checkov.io/skip3: CKV_K8S_11=I have not set CPU limits as I want BestEffort QoSspec:  containers:...```#### LoggingFor detailed logging to stdout setup the environment variable `LOG_LEVEL` to `DEBUG`. Default is `LOG_LEVEL=WARNING`.#### Skipping directoriesTo skip a whole directory, use the environment variable `CKV_IGNORED_DIRECTORIES`. Default is `CKV_IGNORED_DIRECTORIES=node_modules,.terraform,.serverless`#### VSCODE ExtensionIf you want to use checkov's within vscode, give a try to the vscode extension availble at [vscode](https://marketplace.visualstudio.com/items?itemName=Bridgecrew.checkov)## AlternativesFor Terraform compliance scanners check out [tfsec](https://github.com/liamg/tfsec) and [Terraform AWS Secure Baseline](https://github.com/nozaq/terraform-aws-secure-baseline) for secured basline.For CloudFormation scanning check out [cfripper](https://github.com/Skyscanner/cfripper/) and [cfn_nag](https://github.com/stelligent/cfn_nag).For Kubernetes scanning check out [kube-scan](https://github.com/octarinesec/kube-scan) and [Polaris](https://github.com/FairwindsOps/polaris).## ContributingContribution is welcomed! Start by reviewing the [contribution guidelines](CONTRIBUTING.md). After that, take a look at a [good first issue](https://github.com/bridgecrewio/checkov/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+issue%22).Looking to contribute new checks? Learn how to write a new check (AKA policy) [here](docs/5.Contribution/New-Check.md).## Disclaimer`checkov` does not save, publish or share with anyone any identifiable customer information.  No identifiable customer information is used to query Bridgecrew's publicly accessible guides.`checkov` uses Bridgecrew's API to enrich the results with links to remediation guides.To skip this API call use the flag `--no-guide`.## Support[Bridgecrew](https://bridgecrew.io/?utm_source=github&amp;utm_medium=organic_oss&amp;utm_campaign=checkov) builds and maintains Checkov to make policy-as-code simple and accessible. Start with our [Documentation](https://bridgecrewio.github.io/checkov/) for quick tutorials and examples.If you need direct support you can contact us at info@bridgecrew.io.</longdescription>
</pkgmetadata>