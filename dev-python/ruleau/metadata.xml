<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># RuleauA Python Rules Engine library## Using the libraryA username and password is required. This can be passed directly to the ApiAdapter (i.e. via the CLI) or these canbe set in the environment variables.```textRULEAU_USERNAME=myusernameRULEAU_PASSWORD=mypassword``````pythonfrom ruleau import execute, rule, ApiAdapter, Process# create a rule@rule(rule_id=&quot;rul_1&quot;, name=&quot;Is adult&quot;)def over_18(_, payload):    return &quot;age&quot; in payload and payload[&quot;age&quot;] &gt;= 18# create a payload (the answers to the rule's questions)payload = {&quot;age&quot;: 17}# execute the rule against the payloadresult = execute(over_18, payload, Process.create_process_from_rule(over_18))# integrate with the backend web API with password and username in envapi_adapter = ApiAdapter(    base_url=&quot;http://localhost:8000/&quot;)# or pass directly to ApiAdapter:api_adapter = ApiAdapter(    base_url=&quot;http://localhost:8000/&quot;, username=myusername, password=mypassword)# sync the process# Usually only needed once. For efficiency, it is advisable to keep these lines out of any loop.process = Process.create_process_from_rule(over_18)api_adapter.sync_process(process)# send the resultsresult = execute(over_18, payload, process, api_adapter=api_adapter, case_id=&quot;ca_1280&quot;)# result.result will be False due to applicant being 17# if the rule for this case is overriden in the backend# then running again will return True```### Organisational DataOptionally a Process can be assigned as set of &quot;tags&quot; called Organisational Data which can be usedto filter or categorise rules and results.Each Process must have these specified up front by setting the Organisational Scheme like so:```pythonapi_adapter = ApiAdapter(    base_url=&quot;http://localhost:8000&quot;,)org_scheme: List[OrganisationalScheme] = [    OrganisationalScheme(        id=&quot;location&quot;,  # ID Used to refer to the tag when organisational data is posted        display_name=&quot;Location&quot;,  # Label used on the UI when being displayed        display_default=True,  # If true, will appear on the UI by default, otherwise is hidden        type=&quot;string&quot;,  # Either a `string`, `integer`, `float` or `date` type    ),    OrganisationalScheme(        id=&quot;internal_id&quot;,  # ID Used to refer to the tag when organisational data is posted        display_name=&quot;ID&quot;,  # Label used on the UI when being displayed        display_default=True,  # If true, will appear on the UI by default, otherwise is hidden        type=&quot;integer&quot;,  # Either a `string`, `integer`, `float` or `date` type    )]api_adapter.publish_organisational_scheme(over_18, org_scheme)```Once set data can be provided when a ruleset is executed by updating the API Adapter using its`with_organisational_data` method like so:```pythonapi_adapter = ApiAdapter(    base_url=&quot;http://localhost:8000/&quot;).with_organisational_data([    {&quot;key&quot;: &quot;location&quot;, &quot;value&quot;: &quot;Bristol&quot;},    {&quot;key&quot;: &quot;internal_id&quot;, &quot;value&quot;: 5}])process = Process.create_process_from_rule(over_18)api_adapter.sync_process(process)result = execute(over_18, payload, process, api_adapter=api_adapter, case_id=&quot;ca_1280&quot;)```Optionally we can also set the order by which Organisational Data appears on the UI by postingto the UI Layout Metadata endpoint as in this example:```pythonui_layout_metadata: UiLayoutMetadata = {    # Defines the order the tags will appear on the cases page    &quot;case_org_data_order&quot;: [{&quot;id&quot;: &quot;internal_id&quot;}, {&quot;id&quot;: &quot;location&quot;}],    # Defines the order the tags will appear on the overrides page    &quot;override_org_data_order&quot;: [{&quot;id&quot;: &quot;department&quot;}],    # See &quot;Case Payload UI Specification&quot; for details    &quot;data_payload_presentation&quot;: None,}api_adapter.publish_ui_layout_metadata(    payload_has_patient_rule, ui_layout_metadata)```### Case Payload UI SpecificationIn the Ruleau UI we display the case payload as it was executed for a case, and allow users to override the datawith values when said case is next reexecuted.By default we work out the structure of case payload automatically to display it in the UI, this will perform basicvalidation such as checking if the data override provided for a case matches the type in the original payload.However you can use UI Layout Metadata to publish a JSON Schema specification that defines how case payloads for aprocess should be displayed and validated, allowing for customisation of what overrides can be specified for the data.In order to do this, please see the below example setting a JSON Schema for a case:```pythonui_layout_metadata: UiLayoutMetadata = {    # See &quot;Organisational Data&quot; for details    &quot;case_org_data_order&quot;: [],    # See &quot;Organisational Data&quot; for details    &quot;override_org_data_order&quot;: [],    # X    &quot;data_payload_presentation&quot;: {        &quot;type&quot;: &quot;object&quot;,        &quot;properties&quot;: {            &quot;street_address&quot;: { &quot;type&quot;: &quot;string&quot; },            &quot;city&quot;: { &quot;type&quot;: &quot;string&quot; },            &quot;state&quot;: { &quot;type&quot;: &quot;string&quot; }        },        &quot;required&quot;: [&quot;street_address&quot;, &quot;city&quot;, &quot;state&quot;]    },}api_adapter.publish_ui_layout_metadata(    payload_has_patient_rule, ui_layout_metadata)```The above example tells the UI a case payload for this process is expected to have 3 fields:* street_address* city* stateAll 3 of them are required text fields, and can be overridden on a case by case basis in the UI.### JSON Schema Rules &amp; LimitationsAs a JSON Schema could define any shape of data, even one wildly different from the case payloads posted for a process,we have to impose set of rules &amp; limitations to ensure they are compatible with the payloads displayed on the UI.1. On a case payload please always provide all the keys, even if null, rather than excluding the keys with no values    * For example please use `{&quot;a&quot;: null, &quot;b&quot;: &quot;abc&quot;}` over `{&quot;b&quot;: &quot;abc&quot;}` if `a` is optional2. A custom JSON schema must only define one type for a given property    * We don't support multiple types in a single field        * Lists containing both strings and numbers aren't allowed        * Nor are properties that can be either a string or number, for example3. Everything in the custom JSON schema must be in the payload    * No fields should exist in the schema that aren't on the payloads    * For example if the schema specifies a field `a`, that field should be present in all case payloads, even if null4. However not everything in the payload has to be in the JSON schema    * For example the payload may have fields `a`, `b` and `c`, however you only wish field `b` to be editable    * In that case, adding just the `b` field to the Schema means that is the only field the UI will allow data overrides for5. If a custom JSON schema isn't defined, and a field is always `null` in a case, it won't be shown on the data overrides UI    * This is as we are not able to generate a JSON schema from a `null` field (we cannot tell what type is required)    * This can be resolved by using a custom JSON schema and specifying what the field should be when not `null`    * In the example below the payload has a `null` `wind_sensor` field, by specifying it in the schema it can still be edited in the UIPlease see below for an example of a custom JSON schema and the expected case payload:**Case Payload**```json{  &quot;case_id&quot;: &quot;001&quot;,  &quot;temperature&quot;: 27,  &quot;wind_speed&quot;: 0.4,  &quot;humidity&quot;: 30,  &quot;cloud_cover&quot;: 20,  &quot;precipitation&quot;: 0,  &quot;last_checks&quot;: [],  &quot;pending_checks&quot;: [],  &quot;sensor_status&quot;: {    &quot;wind_sensor&quot;: null,    &quot;cloud_reader&quot;: null,    &quot;rain_indicator&quot;: null  }}```**JSON Schema**```json{  &quot;$schema&quot;: &quot;https://json-schema.org/draft/2020-12/schema&quot;,  &quot;$id&quot;: &quot;https:///www.unai.com/schemas/unit_test_schema.json&quot;,  &quot;type&quot;: &quot;object&quot;,  &quot;properties&quot;: {    &quot;case_id&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;title&quot;: &quot;Case Id&quot; },    &quot;humidity&quot;: { &quot;type&quot;: &quot;number&quot;, &quot;title&quot;: &quot;Humidity&quot; },    &quot;wind_speed&quot;: { &quot;type&quot;: &quot;number&quot;, &quot;title&quot;: &quot;Wind Speed&quot; },    &quot;cloud_cover&quot;: { &quot;type&quot;: &quot;number&quot;, &quot;title&quot;: &quot;Cloud Cover&quot; },    &quot;last_checks&quot;: {      &quot;type&quot;: &quot;array&quot;,      &quot;items&quot;: {        &quot;type&quot;: &quot;object&quot;,        &quot;properties&quot;: {          &quot;date&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;title&quot;: &quot;Date&quot; },          &quot;checked_by&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;title&quot;: &quot;Checked By&quot; }        },        &quot;required&quot;: [ &quot;date&quot;, &quot;checked_by&quot; ]      },      &quot;title&quot;: &quot;Last Checks&quot;    },    &quot;temperature&quot;: { &quot;type&quot;: &quot;number&quot;, &quot;title&quot;: &quot;Temperature&quot; },    &quot;precipitation&quot;: { &quot;type&quot;: &quot;number&quot;, &quot;title&quot;: &quot;Precipitation&quot; },    &quot;sensor_status&quot;: {      &quot;type&quot;: &quot;object&quot;,      &quot;properties&quot;: {        &quot;wind_sensor&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;title&quot;: &quot;Wind Sensor&quot; },        &quot;cloud_reader&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;title&quot;: &quot;Cloud Reader&quot; },        &quot;rain_indicator&quot;: { &quot;type&quot;: &quot;string&quot;, &quot;title&quot;: &quot;Rain Indicator&quot; }      },      &quot;title&quot;: &quot;Sensor Status&quot;    },    &quot;pending_checks&quot;: {      &quot;type&quot;: &quot;array&quot;,      &quot;items&quot;: {        &quot;type&quot;: &quot;string&quot;      },      &quot;title&quot;: &quot;Pending Checks&quot;    }  }}```### Testing RulesRules should be tested using [doctest](https://docs.python.org/3/library/doctest.html).Example of these tests can be found in the [Kitchen Sink example](https://gitlab.com/unai-ltd/unai-decision/ruleau-core/-/tree/develop/examples/kitchen_sink/rules.py).### Generating DocumentationDocumentation for the rules can be generated using the `ruleau-docs` command.The usage is as follows:```ruleau-docs [--output-dir=&lt;argument&gt;] filename```For example for a file of rules called `rules.py` run:```ruleau-docs rules.py```## Building &amp; Testing the Library### Pre-requisites* [Python 3.9+](https://www.python.org/downloads/)Package requirements installed by running:```shellpip install -r requirements-dev.txt```### Running the TestsTo run all unit tests in the project use the following command:```shellpytest```</longdescription>
</pkgmetadata>