<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Chaos Toolkit Driver for Toxiproxy[![Build Status](https://travis-ci.org/chaostoolkit-incubator/chaostoolkit-toxiproxy.svg?branch=master)](https://travis-ci.org/chaostoolkit-incubator/chaostoolkit-toxiproxy)[![Python versions](https://img.shields.io/pypi/pyversions/chaostoolkit-toxiproxy.svg)](https://www.python.org/)Welcome to the [Chaos Toolkit][chaostoolkit] driver for [Toxiproxy][toxiproxy]! This extension allows you to setup toxy proxy probes and methods from chaostoolkit by leveraging the toxyproxy [http management api](https://github.com/Shopify/toxiproxy#http-api). [toxiproxy]: https://github.com/Shopify/toxiproxy[chaostoolkit]: http://chaostoolkit.org## Install1. Install the [Toxiproxy base client](https://github.com/Shopify/toxiproxy/releases)2. Install the [Toxiproxy CLI](https://github.com/Shopify/toxiproxy/releases)### DriverThis package requires Python 3.5+To be used from your experiment, this package must be installed in the Pythonenvironment where [chaostoolkit][] already lives.```$ pip install -U chaostoolkit-toxiproxy```## Usage### ConfigurationFirst, run the Toxiproxy base client locally to create a `localhost:8474` host on your computer. Then [create a proxy](https://github.com/Shopify/toxiproxy#2-populating-toxiproxy).Next, to start using the actions and probes all you need to do is add the toxiproxy host with &quot;toxiproxy_host&quot; as the key, and optionally the port with &quot;toxiproxy_port&quot; as the key, to the configuration section in your experiment json. If not provided the port defaults to 8474.Alternatively, if toxiproxy api is accessible using a reverse proxy, you can use `toxiproxy_url` setting.Example using `toxiproxy_host` in experiment.json```json&quot;configuration&quot;: {    &quot;toxiproxy_host&quot; : &quot;10.124.23.183&quot;,    &quot;some_environment_variable&quot;: {      &quot;type&quot;: &quot;environment&quot;,      &quot;key&quot;: &quot;ENVIRONMENT_VARIABLE&quot;    }  },```Example using `toxiproxy_url` in experiment.json```json&quot;configuration&quot;: {    &quot;toxiproxy_url&quot; : &quot;http://mydomain.com:8080/path-to-toxiproxy-api&quot;,    &quot;some_environment_variable&quot;: {      &quot;type&quot;: &quot;environment&quot;,      &quot;key&quot;: &quot;ENVIRONMENT_VARIABLE&quot;    }  },```This extension follows the toxiproxy rules. A proxy is the channel where toxicity can be added. For this reason the extension is broken into proxy management and toxic management. All actions and probes in the extension are of python type and are used like any other python extension.### Proxy actions#### create_proxyCreates a proxy to which toxics can be added. In toxiproxy a listen port of value 0 tells the API to assign a random available port. The value where the proxy is listenting will be attached to the **chaostoolkit configuration object** as *\&lt;proxyname\&gt;_PORT*. Should the creation of the proxy fail, an assertion error is raised stopping all subsequent actions.|Argument|Description|Required|Default||--------|-----------|--------|-------||proxy_name|name for the proxy|Yes|None||upstream_host|ip address of the host to send traffic to|Yes|None||upstream_port|port of the application to send traffic to|Yes|None||listen_host| IP address to bind where toxiproxy listens|No| 0.0.0.0||listen_port|port to listen for requests, 0 means pick random value|No|0||enabled| Whether to start listening or not|No|True|#### modify_proxyModify the configuration of a given proxy. Useful to change the upstream configiuration. Only arguments supplied result in modification of the proxy.|Argument|Description|Required|Default||--------|-----------|--------|-------||proxy_name|name for the proxy|Yes|None||listen_addres|ip:port address to modify|No|None||upstream_addres|ip:port of the upstream|No|None||enabled| Toggle enabled/disabled state|No|None|#### disable_proxyDisables the proxy, this is useful to simulate a proxied service being down.|Argument|Description|Required|Default||--------|-----------|--------|-------||proxy_name|name for the proxy to disable|Yes|None|#### enable_proxyEnables a disabled proxy.|Argument|Description|Required|Default||--------|-----------|--------|-------||proxy_name|name for the proxy to enable|Yes|None|#### delete_proxyRemoves the proxy from the system.Example usage```json &quot;method&quot;: [      {            &quot;type&quot;: &quot;action&quot;,            &quot;name&quot;: &quot;setup_toxiproxy_proxy&quot;,            &quot;provider&quot;: {                &quot;type&quot;: &quot;python&quot;,                &quot;module&quot;: &quot;chaostoxi.proxy.actions&quot;,                &quot;func&quot;: &quot;create_proxy&quot;,                &quot;arguments&quot;: {                    &quot;proxy_name&quot;: &quot;myproxy&quot;,                    &quot;listen_port&quot; : 6666,                    &quot;upstream_host&quot; : &quot;10.28.188.118&quot;,                    &quot;upstream_port&quot; : 6040                }            },            &quot;pauses&quot;: {                &quot;after&quot;: 1            }        }      ] ```#### resetEnable all proxies and remove all active toxics.Example usage:  ```json&quot;method&quot;: [    {        &quot;type&quot;: &quot;action&quot;,        &quot;name&quot;: &quot;reset all proxies&quot;,        &quot;provider&quot;: {            &quot;type&quot;: &quot;python&quot;,            &quot;module&quot;: &quot;chaostoxi.proxy.actions&quot;,            &quot;func&quot;: &quot;reset&quot;        },        &quot;pauses&quot;: {            &quot;after&quot;: 1        }    }]```### Proxy pobes#### proxy_existReturns True of False if a given proxy exists.|Argument|Description|Required|Default||--------|-----------|--------|-------||proxy_name|name for the proxy|Yes|None|### Toxic actionsAll actions provided by this extension match the types and attributes of [toxics](https://github.com/Shopify/toxiproxy#toxics). #### create\_toxicAllows you to create any of the supported types of toxics with their attributes. |Argument|Description|Required|Default||--------|-----------|--------|-------||for_proxy|name for the proxy to attach the toxy|Yes|None||toxic_name|name for this toxy|Yes|None||toxic_type|A valid toxic type|Yes|None||stream| The direction of the toxic &quot;upstream&quot; or &quot;downstream&quot;|No|downstream||toxicity|Percentage of toxiciy 1.0 is 100%, 0.5 is 50% etc| No| 1.0||attributes|Dictionary of attributes for the type of toxic|No|None|#### create\_latency\_toxicAdd a delay to all data going through the proxy using a downstream with a toxicity of 100%.|Argument|Description|Required|Default||--------|-----------|--------|-------||for_proxy|name for the proxy to attach the toxy|Yes|None||toxic_name|name for this toxy|Yes|None||latency| time in milliseconds to add for latency| Yes|None||jitter| time in milliseconds to jitter|No|0#### create\_bandwith\_degradation\_toxicLimit the bandwith of a  downstream connection with a toxicity of 100%.|Argument|Description|Required|Default||--------|-----------|--------|-------||for_proxy|name for the proxy to attach the toxy|Yes|None||toxic_name|name for this toxy|Yes|None||rate| desired bandwith rate in KB/s| Yes|None|#### create\_slow\_connection\_close\_toxicGenerate as downstream delayed TCP close with a toxicity of 100%.|Argument|Description|Required|Default||--------|-----------|--------|-------||for_proxy|name for the proxy to attach the toxy|Yes|None||toxic_name|name for this toxy|Yes|None||delay| desired close delay in milliseconds| Yes|None|#### create\_slicer\_toxicSlices TCP data up into small bits, optionally adding a delay between each sliced &quot;packet&quot; with a toxicity of 100%.|Argument|Description|Required|Default||--------|-----------|--------|-------||for_proxy|name for the proxy to attach the toxy|Yes|None||toxic_name|name for this toxy|Yes|None||average_size| size in bytes for the average package| Yes|None||size_variation| variation in bytes of an average pkg (should be smaller than average_size)|Yes|None|delay| time in microseconds to delay each packet by|Yes|None#### create\_limiter\_toxicCloses connections when transmitted data after the limit, sets it up as a dowsntream, 100% toxicity.|Argument|Description|Required|Default||--------|-----------|--------|-------||for_proxy|name for the proxy to attach the toxy|Yes|None||toxic_name|name for this toxy|Yes|None||bytes| number of bytes to transmit before connection is closed| Yes|None|#### delete\_toxicDeletes the a given toxic.|Argument|Description|Required|Default||--------|-----------|--------|-------||for_proxy|name for the proxy to attach the toxy|Yes|None||toxic_name|name for this toxy|Yes|None|Example usage:```json &quot;method&quot;: [              {            &quot;type&quot;: &quot;action&quot;,            &quot;name&quot;: &quot;create_latency_toxic&quot;,            &quot;provider&quot;: {                &quot;type&quot;: &quot;python&quot;,                &quot;module&quot;: &quot;toxiproxy.toxic.actions&quot;,                &quot;func&quot;: &quot;create_dowsntream_latency_toxic&quot;,                &quot;arguments&quot;: {                    &quot;for_proxy&quot;: &quot;edsproxy&quot;,                    &quot;toxic_name&quot;: &quot;latency_toxic&quot;,                    &quot;latency&quot;: 5000,                    &quot;jitter&quot;: 200                }            },            &quot;pauses&quot;: {                &quot;after&quot;: 1            }        }     ]```## ContributeIf you wish to contribute more functions to this package, you are more thanwelcome to do so. Please, fork this project, make your changes following theusual [PEP 8][pep8] code style, sprinkling with tests and submit a PR forreview.[pep8]: https://pycodestyle.readthedocs.io/en/latest/The Chaos Toolkit projects require all contributors must sign a[Developer Certificate of Origin][dco] on each commit they would like to mergeinto the master branch of the repository. Please, make sure you can abide bythe rules of the DCO before submitting a PR.[dco]: https://github.com/probot/dco#how-it-works### DevelopIf you wish to develop on this project, make sure to install the developmentdependencies. But first, [create a virtual environment][venv] and then installthose dependencies.[venv]: http://chaostoolkit.org/reference/usage/install/#create-a-virtual-environment```console$ pip install -r requirements-dev.txt -r requirements.txt```Then, point your environment to this directory:```console$ python setup.py develop```Now, you can edit the files and they will be automatically be seen by yourenvironment, even when running from the `chaos` command locally.### TestTo run the unit tests for the project execute the following:```$ pytest```To run the integration tests for the project execute the following:```$ tox```</longdescription>
</pkgmetadata>