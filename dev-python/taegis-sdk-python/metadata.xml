<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Taegis SDK for PythonThe Taegis SDK is a Python library for interfacing with the GraphQL APIs in Taegis.## Prerequisites- Python 3.8 or higher.## Authentication- Set `CLIENT_ID` and `CLIENT_SECRET` environment variables as described in the [Taegis XDR Documenation](https://docs.ctpx.secureworks.com/apis/api_authenticate/).OR- Login using username/password with mfa upon service creationOR- Device Code SSO## Installation```bashpython -m pip install taegis-sdk-python```## Using the SDKTo use the SDK, you must first import the `GraphQLService````pythonfrom taegis_sdk_python import GraphQLServicefrom pprint import pprint as ppservice = GraphQLService()```Now that you have the `GraphQLService`, you can make requests and process responses for `Taegis XDR Services`. The following example uses the `Investigations Service` to send a query to get all available investigations```pythonresult = service.investigations.query.investigations_search(    page=1,    per_page=3,    query=&quot;WHERE deleted_at IS NOT NULL EARLIEST=-90d&quot;)pp(result)``````pythonresult = service.tenants.query.tenants(tenants_query=TenantsQuery(    max_results=10,    page_num=1,))pp(result)``````pythonresults = service.events.subscription.event_query(    query=&quot;FROM process EARLIEST=-30d&quot;,    options=EventQueryOptions(        max_rows=20,        page_size=10,        skip_cache=True,    ),)pp(results)print()try:    next_page = next(        iter(            {                result.next                for result in results                if result.next            }        )    )except StopIteration:    next_page = Noneif next_page:    results = service.events.subscription.event_page(page_id=next_page)    pp(results)```## Custom Examples### Custom OutputThe SDK enables users to override the output property of a query to retrieve specific response fields. For example, the following code will **ONLY** return the ids, description and status of all Closed Investigations. This query runs inside the `Service Context`.```pythonfrom taegis_sdk_python import GraphQLServiceservice = GraphQLService()# specify the output fields, and start the service contextwith service(output=&quot;investigations { id description status } totalCount&quot;):    result = service.investigations.query.investigations_search(        page=1,        per_page=3,        query=&quot;WHERE deleted_at IS NOT NULL EARLIEST=-90d&quot;    )pp(result)```### Change Tenant Context```pythonfrom taegis_sdk_python import GraphQLServiceservice = GraphQLService()# specify the output fields, and start the service contextwith service(tenant_id=&quot;00000&quot;):    result = service.investigations.query.investigations_search(        page=1,        per_page=3,        query=&quot;WHERE deleted_at IS NOT NULL EARLIEST=-90d&quot;    )pp(result)```### Change the Environment```pythonfrom taegis_sdk_python import GraphQLServiceservice = GraphQLService()# specify the output fields, and start the service contextwith service(environment=&quot;delta&quot;):    result = service.investigations.query.investigations_search(        page=1,        per_page=3,        query=&quot;WHERE deleted_at IS NOT NULL EARLIEST=-90d&quot;    )pp(result)```### Use a preexisting access token```pythonfrom taegis_sdk_python import GraphQLServiceservice = GraphQLService()# specify the output fields, and start the service contextwith service(access_token=&quot;&lt;your access token&gt;&quot;):    result = service.investigations.query.investigations_search(        page=1,        per_page=3,        query=&quot;WHERE deleted_at IS NOT NULL EARLIEST=-90d&quot;    )pp(result)```### Cascading ContextThe Python SDK service can handle a cascading context.  Each invocation of the `service` context manager, now overwrites the context per stack.  The main use case for this is to change the `output` of a single API call within a greater context without needing to exit the context entirely.  Any new level will temporarily overwrite any previous context definitions, the previous definitions will be available after exiting the current context.**Note**: The following example is for illustration purposes of the context manager.  The mix of API calls may not be useful together.```pythonfrom taegis_sdk_python import GraphQLServicefrom taegis_sdk_python.services.investigations2.types import InvestigationsV2Argumentsfrom taegis_sdk_python.services.alerts.types import SearchRequestInputservice = GraphQLService()with service(environment=&quot;delta&quot;, tenant_id=&quot;00000&quot;):        # Context    #    environment: delta    #    tenant_id: 00000    with service(output=&quot;investigations { id alertsEvidence { id } }&quot;)                # Context        #    environment: delta        #    tenant_id: 00000        #    output: investigations { id alertsEvidence { id } }                investigation_results = service.investigations2.query.investigations_v2(InvestigationsV2Arguments(            page=1,            per_page=3,            cql=&quot;WHERE deleted_at IS NOT NULL EARLIEST=-90d&quot;        ))        # Context    #    environment: delta    #    tenant_id: 00000    alert_ids = [        alert.id        result for result in investigation_results        alert for alert in result.alerts_evidence    ]    with service(output=&quot;alerts { list { id metadata { title } status } }&quot;):                # Context        #    environment: delta        #    tenant_id: 00000        #    output: alerts { list { id metadata { title } status } }                alert_results = service.alerts.query.alerts_search_search(SearchRequestInput(            offset=0,            limit=10000,            cql_query=f&quot;FROM alert WHERE resource_id IN ('{'\',\''.join(alert_ids)]}')&quot;        ))        # Context    #    environment: delta    #    tenant_id: 00000    # may be useful for users/applications that have access to a parent/child tenant relationship    with service(tenant_id=&quot;00001&quot;, output=&quot;alerts { list { id metadata { title } status } }&quot;):                # Context        #    environment: delta        #    tenant_id: 00001        #    output: alerts { list { id metadata { title } status } }                alert_results = service.alerts.query.alerts_search_search(SearchRequestInput(            offset=0,            limit=10000,            cql_query=f&quot;FROM alert WHERE resource_id IN ('{'\',\''.join(alert_ids)]}')&quot;        ))        with service(environment=&quot;charlie&quot;, output=&quot;email&quot;):            # Context            #    environment: charlie            #    tenant_id: 00001            #    output: email            user = service.users.query.current_tdruser()        # Context        #    environment: delta        #    tenant_id: 00001        #    output: alerts { list { id metadata { title } status } }        # Context    #    environment: delta    #    tenant_id: 00000# Context is now completely cleared```### Arbitrary QueryThe Python SDK can handle user maintained queries/mutations/subscriptions.  These will require some basic GraphQL knowledge as well as knowledge of schema.  There are 3 parts of a GraphQL query: the endpoint, the output fields and the variables (optional).  See [Exploring the Schema](docs/exploring_the_schema.md) for more information.```pythonresults = service.core.execute_query(    &quot;alertsServiceSearch&quot;,    variables={        &quot;in&quot;: {            &quot;limit&quot;: 3,            &quot;offset&quot;: 0,            &quot;cql_query&quot;: &quot;FROM alert EARLIEST=-1d&quot;        }    },    output=&quot;&quot;&quot;        search_id        alerts {            list {                id                metadata {                    title                }                status            }        }    &quot;&quot;&quot;)print(results)```### Arbitrary Mutation```pythonresults = service.core.execute_mutation(    &quot;createInvestigation&quot;,    variables={        &quot;investigation&quot;: {            &quot;description&quot;: &quot;SDK Test Investigation&quot;,            &quot;key_findings&quot;: &quot;This is a test.&quot;,            &quot;priority&quot;: 1        }    },    output=&quot;&quot;&quot;    id    created_at    created_by_user {        id        given_name        family_name    }    description    key_findings    &quot;&quot;&quot;)print(results)```### Getting Started Exploring the Schema```pythonfrom taegis_sdk_python import GraphQLServiceservice = GraphQLService()schema = service.core.get_sync_schema()```For more in depth analysis see: [Exploring the Schema](docs/exploring_the_schema.md)### Custom QueryAdvanced users can leverage the power of the SDK to execute custom queries. If an invalid query is passed the system will respond with `GraphQLSyntaxError -&gt; Syntax Error`, otherwise the query will be executed and results will be returned as a dictionary of data.```pythonfrom taegis_sdk_python import GraphQLServicegql_query = &quot;&quot;&quot;    query investigationsStatusCount {        investigationsStatusCount {            open            closed            active            awaiting_action            suspended            total        }    }&quot;&quot;&quot;result = service.core.execute(gql_query)```### Deprecation WarningsDeprecated input fields, output fields and endpoints are set to log a warning.  For more information, see the [docs](docs/deprecation.md).Example:```GraphQL Query `allInvestigations` is deprecated: 'replaced by investigationsSearch'Output field `activity_logs` is deprecated: 'Not Supported - Use audit logs', removing from default output...Output field `assignee` is deprecated: 'No longer supported', removing from default output...```</longdescription>
</pkgmetadata>