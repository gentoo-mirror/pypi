<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Pydantic is all you need, for openai function calls.Check out the [docs](https://openai-function-call.onrender.com/)!We try to provides a powerful and efficient approach to output parsing when interacting with OpenAI's Function Call API. One that is framework agnostic and minimizes any dependencies. It leverages the data validation capabilities of the Pydantic library to handle output parsing in a more structured and reliable manner.If you have any feedback, leave an issue or hit me up on [twitter](https://twitter.com/jxnlco).This repo also contains a range of examples I've used in experimentation and in production and I welcome new contributions for different types of schemas.## SupportFollow me on twitter and consider helping pay for openai tokens![![Twitter URL](https://img.shields.io/twitter/url/https/twitter.com/jxnlco.svg?style=social&amp;label=Follow%20%40jxnlco)](https://twitter.com/jxnlco) [![&quot;Buy Me A Coffee&quot;](https://www.buymeacoffee.com/assets/img/custom_images/orange_img.png)](https://www.buymeacoffee.com/jxnl)## InstallationEnsure you have Python version 3.9 or above.```pythonpip install openai-function-call```## ContributingTo get started, clone the repository```bashgit clone https://github.com/jxnl/openai_function_call.git```Next, install the necessary Python packages from the requirements.txt file:```bashpip install -r requirements.txt```### PoetryWe also use poetry if you'd like```bashpoetry build```Your contributions are welcome! If you have great examples or find neat patterns, clone the repo and add another example.Check out the issues for any ideas if you want to learn. The goal is to find great patterns and cool examples to highlight.If you encounter any issues or want to provide feedback, you can create an issue in this repository. You can also reach out to me on Twitter at @jxnlco.## UsageThis module simplifies the interaction with the OpenAI API, enabling a more structured and predictable conversation with the AI. Below are examples showcasing the use of function calls and schemas with OpenAI and Pydantic.### Example 1: Function Calls```pythonimport openaifrom openai_function_call import openai_function@openai_functiondef sum(a:int, b:int) -&gt; int:    &quot;&quot;&quot;Sum description adds a + b&quot;&quot;&quot;    return a + bcompletion = openai.ChatCompletion.create(        model=&quot;gpt-3.5-turbo-0613&quot;,        temperature=0,        functions=[sum.openai_schema],        messages=[            {                &quot;role&quot;: &quot;system&quot;,                &quot;content&quot;: &quot;You must use the `sum` function instead of adding yourself.&quot;,            },            {                &quot;role&quot;: &quot;user&quot;,                &quot;content&quot;: &quot;What is 6+3 use the `sum` function&quot;,            },        ],    )result = sum.from_response(completion)print(result)  # 9```### Example 2: Schema Extraction```pythonimport openaifrom openai_function_call import OpenAISchemafrom pydantic import Fieldclass UserDetails(OpenAISchema):    &quot;&quot;&quot;User Details&quot;&quot;&quot;    name: str = Field(..., description=&quot;User's name&quot;)    age: int = Field(..., description=&quot;User's age&quot;)completion = openai.ChatCompletion.create(    model=&quot;gpt-3.5-turbo-0613&quot;,    functions=[UserDetails.openai_schema],    messages=[        {&quot;role&quot;: &quot;system&quot;, &quot;content&quot;: &quot;I'm going to ask for user details. Use UserDetails to parse this data.&quot;},        {&quot;role&quot;: &quot;user&quot;, &quot;content&quot;: &quot;My name is John Doe and I'm 30 years old.&quot;},    ],)user_details = UserDetails.from_response(completion)print(user_details)  # UserDetails(name=&quot;John Doe&quot;, age=30)```### Example 2.1: Using the DecoratorThe following will also work but we're having issues with propogating type hintsso language services throw errors for methods like `.openai_schema`. We'd welcome a PR to fix this! ```pythonfrom openai_function_call import openai_schema@openai_schemaclass UserDetails(BaseModel):    &quot;&quot;&quot;User Details&quot;&quot;&quot;    name: str = Field(..., description=&quot;User's name&quot;)    age: int = Field(..., description=&quot;User's age&quot;)```### Example 3: Using the DSL```pythonfrom pprint import pprintfrom openai_function_call import OpenAISchemafrom openai_function_call.dsl import ChatCompletion, MultiTask, messages as mfrom openai_function_call.dsl.messages import SystemIdentity, SystemTask, SystemStyle, SystemGuidelines, SystemTips# Define a subtask you'd like to extract from then,# We'll use MultTask to easily map it to a List[Search]# so we can extract more than oneclass Search(OpenAISchema):    id: int    query: strtasks = (    ChatCompletion(name=&quot;Acme Inc Email Segmentation&quot;, model=&quot;gpt-3.5-turbo-0613&quot;)    | SystemIdentity(identity=&quot;World class state of the art agent&quot;) # if no identity is provided, this is the default one    | SystemTask(task=&quot;Segment emails into search queries&quot;)    | SystemStyle(style=&quot;Professional, clear and concise&quot;)    | SystemGuidelines(guidelines=[        'You never swear',        'You are polite',        'You say please and thank you often.'    ])    | SystemTips(tips=[        &quot;When unsure about the correct segmentation, try to think about the task as a whole&quot;,        &quot;If acronyms are used expand them to their full form&quot;,        &quot;Use multiple phrases to describe the same thing&quot;]                  )    | MultiTask(subtask_class=Search)    | m.TaggedMessage(        tag=&quot;email&quot;,        content=&quot;Can you find the video I sent last week and also the post about dogs&quot;,    )    | m.ChainOfThought())# Its important that this just builds you request,# all these | operators are overloaded and all we do is compile# it to the openai kwargs# Also note that the System components are combined sequentially# so the order matters!assert isinstance(tasks, ChatCompletion)pprint(tasks.kwargs, indent=3)&quot;&quot;&quot;{    &quot;messages&quot;: [        {            &quot;role&quot;: &quot;system&quot;,            &quot;content&quot;: &quot;You are a world class state of the art agent.\n\nYour purpose is to correctly complete this task:                        `Segment emails into search queries`.\n\nYour style when answering is professional, clear and concise\n\n                        These are the guidelines you consider when completing your task:\n\n* You never swear\n* You are polite\n* You say please and thank you often.\n\nHere are some tips to help you complete the task:\n\n* When unsure about the correct segmentation, try to think about the task as a whole\n* If acronyms are used expand them to their full form\n* Use multiple phrases to describe the same thing&quot;        },        ...        {            &quot;role&quot;: &quot;user&quot;,            &quot;content&quot;: &quot;&lt;email&gt;Can you find the video I sent last week and also the post about dogs&lt;/email&gt;&quot;        },        {            &quot;role&quot;: &quot;assistant&quot;,            &quot;content&quot;: &quot;Lets think step by step to get the correct answer:&quot;        }    ],    &quot;functions&quot;: [        {            &quot;name&quot;: &quot;MultiSearch&quot;,            &quot;description&quot;: &quot;Correct segmentation of `Search` tasks&quot;,            &quot;parameters&quot;: {                &quot;type&quot;: &quot;object&quot;,                &quot;properties&quot;: {                    &quot;tasks&quot;: {                        &quot;description&quot;: &quot;Correctly segmented list of `Search` tasks&quot;,                        &quot;type&quot;: &quot;array&quot;,                        &quot;items&quot;: {&quot;$ref&quot;: &quot;#/definitions/Search&quot;}                    }                },                &quot;definitions&quot;: {                    &quot;Search&quot;: {                        &quot;type&quot;: &quot;object&quot;,                        &quot;properties&quot;: {                            &quot;id&quot;: {&quot;type&quot;: &quot;integer&quot;},                            &quot;query&quot;: {&quot;type&quot;: &quot;string&quot;}                        },                        &quot;required&quot;: [&quot;id&quot;, &quot;query&quot;]                    }                },                &quot;required&quot;: [&quot;tasks&quot;]            }        }    ],    &quot;function_call&quot;: {&quot;name&quot;: &quot;MultiSearch&quot;},    &quot;max_tokens&quot;: 1000,    &quot;temperature&quot;: 0.1,    &quot;model&quot;: &quot;gpt-3.5-turbo-0613&quot;&quot;&quot;&quot;# Once we call .create we'll be returned with a multitask object that contains our list of taskresult = tasks.create()for task in result.tasks:    # We can now extract the list of tasks as we could normally    assert isinstance(task, Search)```## Advanced UsageIf you want to see more examples checkout the examples folder!## LicenseThis project is licensed under the terms of the MIT license.For more details, refer to the LICENSE file in the repository.</longdescription>
</pkgmetadata>