<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>ChemPy======.. image:: https://github.com/bjodah/chempy/actions/workflows/lint_python.yml/badge.svg   :target: https://github.com/bjodah/chempy/actions/workflows/lint_python.yml   :alt: Build status.. image:: https://img.shields.io/pypi/v/chempy.svg   :target: https://pypi.python.org/pypi/chempy   :alt: PyPI version.. image:: https://img.shields.io/badge/python-3.8,3.9-blue.svg   :target: https://www.python.org/   :alt: Python version.. image:: https://img.shields.io/pypi/l/chempy.svg   :target: https://github.com/bjodah/chempy/blob/master/LICENSE   :alt: License.. image:: http://joss.theoj.org/papers/10.21105/joss.00565/status.svg   :target: https://doi.org/10.21105/joss.00565   :alt: Journal of Open Source Software DOI.. contents::About ChemPy------------ChemPy is a `Python &lt;https://www.python.org&gt;`_ package useful forchemistry (mainly physical/inorganic/analytical chemistry). Currently it includes:- Numerical integration routines for chemical kinetics (ODE solver front-end)- Integrated rate expressions (and convenience fitting routines)- Solver for equilibria (including multiphase systems)- Relations in physical chemistry:  - Debye-Hückel expressions  - Arrhenius &amp; Eyring equation  - Einstein-Smoluchowski equation- Properties (pure python implementations from the literature)  - `water density &lt;https://github.com/bjodah/chempy/blob/master/chempy/properties/water_density_tanaka_2001.py&gt;`_ as function of temperature  - `water permittivity &lt;https://github.com/bjodah/chempy/blob/master/chempy/properties/water_permittivity_bradley_pitzer_1979.py&gt;`_ as function of temperature and pressure  - `water diffusivity &lt;https://github.com/bjodah/chempy/blob/master/chempy/properties/water_diffusivity_holz_2000.py&gt;`_ as function of temperature  - `water viscosity &lt;https://github.com/bjodah/chempy/blob/master/chempy/properties/water_viscosity_korson_1969.py&gt;`_ as function of temperature  - `sulfuric acid density &lt;https://github.com/bjodah/chempy/blob/master/chempy/properties/sulfuric_acid_density_myhre_1998.py&gt;`_ as function of temperature &amp; weight fraction H₂SO₄  - `More &lt;https://github.com/bjodah/chempy/tree/master/chempy/properties&gt;`_ to come... (and contributions are most welcome!)Documentation-------------The easiest way to get started is to have a look at the examples in this README,and also the jupyter notebooks_. In addition there is auto-generated API documentationfor the latest `stable release here &lt;https://bjodah.github.io/chempy/latest&gt;`_... _notebooks: https://github.com/bjodah/chempy/tree/master/examplesInstallation------------Simplest way to install ChemPy and its (optional) dependencies is to use the`conda package manager &lt;https://conda.pydata.org/docs/&gt;`_::   $ conda install -c conda-forge chempy pytest   $ pytest -rs -W ignore::chempy.ChemPyDeprecationWarning --pyargs chempycurrently conda packages are only provided for Linux. On Windows and OS Xyou will need to use ``pip`` instead::   $ python3 -m pip install chempy pytest   $ python3 -m pytest -rs -W ignore::chempy.ChemPyDeprecationWarning --pyargs chempythere will a few tests which will be skipped due to some missing optionalbackends in addition to those in SciPy (used for solving systems of non-linearequations and ordinary differential equations).Optional dependencies~~~~~~~~~~~~~~~~~~~~~If you used ``conda`` to install ChemPy you can skip this section.But if you use ``pip`` the default installation is achieved by writing::   $ python3 -m pip install --user --upgrade chempy pytest   $ python3 -m pytest -rs --pyargs chempyyou can skip the ``--user`` flag if you have got root permissions.You may be interested in using additional backends (in addition to those provided by SciPy)for solving ODE-systems and non-linear optimization problems::   $ python3 -m pip install chempy[all]Note that this option will install the following libraries(some of which require additional libraries to be present on your system):- `pygslodeiv2 &lt;https://github.com/bjodah/pygslodeiv2&gt;`_: solving initial value problems, requires GSL_. (&gt;=1.16).- `pyodeint &lt;https://github.com/bjodah/pyodeint&gt;`_: solving initial value problems, requires boost_ (&gt;=1.65.0).- `pycvodes &lt;https://github.com/bjodah/pycvodes&gt;`_: solving initial value problems, requires SUNDIALS_ (&gt;=5.3.0).- `pykinsol &lt;https://github.com/bjodah/pykinsol&gt;`_: solving non-linear root-finding, requires SUNDIALS_ (&gt;=5.3.0).- `pycompilation &lt;https://github.com/bjodah/pycompilation&gt;`_: python front-end for calling compilers, requires gcc/clang/icpc.- `pycodeexport &lt;https://github.com/bjodah/pycodeexport&gt;`_: package for code-generation, used when generating C++ code... _GSL: https://www.gnu.org/software/gsl/.. _boost: http://www.boost.org/.. _SUNDIALS: https://computation.llnl.gov/projects/sundialsif you want to see what packages need to be installed on a Debian based system you may look at this`Dockerfile &lt;scripts/environment/Dockerfile&gt;`_.Using Docker~~~~~~~~~~~~If you have `Docker &lt;https://www.docker.com&gt;`_ installed, you may use it to host a jupyternotebook server::  $ ./scripts/host-jupyter-using-docker.sh . 8888the first time you run the command, some dependencies will be downloaded. When the installationis complete there will be a link visible which you can open in your browser. You can also runthe test suite using the same docker-image::  $ ./scripts/host-jupyter-using-docker.sh . 0there will be a few skipped test (due to some dependencies not being installed by default) andquite a few warnings.Examples--------See demonstration scripts in `examples/ &lt;https://github.com/bjodah/chempy/tree/master/examples&gt;`_,and some rendered jupyter notebooks_.You may also browse the documentation for more examples. Below you will find a few code snippets:Parsing formulae~~~~~~~~~~~~~~~~.. code:: python   &gt;&gt;&gt; from chempy import Substance   &gt;&gt;&gt; ferricyanide = Substance.from_formula('Fe(CN)6-3')   &gt;&gt;&gt; ferricyanide.composition == {0: -3, 26: 1, 6: 6, 7: 6}  # 0 for charge   True   &gt;&gt;&gt; print(ferricyanide.unicode_name)   Fe(CN)₆³⁻   &gt;&gt;&gt; print(ferricyanide.latex_name + &quot;, &quot; + ferricyanide.html_name)   Fe(CN)_{6}^{3-}, Fe(CN)&lt;sub&gt;6&lt;/sub&gt;&lt;sup&gt;3-&lt;/sup&gt;   &gt;&gt;&gt; print('%.3f' % ferricyanide.mass)   211.955as you see, in composition, the atomic numbers (and 0 for charge) is used askeys and the count of each kind became respective value.Balancing stoichiometry of a chemical reaction~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~.. code:: python   &gt;&gt;&gt; from chempy import balance_stoichiometry  # Main reaction in NASA's booster rockets:   &gt;&gt;&gt; reac, prod = balance_stoichiometry({'NH4ClO4', 'Al'}, {'Al2O3', 'HCl', 'H2O', 'N2'})   &gt;&gt;&gt; from pprint import pprint   &gt;&gt;&gt; pprint(dict(reac))   {'Al': 10, 'NH4ClO4': 6}   &gt;&gt;&gt; pprint(dict(prod))   {'Al2O3': 5, 'H2O': 9, 'HCl': 6, 'N2': 3}   &gt;&gt;&gt; from chempy import mass_fractions   &gt;&gt;&gt; for fractions in map(mass_fractions, [reac, prod]):   ...     pprint({k: '{0:.3g} wt%'.format(v*100) for k, v in fractions.items()})   ...   {'Al': '27.7 wt%', 'NH4ClO4': '72.3 wt%'}   {'Al2O3': '52.3 wt%', 'H2O': '16.6 wt%', 'HCl': '22.4 wt%', 'N2': '8.62 wt%'}ChemPy can also balance reactions where the reacting species are more complex andare better described in other terms than their molecular formula. A silly, yetillustrative example would be how to make pancakes without any partially used packages:.. code:: python   &gt;&gt;&gt; substances = {s.name: s for s in [   ...     Substance('pancake', composition=dict(eggs=1, spoons_of_flour=2, cups_of_milk=1)),   ...     Substance('eggs_6pack', composition=dict(eggs=6)),   ...     Substance('milk_carton', composition=dict(cups_of_milk=4)),   ...     Substance('flour_bag', composition=dict(spoons_of_flour=60))   ... ]}   &gt;&gt;&gt; pprint([dict(_) for _ in balance_stoichiometry({'eggs_6pack', 'milk_carton', 'flour_bag'},   ...                                                {'pancake'}, substances=substances)])   [{'eggs_6pack': 10, 'flour_bag': 2, 'milk_carton': 15}, {'pancake': 60}]ChemPy can even handle reactions with linear dependencies (underdetermined systems), e.g.:.. code:: python   &gt;&gt;&gt; pprint([dict(_) for _ in balance_stoichiometry({'C', 'O2'}, {'CO2', 'CO'})])  # doctest: +SKIP   [{'C': x1 + 2, 'O2': x1 + 1}, {'CO': 2, 'CO2': x1}]the ``x1`` object above is an instance of SymPy's Symbol_. If we prefer to get a solutionwith minimal (non-zero) integer coefficients we can pass ``underdetermined=None``:.. code:: python   &gt;&gt;&gt; pprint([dict(_) for _ in balance_stoichiometry({'C', 'O2'}, {'CO2', 'CO'}, underdetermined=None)])   [{'C': 3, 'O2': 2}, {'CO': 2, 'CO2': 1}]note however that even though this solution is in some sense &quot;canonical&quot;,it is merely one of an infinite number of solutions (``x1`` from earlier may be any integer)... _Symbol: http://docs.sympy.org/latest/modules/core.html#sympy.core.symbol.SymbolBalancing reactions~~~~~~~~~~~~~~~~~~~.. code:: python   &gt;&gt;&gt; from chempy import Equilibrium   &gt;&gt;&gt; from sympy import symbols   &gt;&gt;&gt; K1, K2, Kw = symbols('K1 K2 Kw')   &gt;&gt;&gt; e1 = Equilibrium({'MnO4-': 1, 'H+': 8, 'e-': 5}, {'Mn+2': 1, 'H2O': 4}, K1)   &gt;&gt;&gt; e2 = Equilibrium({'O2': 1, 'H2O': 2, 'e-': 4}, {'OH-': 4}, K2)   &gt;&gt;&gt; coeff = Equilibrium.eliminate([e1, e2], 'e-')   &gt;&gt;&gt; coeff   [4, -5]   &gt;&gt;&gt; redox = e1*coeff[0] + e2*coeff[1]   &gt;&gt;&gt; print(redox)   32 H+ + 4 MnO4- + 20 OH- = 26 H2O + 4 Mn+2 + 5 O2; K1**4/K2**5   &gt;&gt;&gt; autoprot = Equilibrium({'H2O': 1}, {'H+': 1, 'OH-': 1}, Kw)   &gt;&gt;&gt; n = redox.cancel(autoprot)   &gt;&gt;&gt; n   20   &gt;&gt;&gt; redox2 = redox + n*autoprot   &gt;&gt;&gt; print(redox2)   12 H+ + 4 MnO4- = 6 H2O + 4 Mn+2 + 5 O2; K1**4*Kw**20/K2**5Working with units~~~~~~~~~~~~~~~~~~Functions and objects usefulfor working with units are available from the ``chempy.units`` module. Here is anexample of how ChemPy can check consistency of units:.. code:: python   &gt;&gt;&gt; from chempy import Reaction   &gt;&gt;&gt; r = Reaction.from_string(&quot;H2O -&gt; H+ + OH-; 1e-4/M/s&quot;)   Traceback (most recent call last):   ...   ValueError: Unable to convert between units of &quot;1/M&quot; and &quot;dimensionless&quot;   &gt;&gt;&gt; r = Reaction.from_string(&quot;H2O -&gt; H+ + OH-; 1e-4/s&quot;)   &gt;&gt;&gt; from chempy.units import to_unitless, default_units as u   &gt;&gt;&gt; to_unitless(r.param, 1/u.minute)   0.006right now the ``.units`` module wraps the quantities_ package with some minoradditions and work-arounds. However, there is no guarantee that the underlyingpackage will not change in a future version of ChemPy (there are many packagesfor dealing with units in the scientific Python ecosystem)... _quantities: http://python-quantities.readthedocs.io/en/latest/Chemical equilibria~~~~~~~~~~~~~~~~~~~If we want to predict pH of a bicarbonate solution we simply just need pKa and pKw values:.. code:: python   &gt;&gt;&gt; from collections import defaultdict   &gt;&gt;&gt; from chempy.equilibria import EqSystem   &gt;&gt;&gt; eqsys = EqSystem.from_string(&quot;&quot;&quot;HCO3- = H+ + CO3-2; 10**-10.3   ... H2CO3 = H+ + HCO3-; 10**-6.3   ... H2O = H+ + OH-; 10**-14/55.4   ... &quot;&quot;&quot;)  # pKa1(H2CO3) = 6.3 (implicitly incl. CO2(aq)), pKa2=10.3 &amp; pKw=14   &gt;&gt;&gt; arr, info, sane = eqsys.root(defaultdict(float, {'H2O': 55.4, 'HCO3-': 1e-2}))   &gt;&gt;&gt; conc = dict(zip(eqsys.substances, arr))   &gt;&gt;&gt; from math import log10   &gt;&gt;&gt; print(&quot;pH: %.2f&quot; % -log10(conc['H+']))   pH: 8.30here is another example for ammonia:.. code:: python   &gt;&gt;&gt; from chempy import Equilibrium   &gt;&gt;&gt; from chempy.chemistry import Species   &gt;&gt;&gt; water_autop = Equilibrium({'H2O'}, {'H+', 'OH-'}, 10**-14)  # unit &quot;molar&quot; assumed   &gt;&gt;&gt; ammonia_prot = Equilibrium({'NH4+'}, {'NH3', 'H+'}, 10**-9.24)  # same here   &gt;&gt;&gt; substances = [Species.from_formula(f) for f in 'H2O OH- H+ NH3 NH4+'.split()]   &gt;&gt;&gt; eqsys = EqSystem([water_autop, ammonia_prot], substances)   &gt;&gt;&gt; print('\n'.join(map(str, eqsys.rxns)))  # &quot;rxns&quot; short for &quot;reactions&quot;   H2O = H+ + OH-; 1e-14   NH4+ = H+ + NH3; 5.75e-10   &gt;&gt;&gt; init_conc = defaultdict(float, {'H2O': 1, 'NH3': 0.1})   &gt;&gt;&gt; x, sol, sane = eqsys.root(init_conc)   &gt;&gt;&gt; assert sol['success'] and sane   &gt;&gt;&gt; print(', '.join('%.2g' % v for v in x))   1, 0.0013, 7.6e-12, 0.099, 0.0013Concepts~~~~~~~~~ChemPy collects equations and utility functions for working withconcepts such as `ionic strength &lt;https://en.wikipedia.org/wiki/Ionic_strength&gt;`_:.. code:: python   &gt;&gt;&gt; from chempy.electrolytes import ionic_strength   &gt;&gt;&gt; ionic_strength({'Fe+3': 0.050, 'ClO4-': 0.150}) == .3   Truenote how ChemPy parsed the charges from the names of the substances. There arealso e.g. empirical equations and convenience classes for them available, e.g.:.. code:: python   &gt;&gt;&gt; from chempy.henry import Henry   &gt;&gt;&gt; kH_O2 = Henry(1.2e-3, 1800, ref='carpenter_1966')   &gt;&gt;&gt; print('%.1e' % kH_O2(298.15))   1.2e-03to get more information about e.g. this class, you may can look at the `API documentation`_... _API documentation: https://bjodah.github.io/chempy/latest/chempy.html#module-chempy.henryChemical kinetics (system of ordinary differential equations)~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~A common task when modelling problems in chemistry is to investigate the time dependenceof a system. This branch of study is known as`chemical kinetics &lt;https://en.wikipedia.org/wiki/Chemical_kinetics&gt;`_, and ChemPy hassome classes and functions for working with such problems:.. code:: python   &gt;&gt;&gt; from chempy import ReactionSystem  # The rate constants below are arbitrary   &gt;&gt;&gt; rsys = ReactionSystem.from_string(&quot;&quot;&quot;2 Fe+2 + H2O2 -&gt; 2 Fe+3 + 2 OH-; 42   ...     2 Fe+3 + H2O2 -&gt; 2 Fe+2 + O2 + 2 H+; 17   ...     H+ + OH- -&gt; H2O; 1e10   ...     H2O -&gt; H+ + OH-; 1e-4&quot;&quot;&quot;)  # &quot;[H2O]&quot; = 1.0 (actually 55.4 at RT)   &gt;&gt;&gt; from chempy.kinetics.ode import get_odesys   &gt;&gt;&gt; odesys, extra = get_odesys(rsys)   &gt;&gt;&gt; from collections import defaultdict   &gt;&gt;&gt; import numpy as np   &gt;&gt;&gt; tout = sorted(np.concatenate((np.linspace(0, 23), np.logspace(-8, 1))))   &gt;&gt;&gt; c0 = defaultdict(float, {'Fe+2': 0.05, 'H2O2': 0.1, 'H2O': 1.0, 'H+': 1e-2, 'OH-': 1e-12})   &gt;&gt;&gt; result = odesys.integrate(tout, c0, atol=1e-12, rtol=1e-14)   &gt;&gt;&gt; import matplotlib.pyplot as plt   &gt;&gt;&gt; fig, axes = plt.subplots(1, 2, figsize=(12, 5))   &gt;&gt;&gt; for ax in axes:   ...     _ = result.plot(names=[k for k in rsys.substances if k != 'H2O'], ax=ax)   ...     _ = ax.legend(loc='best', prop={'size': 9})   ...     _ = ax.set_xlabel('Time')   ...     _ = ax.set_ylabel('Concentration')   &gt;&gt;&gt; _ = axes[1].set_ylim([1e-13, 1e-1])   &gt;&gt;&gt; _ = axes[1].set_xscale('log')   &gt;&gt;&gt; _ = axes[1].set_yscale('log')   &gt;&gt;&gt; _ = fig.tight_layout()   &gt;&gt;&gt; _ = fig.savefig('examples/kinetics.png', dpi=72).. image:: https://raw.githubusercontent.com/bjodah/chempy/master/examples/kinetics.pngProperties~~~~~~~~~~One of the fundamental tasks in science is the careful collection of data about the worldaround us. ChemPy contains a growing collection of parametrizations from the scientificliterature with relevance in chemistry. Here is how you use one of these formulations:.. code:: python   &gt;&gt;&gt; from chempy import Substance   &gt;&gt;&gt; from chempy.properties.water_density_tanaka_2001 import water_density as rho   &gt;&gt;&gt; from chempy.units import to_unitless, default_units as u   &gt;&gt;&gt; water = Substance.from_formula('H2O')   &gt;&gt;&gt; for T_C in (15, 25, 35):   ...     concentration_H2O = rho(T=(273.15 + T_C)*u.kelvin, units=u)/water.molar_mass(units=u)   ...     print('[H2O] = %.2f M (at %d °C)' % (to_unitless(concentration_H2O, u.molar), T_C))   ...   [H2O] = 55.46 M (at 15 °C)   [H2O] = 55.35 M (at 25 °C)   [H2O] = 55.18 M (at 35 °C)Run notebooks using binder~~~~~~~~~~~~~~~~~~~~~~~~~~Using only a web-browser (and an internet connection) it is possible to explore thenotebooks here: (by the courtesy of the people behind mybinder).. image:: http://mybinder.org/badge.svg   :target: https://mybinder.org/v2/gh/bjodah/chempy/f5f2546e79e165ba8fb258fc87d83a7fbdcbad64?filepath=index.ipynb   :alt: BinderCiting------If you make use of ChemPy in e.g. academic work you may cite the following peer-reviewed publication:.. image:: http://joss.theoj.org/papers/10.21105/joss.00565/status.svg   :target: https://doi.org/10.21105/joss.00565   :alt: Journal of Open Source Software DOIDepending on what underlying solver you are using you should also cite the appropriate paper(you can look at the list of references in the JOSS article). If you need to reference,in addition to the paper, a specific point version of ChemPy (for e.g. reproducibility)you can get per-version DOIs from the zendodo archive:.. image:: https://zenodo.org/badge/8840/bjodah/chempy.svg   :target: https://zenodo.org/badge/latestdoi/8840/bjodah/chempy   :alt: Zenodo DOILicensing---------The source code is Open Source and is released under the very permissive`&quot;simplified (2-clause) BSD license&quot; &lt;https://opensource.org/licenses/BSD-2-Clause&gt;`_.See `LICENSE &lt;LICENSE&gt;`_ for further details.See also--------- `SymPy &lt;https://github.com/sympy/sympy&gt;`_- `pyneqsys &lt;https://github.com/bjodah/pyneqsys&gt;`_- `pyodesys &lt;https://github.com/bjodah/pyodesys&gt;`_- `thermo &lt;https://github.com/CalebBell/thermo&gt;`_Contributing------------Contributors are welcome to suggest improvements at https://github.com/bjodah/chempy(see further details `here &lt;CONTRIBUTING.rst&gt;`_).Author------Björn I. Dahlgren, contact: - gmail address: bjodah</longdescription>
</pkgmetadata>