<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Graph Weather&lt;!-- ALL-CONTRIBUTORS-BADGE:START - Do not remove or modify this section --&gt;[![All Contributors](https://img.shields.io/badge/all_contributors-9-orange.svg?style=flat-square)](#contributors-)&lt;!-- ALL-CONTRIBUTORS-BADGE:END --&gt;Implementation of the Graph Weather paper (https://arxiv.org/pdf/2202.07575.pdf) in PyTorch. Additionally, an implementationof a modified model that assimilates raw or processed observations into analysis files.## InstallationThis library can be installed through```bashpip install graph-weather```## Example UsageThe models generate the graphs internally, so the only thing that needs to be passed to the model is the node featuresin the same order as the ```lat_lons```.```pythonimport torchfrom graph_weather import GraphWeatherForecasterfrom graph_weather.models.losses import NormalizedMSELosslat_lons = []for lat in range(-90, 90, 1):    for lon in range(0, 360, 1):        lat_lons.append((lat, lon))model = GraphWeatherForecaster(lat_lons)features = torch.randn((2, len(lat_lons), 78))out = model(features)criterion = NormalizedMSELoss(lat_lons=lat_lons, feature_variance=torch.randn((78,)))loss = criterion(out, features)loss.backward()```And for the assimilation model, which assumes each lat/lon point also has a height above ground, and each observationis a single value + the relative time. The assimlation model also assumes the desired output grid is given to it aswell.```pythonimport torchfrom graph_weather import GraphWeatherAssimilatorfrom graph_weather.models.losses import NormalizedMSELossobs_lat_lons = []for lat in range(-90, 90, 7):    for lon in range(0, 180, 6):        obs_lat_lons.append((lat, lon, np.random.random(1)))    for lon in 360 * np.random.random(100):        obs_lat_lons.append((lat, lon, np.random.random(1)))output_lat_lons = []for lat in range(-90, 90, 5):    for lon in range(0, 360, 5):        output_lat_lons.append((lat, lon))model = GraphWeatherAssimilator(output_lat_lons=output_lat_lons, analysis_dim=24)features = torch.randn((1, len(obs_lat_lons), 2))lat_lon_heights = torch.tensor(obs_lat_lons)out = model(features, lat_lon_heights)assert not torch.isnan(out).all()assert out.size() == (1, len(output_lat_lons), 24)criterion = torch.nn.MSELoss()loss = criterion(out, torch.randn((1, len(output_lat_lons), 24)))loss.backward()```## Pretrained WeightsComing soon! We plan to train a model on GFS 0.25 degree operational forecasts, as well as MetOffice NWP forecasts.We also plan trying out adaptive meshes, and predicting future satellite imagery as well.## Training DataTraining data will be available through HuggingFace Datasets for the GFS forecasts. The initial set of data is available for [GFSv16 forecasts, raw observations, and FNL Analysis files from 2016 to 2022](https://huggingface.co/datasets/openclimatefix/gfs-reforecast), and for [ERA5 Reanlaysis](https://huggingface.co/datasets/openclimatefix/era5-reanalysis). MetOffice NWP forecasts we cannotredistribute, but can be accessed through [CEDA](https://data.ceda.ac.uk/).## Contributors ‚ú®Thanks goes to these wonderful people ([emoji key](https://allcontributors.org/docs/en/emoji-key)):&lt;!-- ALL-CONTRIBUTORS-LIST:START - Do not remove or modify this section --&gt;&lt;!-- prettier-ignore-start --&gt;&lt;!-- markdownlint-disable --&gt;&lt;table&gt;  &lt;tbody&gt;    &lt;tr&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;https://www.jacobbieker.com&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/7170359?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;Jacob Bieker&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;Jacob Bieker&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;https://github.com/openclimatefix/graph_weather/commits?author=jacobbieker&quot; title=&quot;Code&quot;&gt;üíª&lt;/a&gt;&lt;/td&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;http://jack-kelly.com&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/460756?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;Jack Kelly&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;Jack Kelly&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;#ideas-JackKelly&quot; title=&quot;Ideas, Planning, &amp; Feedback&quot;&gt;ü§î&lt;/a&gt;&lt;/td&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;https://github.com/byphilipp&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/59995258?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;byphilipp&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;byphilipp&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;#ideas-byphilipp&quot; title=&quot;Ideas, Planning, &amp; Feedback&quot;&gt;ü§î&lt;/a&gt;&lt;/td&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;http://iki.fi/markus.kaukonen&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/6195764?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;Markus Kaukonen&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;Markus Kaukonen&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;#question-paapu88&quot; title=&quot;Answering Questions&quot;&gt;üí¨&lt;/a&gt;&lt;/td&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;https://github.com/MoHawastaken&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/55447473?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;MoHawastaken&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;MoHawastaken&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;https://github.com/openclimatefix/graph_weather/issues?q=author%3AMoHawastaken&quot; title=&quot;Bug reports&quot;&gt;üêõ&lt;/a&gt;&lt;/td&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;http://www.ecmwf.int&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/47196359?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;Mihai&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;Mihai&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;#question-mishooax&quot; title=&quot;Answering Questions&quot;&gt;üí¨&lt;/a&gt;&lt;/td&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;https://github.com/vitusbenson&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/33334860?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;Vitus Benson&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;Vitus Benson&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;https://github.com/openclimatefix/graph_weather/issues?q=author%3Avitusbenson&quot; title=&quot;Bug reports&quot;&gt;üêõ&lt;/a&gt;&lt;/td&gt;    &lt;/tr&gt;    &lt;tr&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;https://github.com/dongZheX&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/36361726?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;dongZheX&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;dongZheX&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;#question-dongZheX&quot; title=&quot;Answering Questions&quot;&gt;üí¨&lt;/a&gt;&lt;/td&gt;      &lt;td align=&quot;center&quot; valign=&quot;top&quot; width=&quot;14.28%&quot;&gt;&lt;a href=&quot;https://github.com/sabbir2331&quot;&gt;&lt;img src=&quot;https://avatars.githubusercontent.com/u/25061297?v=4?s=100&quot; width=&quot;100px;&quot; alt=&quot;sabbir2331&quot;/&gt;&lt;br /&gt;&lt;sub&gt;&lt;b&gt;sabbir2331&lt;/b&gt;&lt;/sub&gt;&lt;/a&gt;&lt;br /&gt;&lt;a href=&quot;#question-sabbir2331&quot; title=&quot;Answering Questions&quot;&gt;üí¨&lt;/a&gt;&lt;/td&gt;    &lt;/tr&gt;  &lt;/tbody&gt;&lt;/table&gt;&lt;!-- markdownlint-restore --&gt;&lt;!-- prettier-ignore-end --&gt;&lt;!-- ALL-CONTRIBUTORS-LIST:END --&gt;This project follows the [all-contributors](https://github.com/all-contributors/all-contributors) specification. Contributions of any kind welcome!</longdescription>
</pkgmetadata>