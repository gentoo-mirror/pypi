<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>&lt;p align=&quot;center&quot;&gt;    &lt;br&gt;    &lt;img src=&quot;docs/_static/logo_final.png&quot; width=&quot;400&quot;/&gt;    &lt;br&gt;&lt;p&gt;&lt;div align=&quot;center&quot;&gt;  &lt;a href=&quot;https://github.com/salesforce/LAVIS/releases&quot;&gt;&lt;img alt=&quot;Latest Release&quot; src=&quot;https://img.shields.io/github/release/salesforce/LAVIS.svg&quot; /&gt;&lt;/a&gt;  &lt;a href=&quot;https://opensource.salesforce.com/LAVIS/index.html&quot;&gt;  &lt;img alt=&quot;docs&quot; src=&quot;https://github.com/salesforce/LAVIS/actions/workflows/docs.yaml/badge.svg&quot;/&gt;  &lt;a href=&quot;https://opensource.org/licenses/BSD-3-Clause&quot;&gt;  &lt;img alt=&quot;license&quot; src=&quot;https://img.shields.io/badge/License-BSD_3--Clause-blue.svg&quot;/&gt;  &lt;/a&gt;   &lt;a href=&quot;https://pepy.tech/project/salesforce-lavis&quot;&gt;  &lt;img alt=&quot;Downloads&quot; src=&quot;https://pepy.tech/badge/salesforce-lavis&quot;&gt;  &lt;/a&gt;&lt;/div&gt;&lt;div align=&quot;center&quot;&gt;&lt;a href=&quot;https://opensource.salesforce.com/LAVIS//latest/benchmark.html&quot;&gt;Benchmark&lt;/a&gt;,&lt;a href=&quot;https://arxiv.org/abs/2209.09019&quot;&gt;Technical Report&lt;/a&gt;,&lt;a href=&quot;https://opensource.salesforce.com/LAVIS//latest/index.html&quot;&gt;Documentation&lt;/a&gt;,&lt;a href=&quot;https://github.com/salesforce/LAVIS/tree/main/examples&quot;&gt;Jupyter Notebook Examples&lt;/a&gt;,&lt;a href=&quot;https://blog.salesforceairesearch.com/lavis-language-vision-library/&quot;&gt;Blog&lt;/a&gt;&lt;/div&gt;# LAVIS - A Library for Language-Vision Intelligence## What's New: ðŸŽ‰   * [Model Release] Jan 2023, released implementation of **BLIP-2** &lt;br&gt;  [Paper](https://arxiv.org/abs/2301.12597), [Project Page](https://github.com/salesforce/LAVIS/tree/main/projects/blip2), [![Hugging Face Spaces](https://img.shields.io/badge/%F0%9F%A4%97%20Hugging%20Face-Spaces-blue)](https://huggingface.co/spaces/Salesforce/BLIP2), [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/salesforce/LAVIS/blob/main/examples/blip2_instructed_generation.ipynb)  &gt; A generic and efficient pre-training strategy that easily harvests development of pretrained vision models and large language models (LLMs) for vision-language pretraining. BLIP-2 beats Flamingo on zero-shot VQAv2 (**65.0** vs **56.3**), establishing new state-of-the-art on zero-shot captioning (on NoCaps **121.6** CIDEr score vs previous best **113.2**). In addition, equipped with powerful LLMs (e.g. OPT, FlanT5), BLIP-2 also unlocks the new **zero-shot instructed vision-to-language generation** capabilities for various interesting applications!  * Jan 2023, LAVIS is now available on [PyPI](https://pypi.org/project/salesforce-lavis/) for installation!  * [Model Release] Dec 2022, released implementation of **Img2prompt-VQA** &lt;br&gt;  [Paper](https://arxiv.org/pdf/2212.10846.pdf), [Project Page](https://github.com/salesforce/LAVIS/tree/main/projects/img2prompt-vqa), [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/salesforce/LAVIS/blob/main/projects/img2prompt-vqa/img2prompt_vqa.ipynb)  &gt; A plug-and-play module that enables off-the-shelf use of Large Language Models (LLMs) for visual question answering (VQA). Img2Prompt-VQA surpasses Flamingo on zero-shot VQA on VQAv2 (61.9 vs 56.3), while in contrast requiring no end-to-end training!   * [Model Release] Oct 2022, released implementation of **PNP-VQA** (**EMNLP Findings 2022**, _&quot;Plug-and-Play VQA: Zero-shot VQA by Conjoining Large Pretrained Models with Zero Training&quot;_, by Anthony T.M.H. et al), &lt;br&gt;   [Paper](https://arxiv.org/abs/2210.08773), [Project Page](https://github.com/salesforce/LAVIS/tree/main/projects/pnp-vqa), [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/salesforce/LAVIS/blob/main/projects/pnp-vqa/pnp_vqa.ipynb))  &gt;  A modular zero-shot VQA framework that requires no PLMs training, achieving SoTA zero-shot VQA performance.     ## Table of Contents  - [Introduction](#introduction)  - [Installation](#installation)  - [Getting Started](#getting-started)    - [Model Zoo](#model-zoo)    - [Image Captioning](#image-captioning)    - [Visual question answering (VQA)](#visual-question-answering-vqa)    - [Unified Feature Extraction Interface](#unified-feature-extraction-interface)    - [Load Datasets](#load-datasets)  - [Jupyter Notebook Examples](#jupyter-notebook-examples)  - [Resources and Tools](#resources-and-tools)  - [Documentations](#documentations)  - [Ethical and Responsible Use](#ethical-and-responsible-use)  - [Technical Report and Citing LAVIS](#technical-report-and-citing-lavis)  - [License](#license)## IntroductionLAVIS is a Python deep learning library for LAnguage-and-VISion intelligence research and applications. This library aims to provide engineers and researchers with a one-stop solution to rapidly develop models for their specific multimodal scenarios, and benchmark them across standard and customized datasets.It features a unified interface design to access- **10+** tasks(retrieval, captioning, visual question answering, multimodal classification etc.);- **20+** datasets (COCO, Flickr, Nocaps, ConceptualCommons, SBU, etc.);- **30+** pretrained weights of state-of-the-art foundation language-vision models and their task-specific adaptations, including [ALBEF](https://arxiv.org/pdf/2107.07651.pdf),[BLIP](https://arxiv.org/pdf/2201.12086.pdf), [ALPRO](https://arxiv.org/pdf/2112.09583.pdf), [CLIP](https://arxiv.org/pdf/2103.00020.pdf).&lt;p align=&quot;center&quot;&gt;    &lt;br&gt;    &lt;img src=&quot;assets/demo-6.png&quot;/&gt;    &lt;br&gt;&lt;p&gt;Key features of LAVIS include:- **Unified and Modular Interface**: facilitating to easily leverage and repurpose existing modules (datasets, models, preprocessors), also to add new modules.- **Easy Off-the-shelf Inference and Feature Extraction**: readily available pre-trained models let you take advantage of state-of-the-art multimodal understanding and generation capabilities on your own data.- **Reproducible Model Zoo and Training Recipes**: easily replicate and extend state-of-the-art models on existing and new tasks.- **Dataset Zoo and Automatic Downloading Tools**: it can be a hassle to prepare the many language-vision datasets. LAVIS provides automatic downloading scripts to help prepare a large variety of datasets and their annotations.The following table shows the supported tasks, datasets and models in our library. This is a continuing effort and we are working on further growing the list.|                  Tasks                   |     Supported Models     |             Supported Datasets             || :--------------------------------------: | :----------------------: | :----------------------------------------: ||         Image-text Pre-training          |       ALBEF, BLIP        | COCO, VisualGenome, SBU ConceptualCaptions ||           Image-text Retrieval           |    ALBEF, BLIP, CLIP     |              COCO, Flickr30k               ||           Text-image Retrieval           |    ALBEF, BLIP, CLIP     |              COCO, Flickr30k               ||        Visual Question Answering         |       ALBEF, BLIP        |           VQAv2, OKVQA, A-OKVQA            ||             Image Captioning             |           BLIP           |                COCO, NoCaps                ||           Image Classification           |           CLIP           |                  ImageNet                  || Natural Language Visual Reasoning (NLVR) |       ALBEF, BLIP        |                   NLVR2                    ||          Visual Entailment (VE)          |          ALBEF           |                  SNLI-VE                   ||             Visual Dialogue              |           BLIP           |                  VisDial                   ||           Video-text Retrieval           |       BLIP, ALPRO        |               MSRVTT, DiDeMo               ||           Text-video Retrieval           |       BLIP, ALPRO        |               MSRVTT, DiDeMo               ||    Video Question Answering (VideoQA)    |       BLIP, ALPRO        |                MSRVTT, MSVD                ||              Video Dialogue              |         VGD-GPT          |                    AVSD                    ||      Multimodal Feature Extraction       | ALBEF, CLIP, BLIP, ALPRO |                 customized                 ||         Text-to-image Generation         |      [COMING SOON]       |                                            |## Installation1. (Optional) Creating conda environment```bashconda create -n lavis python=3.8conda activate lavis```2. install from [PyPI](https://pypi.org/project/salesforce-lavis/)```bashpip install salesforce-lavis```    3. Or, for development, you may build from source```bashgit clone https://github.com/salesforce/LAVIS.gitcd LAVISpip install -e .```## Getting Started### Model ZooModel zoo summarizes supported models in LAVIS, to view:```pythonfrom lavis.models import model_zooprint(model_zoo)# ==================================================# Architectures                  Types# ==================================================# albef_classification           ve# albef_feature_extractor        base# albef_nlvr                     nlvr# albef_pretrain                 base# albef_retrieval                coco, flickr# albef_vqa                      vqav2# alpro_qa                       msrvtt, msvd# alpro_retrieval                msrvtt, didemo# blip_caption                   base_coco, large_coco# blip_classification            base# blip_feature_extractor         base# blip_nlvr                      nlvr# blip_pretrain                  base# blip_retrieval                 coco, flickr# blip_vqa                       vqav2, okvqa, aokvqa# clip_feature_extractor         ViT-B-32, ViT-B-16, ViT-L-14, ViT-L-14-336, RN50# clip                           ViT-B-32, ViT-B-16, ViT-L-14, ViT-L-14-336, RN50# gpt_dialogue                   base```Letâ€™s see how to use models in LAVIS to perform inference on example data. We first load a sample image from local.```pythonimport torchfrom PIL import Image# setup device to usedevice = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)# load sample imageraw_image = Image.open(&quot;docs/_static/merlion.png&quot;).convert(&quot;RGB&quot;)```This example image shows [Merlion park](https://en.wikipedia.org/wiki/Merlion) ([source](https://theculturetrip.com/asia/singapore/articles/what-exactly-is-singapores-merlion-anyway/)), a landmark in Singapore.### Image CaptioningIn this example, we use the BLIP model to generate a caption for the image. To make inference even easier, we also associate eachpre-trained model with its preprocessors (transforms), accessed via ``load_model_and_preprocess()``.```pythonimport torchfrom lavis.models import load_model_and_preprocessdevice = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)# loads BLIP caption base model, with finetuned checkpoints on MSCOCO captioning dataset.# this also loads the associated image processorsmodel, vis_processors, _ = load_model_and_preprocess(name=&quot;blip_caption&quot;, model_type=&quot;base_coco&quot;, is_eval=True, device=device)# preprocess the image# vis_processors stores image transforms for &quot;train&quot; and &quot;eval&quot; (validation / testing / inference)image = vis_processors[&quot;eval&quot;](raw_image).unsqueeze(0).to(device)# generate captionmodel.generate({&quot;image&quot;: image})# ['a large fountain spewing water into the air']```### Visual question answering (VQA)BLIP model is able to answer free-form questions about images in natural language.To access the VQA model, simply replace the ``name`` and ``model_type`` argumentspassed to ``load_model_and_preprocess()``.```pythonfrom lavis.models import load_model_and_preprocessmodel, vis_processors, txt_processors = load_model_and_preprocess(name=&quot;blip_vqa&quot;, model_type=&quot;vqav2&quot;, is_eval=True, device=device)# ask a random question.question = &quot;Which city is this photo taken?&quot;image = vis_processors[&quot;eval&quot;](raw_image).unsqueeze(0).to(device)question = txt_processors[&quot;eval&quot;](question)model.predict_answers(samples={&quot;image&quot;: image, &quot;text_input&quot;: question}, inference_method=&quot;generate&quot;)# ['singapore']```### Unified Feature Extraction InterfaceLAVIS provides a unified interface to extract features from each architecture. To extract features, we load the feature extractor variants of each model.The multimodal feature can be used for multimodal classification.The low-dimensional unimodal features can be used to compute cross-modal similarity.```pythonfrom lavis.models import load_model_and_preprocessmodel, vis_processors, txt_processors = load_model_and_preprocess(name=&quot;blip_feature_extractor&quot;, model_type=&quot;base&quot;, is_eval=True, device=device)caption = &quot;a large fountain spewing water into the air&quot;image = vis_processors[&quot;eval&quot;](raw_image).unsqueeze(0).to(device)text_input = txt_processors[&quot;eval&quot;](caption)sample = {&quot;image&quot;: image, &quot;text_input&quot;: [text_input]}features_multimodal = model.extract_features(sample)print(features_multimodal.multimodal_embeds.shape)# torch.Size([1, 12, 768]), use features_multimodal[:,0,:] for multimodal classification tasksfeatures_image = model.extract_features(sample, mode=&quot;image&quot;)features_text = model.extract_features(sample, mode=&quot;text&quot;)print(features_image.image_embeds.shape)# torch.Size([1, 197, 768])print(features_text.text_embeds.shape)# torch.Size([1, 12, 768])# low-dimensional projected featuresprint(features_image.image_embeds_proj.shape)# torch.Size([1, 197, 256])print(features_text.text_embeds_proj.shape)# torch.Size([1, 12, 256])similarity = features_image.image_embeds_proj[:,0,:] @ features_text.text_embeds_proj[:,0,:].t()print(similarity)# tensor([[0.2622]])```### Load DatasetsLAVIS inherently supports a wide variety of common language-vision datasets by providing [automatic download tools](https://opensource.salesforce.com/LAVIS//latest/benchmark) to help download and organize these datasets. After downloading, to load the datasets, use the following code:```pythonfrom lavis.datasets.builders import dataset_zoodataset_names = dataset_zoo.get_names()print(dataset_names)# ['aok_vqa', 'coco_caption', 'coco_retrieval', 'coco_vqa', 'conceptual_caption_12m',#  'conceptual_caption_3m', 'didemo_retrieval', 'flickr30k', 'imagenet', 'laion2B_multi',#  'msrvtt_caption', 'msrvtt_qa', 'msrvtt_retrieval', 'msvd_caption', 'msvd_qa', 'nlvr',#  'nocaps', 'ok_vqa', 'sbu_caption', 'snli_ve', 'vatex_caption', 'vg_caption', 'vg_vqa']```After downloading the images, we can use ``load_dataset()`` to obtain the dataset.```pythonfrom lavis.datasets.builders import load_datasetcoco_dataset = load_dataset(&quot;coco_caption&quot;)print(coco_dataset.keys())# dict_keys(['train', 'val', 'test'])print(len(coco_dataset[&quot;train&quot;]))# 566747print(coco_dataset[&quot;train&quot;][0])# {'image': &lt;PIL.Image.Image image mode=RGB size=640x480&gt;,#  'text_input': 'A woman wearing a net on her head cutting a cake. ',#  'image_id': 0}```If you already host a local copy of the dataset, you can pass in the ``vis_path`` argument to change the default location to load images.```pythoncoco_dataset = load_dataset(&quot;coco_caption&quot;, vis_path=YOUR_LOCAL_PATH)```## Jupyter Notebook ExamplesSee [examples](https://github.com/salesforce/LAVIS/tree/main/examples) for more inference examples, e.g. captioning, feature extraction, VQA, GradCam, zeros-shot classification.## Resources and Tools- **Benchmarks**: see [Benchmark](https://opensource.salesforce.com/LAVIS//latest/benchmark) for instructions to evaluate and train supported models.- **Dataset Download and Browsing**: see [Dataset Download](https://opensource.salesforce.com/LAVIS//latest/benchmark) for instructions and automatic tools on download common language-vision datasets.- **GUI Demo**: to run the demo locally, run ```bash run_scripts/run_demo.sh``` and then follow the instruction on the prompts to view in browser. A web demo is coming soon.## DocumentationsFor more details and advanced usages, please refer to[documentation](https://opensource.salesforce.com/LAVIS//latest/index.html#).## Ethical and Responsible UseWe note that models in LAVIS provide no guarantees on their multimodal abilities; incorrect or biased predictions may be observed. In particular, the datasets and pretrained models utilized in LAVIS may contain socioeconomic biases which could result in misclassification and other unwanted behaviors such as offensive or inappropriate speech. We strongly recommend that users review the pre-trained models and overall system in LAVIS before practical adoption. We plan to improve the library by investigating and mitigating these potential biases andinappropriate behaviors in the future.## Technical Report and Citing LAVISYou can find more details in our [technical report](https://arxiv.org/abs/2209.09019).If you're using LAVIS in your research or applications, please cite using this BibTeX:```bibtex@misc{li2022lavis,      title={LAVIS: A Library for Language-Vision Intelligence},       author={Dongxu Li and Junnan Li and Hung Le and Guangsen Wang and Silvio Savarese and Steven C. H. Hoi},      year={2022},      eprint={2209.09019},      archivePrefix={arXiv},      primaryClass={cs.CV}}```## Contact usIf you have any questions, comments or suggestions, please do not hesitate to contact us at lavis@salesforce.com.## License[BSD 3-Clause License](LICENSE.txt)</longdescription>
</pkgmetadata>