<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># httptest[![Tests](https://github.com/pdxjohnny/httptest/actions/workflows/tests.yml/badge.svg?branch=master)](https://github.com/pdxjohnny/httptest/actions/workflows/tests.yml) [![codecov](https://codecov.io/gh/pdxjohnny/httptest/branch/master/graph/badge.svg)](https://codecov.io/gh/pdxjohnny/httptest)HTTP testing inspired by golang's httptest package. Supports wrapping asynciocoroutine functions (`async def`).## Usage### Context Manager```pythonimport unittestimport urllib.requestimport httptestclass TestHTTPServer(httptest.Handler):    def do_GET(self):        contents = &quot;what up&quot;.encode()        self.send_response(200)        self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;)        self.send_header(&quot;Content-length&quot;, len(contents))        self.end_headers()        self.wfile.write(contents)def main():    with httptest.Server(TestHTTPServer) as ts:        with urllib.request.urlopen(ts.url()) as f:            assert f.read().decode('utf-8') == &quot;what up&quot;if __name__ == '__main__':    main()```### Simple HTTP Server Handler```pythonimport unittestimport urllib.requestimport httptestclass TestHTTPServer(httptest.Handler):    def do_GET(self):        contents = &quot;what up&quot;.encode()        self.send_response(200)        self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;)        self.send_header(&quot;Content-length&quot;, len(contents))        self.end_headers()        self.wfile.write(contents)class TestHTTPTestMethods(unittest.TestCase):    @httptest.Server(TestHTTPServer)    def test_call_response(self, ts=httptest.NoServer()):        with urllib.request.urlopen(ts.url()) as f:            self.assertEqual(f.read().decode('utf-8'), &quot;what up&quot;)if __name__ == '__main__':    unittest.main()```### Serve Files```pythonimport pathlibimport unittestimport http.serverimport urllib.requestimport httptestFILE_PATH = pathlib.Path(__file__)class TestHTTPTestMethods(unittest.TestCase):    @httptest.Server(        lambda *args: http.server.SimpleHTTPRequestHandler(            *args, directory=FILE_PATH.parent        )    )    def test_call_response(self, ts=httptest.NoServer()):        with urllib.request.urlopen(ts.url() + FILE_PATH.name) as f:            self.assertEqual(f.read().decode('utf-8'), FILE_PATH.read_text())if __name__ == '__main__':    unittest.main()```### Asyncio SupportAsyncio support for the unittest package hasn't yet landed in Python.[python/issue32972](https://bugs.python.org/issue32972).It should land in 3.8, check it out[here](https://github.com/python/cpython/pull/13386).If you want a quick way to add `asyncio` test cases you can import the helperfrom [intel/dffml](https://github.com/intel/dffml).```pythonimport sysimport unittestimport urllib.requestif sys.version_info.minor == 3 \        and sys.version_info.minor &lt;= 7:    from dffml.util.asynctestcase import AsyncTestCaseelse:    # In Python 3.8    from unittest import IsolatedAsyncioTestCase as AsyncTestCaseimport httptestclass TestHTTPServer(httptest.Handler):    def do_GET(self):        contents = &quot;what up&quot;.encode()        self.send_response(200)        self.send_header(&quot;Content-type&quot;, &quot;text/plain&quot;)        self.send_header(&quot;Content-length&quot;, len(contents))        self.end_headers()        self.wfile.write(contents)class TestHTTPTestMethods(AsyncTestCase):    @httptest.Server(TestHTTPServer)    async def test_call_response(self, ts=httptest.NoServer()):        with urllib.request.urlopen(ts.url()) as f:            self.assertEqual(f.read().decode('utf-8'), &quot;what up&quot;)if __name__ == '__main__':    unittest.main()```In your project's `setup.py`, add `dffml` in `tests_require`.```pythonsetup(    name='your_package',    ...    tests_require=[        'httptest&gt;=0.1.0',        'dffml&gt;=0.4.0.post0'    ])```## Auto InstallIf you're making a python package, you'll want to add `httptest` to your`setup.py` file's `tests_require` section.This way, when your run `python setup.py test` setuptools will install`httptest` for you in a package local directory, if it's not already installed.```pythonsetup(    name='your_package',    ...    tests_require=[        'httptest&gt;=0.1.0'    ])```</longdescription>
</pkgmetadata>