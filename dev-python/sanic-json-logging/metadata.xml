<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>==================sanic-json-logging==================.. image:: https://img.shields.io/pypi/v/sanic-json-logging.svg        :target: https://pypi.python.org/pypi/sanic-json-logging.. image:: https://travis-ci.com/terrycain/sanic-json-logging.svg?branch=master        :target: https://travis-ci.com/terrycain/sanic-json-logging.. image:: https://codecov.io/gh/terrycain/sanic-json-logging/branch/master/graph/badge.svg        :target: https://codecov.io/gh/terrycain/sanic-json-logging        :alt: Code coverage.. image:: https://pyup.io/repos/github/terrycain/sanic-json-logging/shield.svg     :target: https://pyup.io/repos/github/terrycain/sanic-json-logging/     :alt: UpdatesThe other day I was running some containers on Amazon's ECS and logging to cloudwatch. I then learnt cloudwatch parses JSON logs soobviously I then wanted Sanic to log out JSON.Ideally this'll be useful to people but if it isn't, raise an issue and we'll make it better :)To install:.. code-block:: bash    pip install sanic-json-loggingLook at ``examples/simple.py`` for a full working example, but this will essentially get you going.. code-block:: python    import sanic    from sanic_json_logging import setup_json_logging    app = sanic.Sanic(name=&quot;somename&quot;)    setup_json_logging(app)``setup_json_logging`` does the following:- changes the default log formatters to JSON ones- also filters out no Keepalive warnings- unless told otherwise, will change the asyncio task factory, to implement some rudimentary task-local storage.- installs pre and post request middleware. Pre-request middleware to time tasks and generate a uuid4 request id. Post-request middleware to emit access logs.- will use AWS X-Forwarded-For IPs in the access logs if presentIf ``setup_json_logging`` changed the task factory, all tasks created from the request's task will contain the request ID.You can pass ``disable_json_access_log=True`` to the setup function which will disable the configuration of JSON access logging.Setting ``configure_task_local_storage`` to false will disable storing request IDs inside the task object which willCurrently I have it outputting access logs like.. code-block:: json    {      &quot;timestamp&quot;: &quot;2018-06-09T17:42:52.195701Z&quot;,      &quot;level&quot;: &quot;INFO&quot;,      &quot;method&quot;: &quot;GET&quot;,      &quot;path&quot;: &quot;/endpoint1&quot;,      &quot;remote&quot;: &quot;127.0.0.1:33468&quot;,      &quot;user_agent&quot;: &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.62 Safari/537.36&quot;,      &quot;host&quot;: &quot;localhost:8000&quot;,      &quot;response_time&quot;: 0.0,      &quot;req_id&quot;: &quot;795617c7-b514-4ed9-bb63-cc4fcd883c3d&quot;,      &quot;logger&quot;: &quot;sanic.access&quot;,      &quot;status_code&quot;: 200,      &quot;length&quot;: 0,      &quot;type&quot;: &quot;access&quot;    }And if you log to the ``root`` logger, inside a request, it'll look like this... code-block:: json    {      &quot;timestamp&quot;: &quot;2018-06-09T17:42:52.195326Z&quot;,      &quot;level&quot;: &quot;INFO&quot;,      &quot;message&quot;: &quot;some informational message&quot;,      &quot;type&quot;: &quot;log&quot;,      &quot;logger&quot;: &quot;root&quot;,      &quot;filename&quot;: &quot;simple.py&quot;,      &quot;lineno&quot;: 16,      &quot;req_id&quot;: &quot;795617c7-b514-4ed9-bb63-cc4fcd883c3d&quot;    }By default this package logs Exceptions with tracebacks as strings, you might want to render the traceback as JSON aswell. To achieve this simply provide an alternate formatter.First install this package with its optional dependencies:.. code-block:: bash    pip install sanic-json-logging[extratb]Then inject another Formatter:.. code-block:: python        from sanic_json_logging import LOGGING_CONFIG_DEFAULTS as cfg        cfg[&quot;formatters&quot;][&quot;generic&quot;][&quot;class&quot;] = &quot;sanic_json_logging.formatters.JSONTracebackJSONFormatter&quot;        setup_json_logging(app, disable_json_access_log=True, config=cfg)After all your tracebacks are formatted properly as JSON:.. code-block:: json  {    &quot;timestamp&quot;: &quot;2021-08-26T23:19:49.412293Z&quot;,    &quot;level&quot;: &quot;ERROR&quot;,    &quot;message&quot;: &quot;Exception occurred while handling uri: 'http://127.0.0.1:8000/'&quot;,    &quot;type&quot;: &quot;exception&quot;,    &quot;logger&quot;: &quot;sanic.error&quot;,    &quot;worker&quot;: 31915,    &quot;filename&quot;: &quot;handlers.py&quot;,    &quot;lineno&quot;: 146,    &quot;traceback&quot;: {      &quot;exc_type&quot;: &quot;Exception&quot;,      &quot;exc_msg&quot;: &quot;foo&quot;,      &quot;exc_tb&quot;: {        &quot;frames&quot;: [          {            &quot;func_name&quot;: &quot;handle_request&quot;,            &quot;lineno&quot;: 770,            &quot;module_name&quot;: &quot;sanic.app&quot;,            &quot;module_path&quot;: &quot;/python3.9/site-packages/sanic/app.py&quot;,            &quot;lasti&quot;: 182,            &quot;line&quot;: &quot;                    response = await response&quot;          },          {            &quot;func_name&quot;: &quot;root&quot;,            &quot;lineno&quot;: 20,            &quot;module_name&quot;: &quot;api.general&quot;,            &quot;module_path&quot;: &quot;/api/general.py&quot;,            &quot;lasti&quot;: 6,            &quot;line&quot;: &quot;    raise Exception(\&quot;foo\&quot;)&quot;          }        ]      }    },    &quot;req_id&quot;: &quot;f128370f-b949-44e7-bb94-4635bbcad486&quot;  }Changelog---------4.1.2=====* @digitalkaoz fixed more bugs with the traceback formatter4.1.1=====* Updated tests for alternative traceback formatter4.1.0=====* Added ability to set custom formatters* Added optional extensive traceback formatter4.0.1=====* properly disable access logs4.0.0=====* Added flake8, black, isort, mypy* Dropped Travis in favour of Github Actions* Switched from setup.py to using Poetry* Updated tests to use ``sanic-testing``3.2.0=====* Updated to use new ``request.ctx`` context dictionary* Added support for Python 3.7 asyncio changes3.1.0=====* Stringify any LogRecord message if its not JSON serializable3.0.0=====* Added option to disable task local storage2.0.0=====* Removed NoAccessLogSanic subclass in favour of setup argument1.3.0=====* Added Request ID to ``request`` dict* fixed move to travis.com1.2.0=====* Fixed UA header bug, fixed tests1.1.1=====* Pretty much first decent version</longdescription>
</pkgmetadata>