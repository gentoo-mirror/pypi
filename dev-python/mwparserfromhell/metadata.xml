<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>mwparserfromhell================.. image:: https://api.travis-ci.com/earwig/mwparserfromhell.svg  :alt: Build Status  :target: https://travis-ci.org/earwig/mwparserfromhell.. image:: https://img.shields.io/coveralls/earwig/mwparserfromhell/main.svg  :alt: Coverage Status  :target: https://coveralls.io/r/earwig/mwparserfromhell**mwparserfromhell** (the *MediaWiki Parser from Hell*) is a Python packagethat provides an easy-to-use and outrageously powerful parser for MediaWiki_wikicode. It supports Python 3.5+.Developed by Earwig_ with contributions from `Σ`_, Legoktm_, and others.Full documentation is available on ReadTheDocs_. Development occurs on GitHub_.Installation------------The easiest way to install the parser is through the `Python Package Index`_;you can install the latest release with ``pip install mwparserfromhell``(`get pip`_). Make sure your pip is up-to-date first, especially on Windows.Alternatively, get the latest development version::    git clone https://github.com/earwig/mwparserfromhell.git    cd mwparserfromhell    python setup.py installThe comprehensive unit testing suite requires `pytest`_ (``pip install pytest``)and can be run with ``python -m pytest``.Usage-----Normal usage is rather straightforward (where ``text`` is page text):&gt;&gt;&gt; import mwparserfromhell&gt;&gt;&gt; wikicode = mwparserfromhell.parse(text)``wikicode`` is a ``mwparserfromhell.Wikicode`` object, which acts like anordinary ``str`` object with some extra methods. For example:&gt;&gt;&gt; text = &quot;I has a template! {{foo|bar|baz|eggs=spam}} See it?&quot;&gt;&gt;&gt; wikicode = mwparserfromhell.parse(text)&gt;&gt;&gt; print(wikicode)I has a template! {{foo|bar|baz|eggs=spam}} See it?&gt;&gt;&gt; templates = wikicode.filter_templates()&gt;&gt;&gt; print(templates)['{{foo|bar|baz|eggs=spam}}']&gt;&gt;&gt; template = templates[0]&gt;&gt;&gt; print(template.name)foo&gt;&gt;&gt; print(template.params)['bar', 'baz', 'eggs=spam']&gt;&gt;&gt; print(template.get(1).value)bar&gt;&gt;&gt; print(template.get(&quot;eggs&quot;).value)spamSince nodes can contain other nodes, getting nested templates is trivial:&gt;&gt;&gt; text = &quot;{{foo|{{bar}}={{baz|{{spam}}}}}}&quot;&gt;&gt;&gt; mwparserfromhell.parse(text).filter_templates()['{{foo|{{bar}}={{baz|{{spam}}}}}}', '{{bar}}', '{{baz|{{spam}}}}', '{{spam}}']You can also pass ``recursive=False`` to ``filter_templates()`` and exploretemplates manually. This is possible because nodes can contain additional``Wikicode`` objects:&gt;&gt;&gt; code = mwparserfromhell.parse(&quot;{{foo|this {{includes a|template}}}}&quot;)&gt;&gt;&gt; print(code.filter_templates(recursive=False))['{{foo|this {{includes a|template}}}}']&gt;&gt;&gt; foo = code.filter_templates(recursive=False)[0]&gt;&gt;&gt; print(foo.get(1).value)this {{includes a|template}}&gt;&gt;&gt; print(foo.get(1).value.filter_templates()[0]){{includes a|template}}&gt;&gt;&gt; print(foo.get(1).value.filter_templates()[0].get(1).value)templateTemplates can be easily modified to add, remove, or alter params. ``Wikicode``objects can be treated like lists, with ``append()``, ``insert()``,``remove()``, ``replace()``, and more. They also have a ``matches()`` methodfor comparing page or template names, which takes care of capitalization andwhitespace:&gt;&gt;&gt; text = &quot;{{cleanup}} '''Foo''' is a [[bar]]. {{uncategorized}}&quot;&gt;&gt;&gt; code = mwparserfromhell.parse(text)&gt;&gt;&gt; for template in code.filter_templates():...     if template.name.matches(&quot;Cleanup&quot;) and not template.has(&quot;date&quot;):...         template.add(&quot;date&quot;, &quot;July 2012&quot;)...&gt;&gt;&gt; print(code){{cleanup|date=July 2012}} '''Foo''' is a [[bar]]. {{uncategorized}}&gt;&gt;&gt; code.replace(&quot;{{uncategorized}}&quot;, &quot;{{bar-stub}}&quot;)&gt;&gt;&gt; print(code){{cleanup|date=July 2012}} '''Foo''' is a [[bar]]. {{bar-stub}}&gt;&gt;&gt; print(code.filter_templates())['{{cleanup|date=July 2012}}', '{{bar-stub}}']You can then convert ``code`` back into a regular ``str`` object (forsaving the page!) by calling ``str()`` on it:&gt;&gt;&gt; text = str(code)&gt;&gt;&gt; print(text){{cleanup|date=July 2012}} '''Foo''' is a [[bar]]. {{bar-stub}}&gt;&gt;&gt; text == codeTrueLimitations-----------While the MediaWiki parser generates HTML and has access to the contents oftemplates, among other things, mwparserfromhell acts as a direct interface tothe source code only. This has several implications:* Syntax elements produced by a template transclusion cannot be detected. For  example, imagine a hypothetical page ``&quot;Template:End-bold&quot;`` that contained  the text ``&lt;/b&gt;``. While MediaWiki would correctly understand that  ``&lt;b&gt;foobar{{end-bold}}`` translates to ``&lt;b&gt;foobar&lt;/b&gt;``, mwparserfromhell  has no way of examining the contents of ``{{end-bold}}``. Instead, it would  treat the bold tag as unfinished, possibly extending further down the page.* Templates adjacent to external links, as in ``http://example.com{{foo}}``,  are considered part of the link. In reality, this would depend on the  contents of the template.* When different syntax elements cross over each other, as in  ``{{echo|''Hello}}, world!''``, the parser gets confused because this cannot  be represented by an ordinary syntax tree. Instead, the parser will treat the  first syntax construct as plain text. In this case, only the italic tag would  be properly parsed.  **Workaround:** Since this commonly occurs with text formatting and text  formatting is often not of interest to users, you may pass  *skip_style_tags=True* to ``mwparserfromhell.parse()``. This treats ``''``  and ``'''`` as plain text.  A future version of mwparserfromhell may include multiple parsing modes to  get around this restriction more sensibly.Additionally, the parser lacks awareness of certain wiki-specific settings:* `Word-ending links`_ are not supported, since the linktrail rules are  language-specific.* Localized namespace names aren't recognized, so file links (such as  ``[[File:...]]``) are treated as regular wikilinks.* Anything that looks like an XML tag is treated as a tag, even if it is not a  recognized tag name, since the list of valid tags depends on loaded MediaWiki  extensions.Integration-----------``mwparserfromhell`` is used by and originally developed for EarwigBot_;``Page`` objects have a ``parse`` method that essentially calls``mwparserfromhell.parse()`` on ``page.get()``.If you're using Pywikibot_, your code might look like this:.. code-block:: python    import mwparserfromhell    import pywikibot    def parse(title):        site = pywikibot.Site()        page = pywikibot.Page(site, title)        text = page.get()        return mwparserfromhell.parse(text)If you're not using a library, you can parse any page with the followingPython 3 code (using the API_ and the requests_ library):.. code-block:: python    import mwparserfromhell    import requests    API_URL = &quot;https://en.wikipedia.org/w/api.php&quot;    def parse(title):        params = {            &quot;action&quot;: &quot;query&quot;,            &quot;prop&quot;: &quot;revisions&quot;,            &quot;rvprop&quot;: &quot;content&quot;,            &quot;rvslots&quot;: &quot;main&quot;,            &quot;rvlimit&quot;: 1,            &quot;titles&quot;: title,            &quot;format&quot;: &quot;json&quot;,            &quot;formatversion&quot;: &quot;2&quot;,        }        headers = {&quot;User-Agent&quot;: &quot;My-Bot-Name/1.0&quot;}        req = requests.get(API_URL, headers=headers, params=params)        res = req.json()        revision = res[&quot;query&quot;][&quot;pages&quot;][0][&quot;revisions&quot;][0]        text = revision[&quot;slots&quot;][&quot;main&quot;][&quot;content&quot;]        return mwparserfromhell.parse(text).. _MediaWiki:              https://www.mediawiki.org.. _ReadTheDocs:            https://mwparserfromhell.readthedocs.io.. _Earwig:                 https://en.wikipedia.org/wiki/User:The_Earwig.. _Σ:                      https://en.wikipedia.org/wiki/User:%CE%A3.. _Legoktm:                https://en.wikipedia.org/wiki/User:Legoktm.. _GitHub:                 https://github.com/earwig/mwparserfromhell.. _Python Package Index:   https://pypi.org/.. _get pip:                https://pypi.org/project/pip/.. _pytest:                 https://docs.pytest.org/.. _Word-ending links:      https://www.mediawiki.org/wiki/Help:Links#linktrail.. _EarwigBot:              https://github.com/earwig/earwigbot.. _Pywikibot:              https://www.mediawiki.org/wiki/Manual:Pywikibot.. _API:                    https://www.mediawiki.org/wiki/API:Main_page.. _requests:               https://2.python-requests.org</longdescription>
</pkgmetadata>