<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># luciferaseTool for plotting luciferase reporter data. Thanks due to Joshua Chiou and Mei-lin Okino for inspiration and contributions.## InstallationTo use `luciferase`, you must first have [python](https://www.python.org/downloads/) installed. Then, you can install `luciferase` using `pip`:```shpip install luciferase```or```shpip install --user luciferase```## Command-line interface for barplots## IntroductionThis introduction demonstrates a simple analysis of data in Excel format.Here is our [example dataset](https://github.com/anthony-aylward/luciferase/raw/master/example/example-excel.xlsx), `example-excel.xlsx`:![screenshot of excel data](https://github.com/anthony-aylward/luciferase/raw/master/example/example-excel-screenshot.png)The first row contains headers and subsequent rows contain firefly/renilla ratios normalized to the empty vector.We can analyze these data by running:```luciferase-swarmplot example-excel.xlsx example-excel-plot.pdf```Here is the result:&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/example-excel-plot.png&quot; width=&quot;400&quot;/&gt;We can also use input data with more columns to produce plots with more bars. For example:![screenshot of expanded excel data](https://github.com/anthony-aylward/luciferase/raw/master/example/example-excel-expanded-screenshot.png)```luciferase-swarmplot example-excel-expanded.xlsx example-excel-expanded-plot.pdf```&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/example-excel-expanded-plot.png&quot; width=&quot;400&quot;/&gt;See the following sections for more details.### Barplots of enhancer activityA command-line tool called `luciferase-barplot` for creating bar plots isincluded. After installing `luciferase`, you can use it like this:```shluciferase-barplot example.json example.pdfluciferase-barplot example.csv example.pngluciferase-barplot example.tsv example.svgluciferase-barplot example.xls example.pdfluciferase-barplot example.xlsx example.png```JSON, CSV, TSV, or Excel files may be used as inputs, and outputcan be written in PDF, PNG, or SVG.See also the help message:```shluciferase-barplot -h```Examples of luciferase reporter data in JSON format:```json{  &quot;Non-risk, Fwd&quot;: [8.354, 12.725, 8.506],  &quot;Risk, Fwd&quot;: [5.078, 5.038, 5.661],  &quot;Non-risk, Rev&quot;: [9.564, 9.692, 12.622],  &quot;Risk, Rev&quot;: [10.777, 11.389, 10.598],  &quot;Empty&quot;: [1.042, 0.92, 1.042]}``````json{  &quot;Alt, MIN6&quot;: [5.47, 7.17, 6.15],  &quot;Ref, MIN6&quot;: [3.16, 3.04, 4.34],  &quot;Empty, MIN6&quot;: [1.07, 0.83, 0.76],  &quot;Alt, ALPHA-TC6&quot;: [2.50, 3.47, 3.33],  &quot;Ref, ALPHA-TC6&quot;: [2.01, 1.96, 2.31],  &quot;Empty, ALPHA-TC6&quot;: [1.042, 0.92, 1.042]}```Examples of luciferase reporter data in TSV format:```Non-risk, FwdRisk, FwdNon-risk, RevRisk, RevEmpty8.3545.0789.56410.7771.04212.7255.0389.69211.3890.928.5065.66112.62210.5981.042``````Ref, untreatedAlt, untreatedEmpty, untreatedRef, dexAlt, dexEmpty, dex33.219.71.0149.444.61.130.316.21.099.737.61.033.318.31.0124.537.70.9```Significance indicators will be written above the bars: `***` if p&lt;0.001,`**` if p&lt;0.01, `*` if p&lt;0.05, `ns` otherwise.Here are the resulting plots:&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/example-5.png&quot; width=&quot;400&quot;/&gt;&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/example-6.png&quot; width=&quot;400&quot;/&gt;### Barplots of allelic ratioA second tool called `luciferase-ratioplot` takes the same input data andproduces a comparative plot of allelic ratios:```shluciferase-ratioplot --xlab control dexamethasone --ylab &quot;Ref:Alt ratio&quot; --title Default ratio.json ratio.pngluciferase-ratioplot --xlab control dexamethasone --ylab &quot;Alt:Ref ratio&quot; --title Inverted --invert ratio.json ratio.png```The resulting plot shows the estimated allelic ratio of enhancer activitywith confidence intervals (95% by default). Here is an example input datasetand plot:JSON:```json{  &quot;Ref, untreated&quot;: [33.2, 30.3, 33.3],  &quot;Alt, untreated&quot;: [19.7, 16.2, 18.3],  &quot;Empty, untreated&quot;: [1.0, 1.0, 1.0],  &quot;Ref, dex&quot;: [149.4, 99.7, 124.5],  &quot;Alt, dex&quot;: [44.6, 37.6, 37.7],  &quot;Empty, dex&quot;: [1.1, 1.0, 0.9]}```TSV:```Alt, dexRef, dexEmpty, dexAlt, untreatedRef, untreatedEmpty, untreated44.6149.41.119.733.21.037.699.71.016.230.31.037.7124.50.918.333.31.0```&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/ratio.png&quot; width=&quot;200&quot;/&gt;&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/ratio-invert.png&quot; width=&quot;200&quot;/&gt;## Meta-analysisFor this section, we'll use another included command called`luciferase-swarmplot`. It functions exactly like `luciferase-barplot` exceptthat individual data points will be plotted over the bars.It may be that we have performed two or more experiments(from separate minipreps) and wish to meta-analyze the results. As an example,let's consider the results of two identical experiments on a regulatoryvariant at the _SIX3_ locus: [SIX3-MP0](https://github.com/anthony-aylward/luciferase/raw/master/example/six3-mp0.json) and [SIX3-MP1](https://github.com/anthony-aylward/luciferase/raw/master/example/six3-mp1.json). First we'll plot both datasets separately:```shluciferase-swarmplot six3-mp0.json six3-mp0.png --light-colors '#DECBE4' '#FED9A6' '#FBB4AE' --dark-colors '#984EA3' '#FF7F00' '#E41A1C' --title 'SIX3-MP0'luciferase-swarmplot six3-mp1.json six3-mp1.png --light-colors '#DECBE4' '#FED9A6' '#FBB4AE' --dark-colors '#984EA3' '#FF7F00' '#E41A1C' --title 'SIX3-MP1'```&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/six3-mp0.png&quot; width=&quot;400&quot;/&gt;&lt;img src=&quot;https://github.com/anthony-aylward/luciferase/raw/master/example/six3-mp1.png&quot; width=&quot;400&quot;/&gt;We can see that the results are fairly consistent in character, but checkingthe y-axis tells us that they are on different scales. Intuitively, we mightconclude from these results that there are allelic effects under all threeconditions. Ideally though, we would like to use all of the data at once forone plot to get the most accurate conclusions about allelic effects.We might simply combine the data into one dataset, (as [here](https://github.com/anthony-aylward/luciferase/raw/master/example/six3-meta-nobatch.json)) and plot it:```shluciferase-swarmplot six3-meta-nobatch.json six3-meta-nobatch.png --light-colors '#DECBE4' '#FED9A6' '#FBB4AE' --dark-colors '#984EA3' '#FF7F00' '#E41A1C'```![meta-analysis without batch](https://github.com/anthony-aylward/luciferase/raw/master/example/six3-meta-nobatch.png)The bar heights look reasonable, and the allelic effects appear clear fromlooking at them, but all of the hypothesis tests returned non-significantresults. What gives?The answer is that combining data from experiments with different scalesbreaks the assumptions of the significance test (a t-test). To meta-analyzethese data in a useful way, we first need to re-normalize the two experimentsto put both of them on the same scale. `luciferase-barplot` and`luciferase-swarmplot` will re-normalize the data automatically if the datasetincludes an additional entry (&quot;Batch&quot;) indicating the batch of each data point,as in this example:[SIX3-META](https://github.com/anthony-aylward/luciferase/raw/master/example/six3-meta.json).```json{  &quot;Alt, untreated&quot;: [19.7, 16.2, 18.3, 6.5, 8.0, 4.4],  &quot;Ref, untreated&quot;: [33.2, 30.3, 33.3, 8.4, 13.6, 17.1],  &quot;Empty, untreated&quot;: [1.0, 1.0, 1.0, 1.1, 1.0, 0.9],  &quot;Alt, hi_cyt_noTNFA&quot;: [11.0, 8.8, 10.1, 3.2, 3.7, 3.3],  &quot;Ref, hi_cyt_noTNFA&quot;: [17.1, 16.7, 18.8, 7.6, 6.7, 5.5],  &quot;Empty, hi_cyt_noTNFA&quot;: [1.1, 0.9, 1.0, 1.1, 0.9, 1.0],  &quot;Alt, hi_cyt&quot;: [10.8, 10.9, 9.1, 3.1, 2.7, 4.0],  &quot;Ref, hi_cyt&quot;: [17.8, 16.1, 18.0, 7.7, 7.0, 7.1],  &quot;Empty, hi_cyt&quot;: [1.0, 1.0, 1.0, 1.0, 1.0, 1.1],  &quot;Batch&quot;: [0, 0, 0, 1, 1, 1]}```Here is what the results look like when they're re-normalized to correct forbatch```shluciferase-swarmplot six3-meta.json six3-meta.png --light-colors '#DECBE4' '#FED9A6' '#FBB4AE' --dark-colors '#984EA3' '#FF7F00' '#E41A1C' --title 'SIX3-META'```![meta-analysis with batch](https://github.com/anthony-aylward/luciferase/raw/master/example/six3-meta.png)See a more detailed explanation of the normalization procedure [here](https://github.com/anthony-aylward/luciferase/blob/master/example/meta-analysis.pdf)</longdescription>
</pkgmetadata>