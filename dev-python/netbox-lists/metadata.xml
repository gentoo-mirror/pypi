<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># netbox-listsNetBox Lists generates list of IPs and prefixes from NetBox data.While this can be accomplished using the existing NetBox API, this pluginsaves the user from having to manipulate the data to get just the IPs/prefixes. Lists endpoints (mostly) share the same filters as the builtin NetBox endpoints, making querying easy.Lists are returned as JSON arrays or as plain text. This means that firewallscan use NetBox as a source for dynamic address lists, such as Palo Alto's External Dynamic Lists, Fortinet's External Block List (Threat Feed) orpfSesnse/OPNSense's firewall aliases.This plugin also features endpoints for devices/VMs/IP addresses compatible with Prometheus' http_sd.This plugin supports NetBox v3.0, v3.1, v3.2, v3.3, and v3.4.## Features* Supports NetBox's object permissions.* [Ansible](https://galaxy.ansible.com/devon_mar/nblists) and [Terraform](https://registry.terraform.io/providers/devon-mar/nblists/latest/docs) integrations.* Prometheus http_sd endpoint for devices/vms.* API documented using OpenAPI.* Supports standard NetBox object filters.* Address family specific prefix length filters.* JSON and plain text output formats.## Documentation* API documentation can be found in NetBox's builtin API docs (`/api/docs/`).* The format of the response can be controlled by the `Accept` header (`application/json` or `text/plain`)  or by the appending `format=(text|json)` to the URL.* This plugin uses NetBox's object permissions. Make sure users have the appropriate permissions.* Summarization is enabled by default.* When summarization is enabled, all IP addresses will be returned in CIDR format regardless of the `as_cidr` setting.## Installation1. Add `netbox-lists` to `local_requirements.txt`.2. Enable the plugin in `configuration.py`    ```python    PLUGINS = [&quot;netbox_lists&quot;]    ```3. Run `upgrade.sh`## Plugin Config```pythonPLUGINS_CONFIG = {    &quot;netbox_lists&quot;: {        # Return IPs as /32 or /128.        # Default: True        &quot;as_cidr&quot;: True,        # For services without any explicit IPs configured,        # use the primary IPs of the associated device/vm.        # Default: True        &quot;service_primary_ips&quot;: True,        # Summarize responses        &quot;summarize&quot;: True,        # A list of attributes for the devices-vms-attrs endpoint        #        # Attributes will be joined with &quot;__&quot; in the returned object.        # eg. (&quot;primary_ip&quot;, &quot;address&quot;) -&gt; primary_ip__address        &quot;devices_vms_attrs&quot;: [            (&quot;id&quot;,),            (&quot;name&quot;,),            # `role` will automatically be converted to `device_role` for devices.            # Don't use `device_role`.            (&quot;role&quot;, &quot;slug&quot;),            (&quot;platform&quot;, &quot;slug&quot;),            (&quot;primary_ip&quot;, &quot;address&quot;),            (&quot;tags&quot;,),        ],        # Tuple/list of attributes to use for Prometheus VM SD target. Defaults are shown.        #        # If all attributes return None, the device's name will be used.        &quot;prometheus_vm_sd_target&quot;: (            # For a custom field            # (&quot;cf&quot;, &quot;fqdn&quot;),            # If this returns none, try Name.            (&quot;primary_ip&quot;, &quot;address&quot;, &quot;ip&quot;),            (&quot;name&quot;,), # not necessary        ),        # Dictionary of label to VM attribute for Prometheus VM SD. Defaults are shown.        &quot;prometheus_vm_sd_labels&quot;: {            &quot;__meta_netbox_id&quot;: (&quot;id&quot;,),            &quot;__meta_netbox_name&quot;: (&quot;name&quot;,),            &quot;__meta_netbox_status&quot;: (&quot;status&quot;,),            &quot;__meta_netbox_cluster_name&quot;: (&quot;cluster&quot;, &quot;name&quot;),            &quot;__meta_netbox_site_name&quot;: (&quot;site&quot;, &quot;name&quot;),            &quot;__meta_netbox_role_name&quot;: (&quot;role&quot;, &quot;name&quot;),            &quot;__meta_netbox_platform_name&quot;: (&quot;platform&quot;, &quot;name&quot;),            &quot;__meta_netbox_primary_ip&quot;: (&quot;primary_ip&quot;, &quot;address&quot;, &quot;ip&quot;),            &quot;__meta_netbox_primary_ip4&quot;: (&quot;primary_ip4&quot;, &quot;address&quot;, &quot;ip&quot;),            &quot;__meta_netbox_primary_ip6&quot;: (&quot;primary_ip6&quot;, &quot;address&quot;, &quot;ip&quot;),            # A custom field. Will be an empty string if None.            # &quot;__meta_netbox_fqdn&quot;: (&quot;cf&quot;, &quot;fqdn&quot;),        },        # Tuple/list of attributes to use for Prometheus device SD target. Defaults are shown.        #        # If all attributes return None, the device's name will be used.        &quot;prometheus_device_sd_target&quot;: (            # For a custom field            # (&quot;cf&quot;, &quot;fqdn&quot;),            (&quot;primary_ip&quot;, &quot;address&quot;, &quot;ip&quot;),            (&quot;name&quot;,), # not necessary        ),        # Dictionary of label to device attribute for Prometheus device SD. Defaults are shown.        &quot;prometheus_device_sd_labels&quot;: {            &quot;__meta_netbox_id&quot;: (&quot;id&quot;,),            &quot;__meta_netbox_name&quot;: (&quot;name&quot;,),            &quot;__meta_netbox_status&quot;: (&quot;status&quot;,),            &quot;__meta_netbox_site_name&quot;: (&quot;site&quot;, &quot;name&quot;),            &quot;__meta_netbox_platform_name&quot;: (&quot;platform&quot;, &quot;name&quot;),            &quot;__meta_netbox_primary_ip&quot;: (&quot;primary_ip&quot;, &quot;address&quot;, &quot;ip&quot;),            &quot;__meta_netbox_primary_ip4&quot;: (&quot;primary_ip4&quot;, &quot;address&quot;, &quot;ip&quot;),            &quot;__meta_netbox_primary_ip6&quot;: (&quot;primary_ip6&quot;, &quot;address&quot;, &quot;ip&quot;),            &quot;__meta_netbox_serial&quot;: (&quot;serial&quot;,),            # A custom field. Will be an empty string if None.            # &quot;__meta_netbox_fqdn&quot;: (&quot;cf&quot;, &quot;fqdn&quot;),        },        # Tuple/list of attributes to use for Prometheus IP address SD target. Defaults are shown.        #        # If all attributes return None, the address in CIDR format will be used.        &quot;prometheus_ipaddress_sd_target&quot;: (            (&quot;address&quot;, &quot;ip&quot;),        ),        # Dictionary of label to IP address attribute for Prometheus ip address SD. Defaults are shown.        &quot;prometheus_ipaddress_sd_labels&quot;: {            &quot;__meta_netbox_id&quot;: (&quot;id&quot;,),            &quot;__meta_netbox_role&quot;: (&quot;role&quot;,),            &quot;__meta_netbox_dns_name&quot;: (&quot;dns_name&quot;,),            &quot;__meta_netbox_status&quot;: (&quot;status&quot;,),            # For addresses assigned to interfaces            #&quot;__meta_netbox_device&quot;: (&quot;assigned_object&quot;, &quot;device&quot;, &quot;name&quot;),            #&quot;__meta_netbox_interface&quot;: (&quot;assigned_object&quot;, &quot;name&quot;),        },    }}```##  Examples1. Get all IP addresses for devices with the tag `test`.```https://netbox.example.com/api/plugins/lists/devices/?tag=test```2. Get all IP addresses for devices with the tag `test` in plain text.```https://netbox.example.com/api/plugins/lists/devices/?tag=test&amp;format=text```3. Get all IP addresses assigned to services named `NTP`.```https://netbox.example.com/api/plugins/lists/services/?name=NTP```4. Get all IP addresses assigned to services named `NTP` and use the assigned device's primary IPs when no IPsare explicitly configured on the service.```https://netbox.example.com/api/plugins/lists/services/?name=NTP&amp;primary_ips=true```5. Get all IPv6 addresses for devices with the tag `test` in plain text.```https://netbox.example.com/api/plugins/lists/devices/?tag=test&amp;family=6```6. Get all prefixes and IPs with the tag `internal````https://netbox.example.com/api/plugins/lists/tags/internal/?ips&amp;prefixes```7. Get all prefixes and IPs with the tag `internal` without summarization```https://netbox.example.com/api/plugins/lists/tags/internal/?ips&amp;prefixes&amp;summarize=false```### Ansible Usage ExampleUsing the [nblists collection](https://galaxy.ansible.com/devon_mar/nblists):```yaml# Build an ACL using all NetBox prefixes with the role 'data'- name: Build ACL 10  ansible.builtin.set_fact:    acl_10_aces: &quot;{{ acl_10_aces | default([]) + ace }}&quot;  vars:    ace:      - grant: permit        source:          address: &quot;{{ item | ansible.utils.ipaddr('network') }}&quot;          wildcard_bits: &quot;{{ item | ansible.utils.ipaddr('wildcard') }}&quot;  loop: &quot;{{ q('devon_mar.nblists.list', 'prefixes', role='data') }}&quot;- name: Ensure ACLs are configured  cisco.ios.ios_acls:    config:      - afi: ipv4        acls:          - name: 10            aces: &quot;{{ acl_10_aces }}&quot;```### Terraform Usage ExampleUsing the [nblists provider](https://registry.terraform.io/providers/devon-mar/nblists/latest/docs):```terraformdata &quot;nblists_list&quot; &quot;special&quot; {    endpoint = &quot;ip-addresses&quot;    filter = {        tag = [&quot;special&quot;]    }}```### Oxidized usage```yamlsource:  default: http  http:    # Devices/VMs with the &quot;oxidized&quot; tag    url: https://netbox.example.com/api/plugins/lists/devices-vms-attrs/?tag=oxidized    scheme: https    secure: true    map:      name: primary_ip__address      model: platform__slug    headers:      Authorization: Token &lt;netbox token&gt;```### Prometheus usage```yamlhttp_sd_configs:    # VMs with the role slug &quot;linux&quot;  - url: https://netbox.example.com/api/plugins/lists/prometheus-vms/?role=linux    refresh_interval: 60s    authorization:      type: Token      credentials: mynetboxtoken```</longdescription>
</pkgmetadata>