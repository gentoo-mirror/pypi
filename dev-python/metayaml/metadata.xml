<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>=========Meta Yaml=========Mata Yaml is several enhancements for yaml format that allow the following:* include one yaml file from another* use python expression and other fields in the file as valueInclude files syntax--------------------To include one file or files the '**extend**' key is used. For example:**base.yaml**:: extend:   - file1.yaml   - file2.yaml name: base.yaml b: overridden_by_base new: new**file1.yaml**::  a: a  b: b  c: c  name: file1.yaml**file2.yaml**::  a: aa  b: bb  d: d  name: file2.yamlThe order and sequence of file processing is shown in the following table:=====  =============================================  ====================================================== Step   Action                                         Intermediate dict=====  =============================================  ======================================================1      Read base.yaml and extract extend key          ::                                                       {&quot;extend&quot;:                                                           [&quot;file1.yaml&quot;, &quot;file2.yaml&quot;] }2      Read file1.yaml                                ::                                                       {                                                          &quot;a&quot;: &quot;a&quot;,                                                          &quot;b&quot;: &quot;b&quot;,                                                          &quot;c&quot;: &quot;c&quot;,                                                          &quot;name&quot;: &quot;file1.yaml&quot;                                                       }3      Read file2.yaml and merge/override values      ::                                                       {                                                          &quot;a&quot;: &quot;aa&quot;, # overridden                                                          &quot;b&quot;: &quot;b&quot;,  # overridden                                                          &quot;c&quot;: &quot;c&quot;,                                                          &quot;d&quot;: &quot;d&quot;,  # added                                                          &quot;name&quot;: &quot;file2.yaml&quot; # overridden                                                       }4      Read rest values from base.yaml and            ::       merge/override                                                       {                                                          &quot;a&quot;: &quot;aa&quot;,                                                          &quot;b&quot;: &quot;overridden_by_base&quot;,  # overridden                                                          &quot;c&quot;: &quot;c&quot;,                                                          &quot;d&quot;: &quot;d&quot;,                                                          &quot;name&quot;: &quot;base.yaml&quot; # overridden                                                          &quot;new&quot;: &quot;new&quot; # added                                                       }=====  =============================================  ======================================================Expression syntax-----------------Metayaml supports any python valid expression. For this expression should be enclosed in brackets ${} or $().The first brackets is used for eager substitute and $() for laze. I.e. expressions in $() are applied afterfull read file and its include files but ${} during file read.The access to other values from expression can be done by using dictionary syntax or 'dash dictionary syntax'.**Examples**:**base.yaml** :: extend:   - f1.yaml hour: ${60*60}  # just simple python expression ${2+2}: four  # expression can be in the key delay: ${hour*2}  # delay is two hour or 7200 seconds loggers:   metayaml:     name: metayaml     level: debug     console: false   backend:     name: backend     level: ${loggers.metayaml.level}     console: ${loggers.metayaml.console}   ext: ${loggers.metayaml}  # copy whole dict from loggers.metayaml this key   incorrect: ${delay} ${loggers.ext}  # In this case string representation of objects will be concatenated**f1.yaml** ::  run_interval: $(hour*5)  # 5 hours. But 'hour' is not defined when this file is processed.                           # Therefore only $() brackets can be used here.Installation============Meta Yaml is in PyPI, so it can be installed directly using::    $ pip install metayamlOr from BitBucket::    $ git clone https://bitbucket.org/atagunov/metayaml    $ cd metayaml    $ python setup.py installDocumentation=============Documentation (such that it is) is available athttps://bitbucket.org/atagunov/metayamlUsage=====:: from metayaml import read read([&quot;config.yaml&quot;,       &quot;test.yaml&quot;],      {'join': os.path.join, # allows get right os specific path in yaml file       'env': os.environ}  # allows use system environments from yaml file     )**config.yaml** :: extend:   - ${join(env[&quot;HOME&quot;], &quot;.metayaml&quot;, &quot;localconfig.yaml&quot;)} # added reading local config from $HOME user_name: ${env[&quot;USER&quot;]} email: ${user_name + &quot;@example.com&quot;} debug: false**test.yaml** :: debug: trueOrder of substitution=====================The substitutions are done in order of the values in the file. I.e. the following example will be failed::  B: ${A+1}     &lt;--- A is not defined here  AA: ${B}  A: 1But the following The result is ok::  A: 1  B: ${A+1}  AA: ${B}Change merge behavior=====================By default it is possible to add new keys in the dict and replace the list. In some cases it is necessary to removekeys from base file or add some values to list. For example**base.yaml**::  main:      iso_3166:        China: CN        Honduras: HN        Madagascar: MG      country_codes:        - CN        - HN        - MG      country_codes_3:        - CHN        - HND        - MDG**last.yaml**::    extend:      - base.yaml    main:      iso_3166:         China: ${__del__}  #  key 'China' will be removed from the result         Liberia: LR  # add new key      country_codes:         - LR         # after merge country_codes contains only one element.      country_codes_3:        ${__extend__}:          - LBR       # the result list is [&quot;CHN&quot;, &quot;HND&quot;, &quot;MDG&quot;, &quot;LBR&quot;]The result of the code::    d = read(&quot;last.yaml&quot;)    print d    {        &quot;main&quot;: {            &quot;iso_3166&quot;: {                &quot;Honduras&quot;: &quot;HN&quot;,                &quot;Madagascar&quot;: &quot;MG&quot;,                &quot;Liberia&quot;: &quot;LR&quot;            },            &quot;country_codes&quot;: [                &quot;LR&quot;            ],            &quot;country_codes_3&quot;: [                &quot;CHN&quot;,                &quot;HND&quot;,                &quot;MDG&quot;,                &quot;LBR&quot;            ]        }    }Copy method===========There is method 'cp' which copy dict/list with extending::    cron:      daily:        min: 0        hour: 0      monthly:        min: 0        hour: 0        day: 1    schedule:      nighttask: ${cp(cron.daily, min=5)}  # min will be replaced to 5      #  min: 5      #  hour: 0      daytask: ${cp(cron.daily, min=7, hour=13)} # min and hour are replaced      #  min: 7      #  hour: 13      monthtask: ${cp(cron.monthly, day=2)}      #  min: 0      #  hour: 0      #  day: 2    deploy:      subnets:        - 1.1.1.1        - 2.2.2.2      base_elb:        - 4.4.4.4        - 5.5.5.5      elb: ${cp(deploy.subnets, &quot;3.3.3.3&quot;, *deploy.base_elb)}      # - 1.1.1.1      # - 2.2.2.2      # - 3.3.3.3      # - 4.4.4.4      # - 5.5.5.5Inherit method==============There are another way to copy existed dict and update some fields::    foo:      bar:        baz: 1        buz: 2        foobar: 3      foobar: [4, 5]    bar:      ${__inherit__}: foo.bar  # bar will be replaces by content of for.bar      buz: 33    # the result value of 'bar' will be    #    baz: 1    #    buz: 33    #    foobar: 3License=======MetaYaml is released under a MIT license.</longdescription>
</pkgmetadata>