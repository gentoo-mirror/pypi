<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># SharePy - Simple SharePoint Online authentication for PythonThis module will handle authentication for your SharePoint Online/O365 site, allowing you to make straightforward HTTP requests from Python. It extends the commonly used *Requests* module, meaning that returned objects are familliar, easy to work with and well documented. ## InstallationSharePy can be installed from the Python Package Index, PyPI.```pip install sharepy```## Initiating a SharePoint session```pythonimport sharepys = sharepy.connect(&quot;example.sharepoint.com&quot;)```You will be prompted to enter your username and password, which are used to request a security token from Microsoft. An access cookie and request digest token are then retrieved and saved to properties for later use. The digest token will be refreshed automatically as it expires.A username and password can also be provided as arguments of the `connect` function, if prompts are not desirable.## Making API calls```pythonr = s.get(&quot;https://example.sharepoint.com/_api/web/lists/GetByTitle('Test Library')&quot;)```This will return a *Requests* `response` object. See the [requests documentation](http://docs.python-requests.org/en/master/) for details. By default, the headers `Accept: application/json; odata=verbose` and `Content-type: application/json; odata=verbose` are sent with all requests, so API responses will be formatted as JSON where available.Headers can be added or overridden by supplying a dictionary to the relevant method:```pythonr = s.get(&quot;https://example.sharepoint.com/_api/...&quot;, headers={&quot;Accept&quot;: &quot;application/atom+xml&quot;})```The request will send a digest header, allowing modifications to be made to SharePoint objects.### Downloading a file```pythonr = s.getfile(&quot;https://example.sharepoint.com/Library/Test%20File.pdf&quot;)```This will download the file to the current directory and return a `response` object. Alternatively you can specify a location to save the file to:```pythonr = s.getfile(&quot;https://example.sharepoint.com/Library/Test%20File.pdf&quot;, filename=&quot;downloads/file.pdf&quot;)```## Saving an authenticated sessionProperties of the authentication session can be saved to a file using the `save` method, so the session can be used without having to re-authenticate each time a program is run:```pythons.save()```Later, the `load` function can be used to restore the session:```pythons = sharepy.load()```The default file name for saving and loading sessions is `sp-session.pkl`, however an alternative location can be provided as an argument to `save()` and `load()`.## Advanced usage### Requests authenticationSharePy implements Requests authentication classes that can also be used directly with Requests itself:```pythonimport requestsimport sharepyauth = sharepy.auth.SharePointOnline(username=&quot;user@example.com&quot;)auth.login(site=&quot;example.sharepoint.com&quot;)r = requests.get(&quot;https://example.sharepoint.com&quot;, auth=auth)```Available authentication classes are:- `SharepointOnline` - For normal SharePoint Online sites- `SharepointADFS` - For ADFS-enabled sites### Custom authentication URLThe authentication URL is detected automatically when using `sharepy.connect()`. If a different URL is required for a region-specific account, it can be specified by manually creating an auth object and setting its `login_url` property:```pythonimport sharepyauth = sharepy.auth.SharePointOnline(username=&quot;user@example.com&quot;)auth.login_url = &quot;https://login.microsoftonline.de/extSES.srf&quot;s = sharepy.SharePointSession(&quot;example.sharepoint.com&quot;, auth)```## Useful reading- Constructing SharePoint API calls: [SharePoint REST API documentation](https://msdn.microsoft.com/en-us/library/office/dn292552.aspx)- Handling JSON objects in Python: [Python JSON module documentation](https://docs.python.org/3.4/library/json.html)## LicenceThis software is distributed under the GNU General Public License v3. Copyright 2016-2021 Jonathan Holvey.## Credits1. The authentication method used here is based on [this post](https://allthatjs.com/2012/03/28/remote-authentication-in-sharepoint-online/) by Luc Stakenborg.2. Additional help regarding request digests from sadegh's comment on [this post](http://paulryan.com.au/2014/spo-remote-authentication-rest/) by Paul Ryan.3. Contributed code from @joemeneses for ADFS authentication.</longdescription>
</pkgmetadata>