<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># HTML Pretty formatter for Behave- Inspired by [jest-html-reporter](https://github.com/Hargne/jest-html-reporter)- Using project [dominate](https://github.com/Knio/dominate) to generate the page## Installation```shellpython3 -m pip install behave-html-pretty-formatter```[![PyPI version](https://img.shields.io/pypi/v/behave-html-pretty-formatter.svg?style=flat)](https://pypi.org/project/behave-html-pretty-formatter/)[![PyPI downloads](https://img.shields.io/pypi/dm/behave-html-pretty-formatter.svg?style=flat)](https://pypi.org/project/behave-html-pretty-formatter/)## UsageTo use it with Behave create a `behave.ini` file in your project folder(or in home) with the following content:```ini# -- FILE: behave.ini# Define ALIAS for PrettyHTMLFormatter.[behave.formatters]html-pretty = behave_html_pretty_formatter:PrettyHTMLFormatter# Optional configuration of PrettyHTMLFormatter# also possible to use &quot;behave ... -D behave.formatter.html-pretty.{setting}={value}&quot;.[behave.userdata]behave.formatter.html-pretty.title_string = Test Suite Reporter# Example usecase, print {before/after}_scenarios as steps with attached data.behave.formatter.html-pretty.pseudo_steps = false# Structure of the result html page readable(pretty) or condensed.behave.formatter.html-pretty.pretty_output = true# The '%' must be escaped in ini format.behave.formatter.html-pretty.date_format = %%d-%%m-%%Y %%H:%%M:%%S# Defines if the summary is expanded upon start.behave.formatter.html-pretty.show_summary = false# Defines if the user is interested in what steps are not executed.behave.formatter.html-pretty.show_unexecuted_steps = true# Define what to collapse by default, possible values:#  &quot;auto&quot; - show everything except embeds (default)#  &quot;all&quot; - hide everything#  comma separated list - specify subset of &quot;scenario,embed,table,text&quot;#  &quot;none&quot; - show everything, even embedsbehave.formatter.html-pretty.collapse = auto# Defines if the user is interested in what steps are not executed.behave.formatter.html-pretty.show_unexecuted_steps = true# Following will be formatted in summary section as &quot;tester: worker1&quot;.behave.additional-info.tester=worker1# Can be used multiple times.behave.additional-info.location=lab2```Alternatively, with behave &gt;= v1.2.7.dev3, you can put the same configuration in`pyproject.toml`, like so:```toml[tool.behave.formatters]html-pretty = &quot;behave_html_pretty_formatter:PrettyHTMLFormatter&quot;# Optional configuration of PrettyHTMLFormatter[tool.behave.userdata]&quot;behave.formatter.html-pretty.title_string&quot; = &quot;Test Suite Reporter&quot;&quot;behave.formatter.html-pretty.pseudo_steps&quot; = false&quot;behave.formatter.html-pretty.pretty_output&quot; = true&quot;behave.formatter.html-pretty.date_format&quot; = &quot;%%d-%%m-%%Y %%H:%%M:%%S&quot;&quot;behave.formatter.html-pretty.show_summary&quot; = false&quot;behave.formatter.html-pretty.collapse&quot; = &quot;auto&quot;&quot;behave.formatter.html-pretty.show_unexecuted_steps&quot; = true```Then use the formatter by running Behave with the `-f`/`--format` option, e.g.```consolebehave -f helpbehave -f html-prettybehave -f html-pretty -o behave-report.html```You can find information about behave and user-defined formatters in the[behave docs](https://behave.readthedocs.io/en/latest/formatters/).## HTML Pretty has High contrast option- [Default Static Example](#pretty-html-formatter):- [High contrast Static Example](#pretty-html-formatter-high-contrast):  - Colours adjusted.  - Extra information is added before every decorator about the status of the step.  - Text is bigger.You can switch between the different contrasts with the toggle button.## Dark modeStylesheet follows the browser dark theme, so it reverts background to dark andadjusts colors to darker shade.## Summary is hidden by default- [Pretty HTML Formatter With Summary Expanded and Collapsed Steps](#pretty-html-formatter-with-summary-expanded-and-collapsed-steps):- [Pretty HTML Formatter High contrast With Summary Expanded and Collapsed Steps](#pretty-html-formatter-high-contrast-with-summary-expanded-and-collapsed-steps):To change the setting use the .ini file.```summarybehave.formatter.html-pretty.show_summary = true```## HACKING### MIME TypesTake a look at the  [Common MIME types](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types), few of them are useful for us.### Encoding to base64```pythondata_base64 = base64.b64encode(open(&quot;/path/to/image&quot;, &quot;rb&quot;).read())data_encoded = data_base64.decode(&quot;utf-8&quot;).replace(&quot;\n&quot;, &quot;&quot;)```### Format in which the data is inserted to the html```python# Format&quot;data:&lt;mime_type&gt;;&lt;encoding&gt;,&lt;data_encoded&gt;&quot;# Examplef&quot;data:image/png;base64,{data_encoded}&quot;```## Defined functions you can use### Basic setup for using formatter functions```pythonfor formatter in context._runner.formatters:    if formatter.name == &quot;html-pretty&quot;:        context.formatter = formatter```### Set Icon```pythonicon_data = f&quot;data:image/svg+xml;base64,{data_encoded}&quot;context.formatter.set_icon(icon=icon_data)```Example use case - an indicator if the test is running under X11 or Wayland:![Examples](design/set_icon_examples.png)### Set Title for the HTML page```pythoncontext.formatter.set_title(title=&quot;Test Suite Reporter&quot;)``` - This is configurable also from the behave.ini file `behave.formatter.html-pretty.title_string = Test Suite Reporter`### Commentary step in HTML reportUsed as an information panel to describe or provide infomation about the page contents.You will need to define your own step where you will set flag for commentary step.```python@step('Commentary')def commentary_step(context):    # Get the correct step to override.    scenario = context.formatter.current_scenario    step = scenario.current_step    # Override the step, this will prevent the decorator to be generated and only the text will show.    step.commentary_override = True```Feature file example usage:```gherkin  @commentary  Scenario: Example of commentary usage.    * Start application &quot;zenity&quot; via command &quot;zenity --about&quot;    * Commentary      &quot;&quot;&quot;      This field is generated from decorator 'Commentary'      Where you insert text and override step to not print its decorator.      The text will get printed and will be seen, as you can see, haha.      &quot;&quot;&quot;    * Left click &quot;About&quot; &quot;radio button&quot;```Result can be seen in the image examples.## Embedding data to the report### Basic embedding setup - save embedding function to context```pythonfor formatter in context._runner.formatters:    if formatter.name == &quot;html-pretty&quot;:        context.embed = formatter.embed# Not required if you already have the Basic setup.# You would than use: 'context.formatter.embed' instead of 'context.embed'```### Embed image```pythoncontext.embed(mime_type=&quot;image/png&quot;, data=&quot;/path/to/image.png&quot;, caption=&quot;Screenshot&quot;)```### Embed video```pythoncontext.embed(mime_type=&quot;video/webm&quot;, data=&quot;/path/to/video.webm&quot;, caption=&quot;Video&quot;)```### Image and Video examples:![Pretty HTML Formatter](design/image_and_video_examples.gif)### Defined MIME types and corresponding accepted dataThese are examples we use on daily basis, we can define more if required.```pythonmime_type=&quot;video/webm&quot;, data=&quot;/path/to/video.webm&quot; or data=&quot;&lt;base64_encoded_video&gt;&quot;mime_type=&quot;image/png&quot;, data=&quot;/path/to/image.png&quot; or data=&quot;&lt;base64_encoded_image&gt;&quot;mime_type=&quot;text/plain&quot;, data=&quot;&lt;string&gt;&quot;mime_type=&quot;text/html&quot;, data=&quot;&lt;string&gt;&quot;  # data string is pasted as raw HTML (not escaped)mime_type=&quot;text/markdown&quot;, data=&quot;&lt;string&gt;&quot;  # data string is converted using markdown pip modulemime_type=&quot;link&quot;, data=&quot;list(&lt;link&gt;, &lt;label&gt;)&quot;```You can simply set `data=data_encoded` generated as described in [Encoding to base64](#encoding-to-base64) section and the formatter will generate the proper [Format](#format-in-which-the-data-is-inserted-to-the-html) based on MIME type or you can just use the `data=&quot;/path/to/file&quot;` and formatter will attempt to convert it.Function `embed()` returns object, which can be saved and modified later via `set_data()` and `set_fail_only()` methods. This is if you want to embed some data which are still being processes (output of a backgroud process started in a step, etc.).### Pseudo stepsIf the testsuite uses `before_scenario()` and `after_scenario()` and you would like to see them as steps in HTML report (for example to have embeds separated from the standard steps), configuration switch in behave.ini file `behave.formatter.html-pretty.pseudo_steps = true` will do the trick, together with calling `context.html_formatter.before_scenario_finish(status)` at the end of `before_scenario()` (analogously for `after_scenario()`). The status is one of `&quot;passed&quot;, &quot;failed&quot;, &quot;skipped&quot;`. Function will set color class of the pseudo step and also record pseudo step duration.```python# Example use in features.environment.pydef before_scenario(context, scenario):  ...  # This requires to have html_formatter set by code above.  if error_found:    context.embed(&quot;text&quot;, str(error_found), &quot;Error Message&quot;)    context.html_formatter.before_scenario_finish(&quot;failed&quot;)    raise error_found  else:    context.html_formatter.before_scenario_finish(&quot;passed&quot;)def after_scenario(context, scenario):  ...  if error_found:    context.embed(&quot;text&quot;, str(error_found), &quot;Error Message&quot;)    context.html_formatter.after_scenario_finish(&quot;failed&quot;)    raise error_found  else:    context.html_formatter.after_scenario_finish(&quot;passed&quot;)```## ContributingYou want to help with improving this software? Please create an issue in our open bug tracker, or open a pull request directly.We use [tox](https://pypi.org/project/tox/) for running linting and tests, e.g.```consoletoxtox -ltox -e flake8```For code formatting we use [black](https://pypi.org/project/black/), which you can run using our Tox setup, e.g.```consoletox -e black```If you need to change CSS or JavaScript code: First edit the regular files, then generate the minified versions like so:```consoletox -e minify```## Image Examples### Pretty HTML Formatter![Pretty HTML Formatter](design/full_page_example.png)### Pretty HTML Formatter High Contrast![Pretty HTML Formatter Summary High Contrast](design/full_page_high_contrast_example.png)### Pretty HTML Formatter With Summary Expanded and Collapsed Steps![Pretty HTML Formatter](design/summary_collapsed_example.png)### Pretty HTML Formatter High Contrast with Summary Expanded and Collapsed Steps![Pretty HTML Formatter Summary High Contrast](design/summary_collapsed_high_contrast_example.png)</longdescription>
</pkgmetadata>