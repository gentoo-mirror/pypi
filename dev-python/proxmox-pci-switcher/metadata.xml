<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>![logo](assets/logo.png)# Proxmox PCI Switcher &lt;!-- omit in toc --&gt;![GitHub all releases](https://img.shields.io/github/downloads/rosineygp/proxmox-pci-switcher/total?label=snippet)![PyPI - Downloads](https://img.shields.io/pypi/dm/proxmox-pci-switcher?label=pypi)[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=rosineygp_proxmox-pci-switcher&amp;metric=alert_status)](https://sonarcloud.io/dashboard?id=rosineygp_proxmox-pci-switcher)Switch among Guest VMs organized by `Resource Pool`.main features:- `ONE` GPU card, `N` OS (at once)- Guest VM command client- Handler power off- Reset framebuffer**TOC**- [Proxmox Configuration](#proxmox-configuration)  - [Create Resource Pool](#create-resource-pool)  - [Assign Guest VM](#assign-guest-vm)- [Install Proxmox Snippet](#install-proxmox-snippet)  - [Proxmox Config](#proxmox-config)    - [Snippet Variables](#snippet-variables)    - [Assign VM to Snippet](#assign-vm-to-snippet)- [Guest Client Switcher](#guest-client-switcher)  - [List Resources](#list-resources)  - [Switch Resource](#switch-resource)  - [Using GUI](#using-gui)## Proxmox Configuration### Create Resource Pool![Resource Pool](assets/create_resource_pool.png)### Assign Guest VM![Assign Guest VM](assets/assign_guest_vm.png)## Install Proxmox Snippet```bashcurl -fsSL https://github.com/rosineygp/proxmox-pci-switcher/releases/latest/download/pci-group-switcher.sh &gt; pci-group-switcher.sh# set execution permissionchmod +x pci-group-switcher.sh# move for your snippets &lt;storage&gt;/&lt;folder&gt;```### Proxmox Config#### Snippet Variables| NAME                   | Default           | Description                                                        || ---------------------- | ----------------- | ------------------------------------------------------------------ || _POOL_NAME *           | \&lt;auto_discovery&gt; | The name of `Resource Pool`                                        || _SHUTDOWN_TIMEOUT      | 300               | Checking if resource was released (Current VM Running is down)     || _RESET_GPU_FRAMEBUFFER | true              | Reset GPU framebuffer                                              || _PIN_CPU_IDS           | false             | Pin CPU using `taskset` (syntax equals taskset cpu-list parameter) || _RENICE_PRIORITY       | false             | Renice process using `renice`                                      |&gt; All variables must be changed in `pci-group-switcher.sh` at proxmox ve.&gt;&gt; `_POOL_NAME` * By default it will scan for VMID in all Resource Pools, in case of long delays replace function call to Resource Pool name (eg. desktop, gpu, ...).The following variables can be passed using `/etc/pve/qemu-server/&lt;vmid&gt;.vars` file, the script will load variables from file if it exists.&gt; If you need to overwrite an Default value set at `/etc/environment` the variable name without the `_` prefix. (eg. RESET_GPU_FRAMEBUFFER=false)#### Assign VM to Snippet```bashqm set &lt;vmid&gt; -hookscript &lt;storage&gt;:snippets/pci-group-switcher.sh```&gt; After proxmox configuration is possible to switch using proxmox api or web interface.## Guest Client Switcher- requirements: python 3```bashpip install proxmox-pci-switcher# create config foldermkdir -p ~/.config/proxmox-pci-switcher/# create config filecat &lt;&lt;EOF &gt; ~/.config/proxmox-pci-switcher/config.yamlproxmox:  host: '&lt;ip or dns&gt;'  user: '&lt;user&gt;@&lt;method&gt;'  password: '&lt;password&gt;'  api_id: '&lt;name&gt;'          # only for api access  api_token: '&lt;token&gt;'      # only for api access  verify_ssl: falsegui:                        # optional  theme: Dark               # Light or Darkpools:  - '&lt;desktop&gt;'  - '&lt;gpu-nvidia&gt;'  - '&lt;gpu-amd&gt;'EOF```&gt; Edit `config.yaml` with your proxmox credentials and pools.&gt; API access has priority over user and password access.### List Resources```bashproxmox-pci-switcher listpool(s)       vmid  name             status    type----------  ------  ---------------  --------  ------desktop        119  catalina         stopped   qemudesktop        116  win10-desktop    stopped   qemudesktop        117  mini-desktop     stopped   qemudesktop        103  u20-desktop      running   qemudesktop        115  u20-srv-desktop  stopped   qemu```### Switch Resource```bash# run command directlyproxmox-pci-switcher switch win10-desktop# create a alias for better experiencealias windows=&quot;proxmox-pci-switcher switch win10-desktop&quot;# and just runwindows```### Using GUI```bashproxmox-pci-switcher gui```![GUI](assets/gui.png)</longdescription>
</pkgmetadata>