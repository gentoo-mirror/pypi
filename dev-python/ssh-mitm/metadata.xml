<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>&lt;div id=&quot;top&quot; align=&quot;center&quot;&gt;&lt;img src=&quot;https://github.com/ssh-mitm/ssh-mitm/raw/master/doc/images/ssh-mitm-logo.png&quot; width=&quot;200&quot;&gt;&lt;br/&gt;&lt;/div&gt;&lt;h1 align=&quot;center&quot;&gt; SSH-MITM - ssh audits made simple &lt;/h1&gt;&lt;p align=&quot;center&quot;&gt;  &lt;a href=&quot;https://docs.ssh-mitm.at&quot;&gt;    &lt;img alt=&quot;SSH-MITM intercepting password login&quot; title=&quot;SSH-MITM&quot; src=&quot;https://docs.ssh-mitm.at/_images/ssh-mitm-password.png#20230214&quot; &gt;  &lt;/a&gt;  &lt;p align=&quot;center&quot;&gt;ssh man-in-the-middle (ssh-mitm) server for security audits supporting&lt;br&gt; &lt;b&gt;publickey authentication&lt;/b&gt;, &lt;b&gt;session hijacking&lt;/b&gt; and &lt;b&gt;file manipulation&lt;/b&gt;&lt;/p&gt;  &lt;p align=&quot;center&quot;&gt;   &lt;a href=&quot;https://snapcraft.io/ssh-mitm&quot;&gt;     &lt;img alt=&quot;Get it from the Snap Store&quot; src=&quot;https://snapcraft.io/static/images/badges/en/snap-store-black.svg&quot; /&gt;   &lt;/a&gt;   &lt;br /&gt;   &lt;br /&gt;   &lt;a href=&quot;https://docs.ssh-mitm.at&quot;&gt;&lt;img src=&quot;https://read-the-docs-guidelines.readthedocs-hosted.com/_downloads/d9606423d87d78fcceae4ee2af883b12/logo-wordmark-dark.png&quot; title=&quot;read the docs&quot; width=&quot;256&quot;&gt;&lt;/a&gt;  &lt;/p&gt;&lt;/p&gt;&lt;h3 align=&quot;center&quot;&gt;Contributors&lt;/h3&gt;&lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;https://github.com/ssh-mitm/ssh-mitm/graphs/contributors&quot;&gt;  &lt;img src=&quot;https://contrib.rocks/image?repo=ssh-mitm/ssh-mitm&quot; /&gt;&lt;/a&gt;&lt;/p&gt;## Table of Contents- [Introduction](#introduction)- [Features](#features)- [Installation](#installation)- [Quickstart](#quickstart)- [Session hijacking](#session-hijacking)- [Phishing FIDO Tokens](#phishing-fido-tokens)- [Contributing](#contributing)- [Contact](#contact)## Introduction[![Downloads](https://pepy.tech/badge/ssh-mitm)](https://pepy.tech/project/ssh-mitm)[![CodeFactor](https://www.codefactor.io/repository/github/ssh-mitm/ssh-mitm/badge)](https://www.codefactor.io/repository/github/ssh-mitm/ssh-mitm)[![Documentation Status](https://readthedocs.org/projects/ssh-mitm/badge/?version=latest)](https://docs.ssh-mitm.at/?badge=latest)[![GitHub](https://img.shields.io/github/license/ssh-mitm/ssh-mitm?color=%23434ee6)](https://github.com/ssh-mitm/ssh-mitm/blob/master/LICENSE)[![PRs Welcome](https://img.shields.io/badge/PRs-welcome-brightgreen.svg?style=flat-square)](http://makeapullrequest.com)&lt;a rel=&quot;me&quot; href=&quot;https://defcon.social/@sshmitm&quot;&gt;&lt;img src=&quot;https://img.shields.io/mastodon/follow/109597663767801251?color=%236364FF&amp;domain=https%3A%2F%2Fdefcon.social&amp;label=Mastodon&amp;style=plastic&quot;&gt;&lt;/a&gt;**SSH-MITM** is a man in the middle SSH Server for security audits and malware analysis.Password and **publickey authentication** are supported and SSH-MITM is able to detect, if a user is able to login with publickey authentication on the remote server. This allows SSH-MITM to accept the same key as the destination server. If publickey authentication is not possible, the authentication will fall back to password-authentication.When publickey authentication is possible, a forwarded agent is needed to login to the remote server. In cases, when no agent was forwarded, SSH-MITM can rediredt the session to a honeypot.&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;## Features* publickey authentication   * accept same key as destination server   * Phishing FIDO Tokens ([Information from OpenSSH](https://www.openssh.com/agent-restrict.html))* hijacking and logging of terminal sessions* store and replace files during SCP/SFTP file transferes* port porwarding  * SOCKS 4/5 support for dynamic port forwarding* intercept MOSH connections* audit clients against known vulnerabilities* plugin support&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;## Installation**SSH-MITM** can be installed as a [Ubuntu Snap](https://snapcraft.io/ssh-mitm), [PIP-Package](https://pypi.org/project/ssh-mitm/), [AppImage](https://github.com/ssh-mitm/ssh-mitm/releases/latest), [Nix](https://search.nixos.org/packages?channel=unstable&amp;show=ssh-mitm&amp;type=packages&amp;query=ssh-mitm) and even runs on **[Android devices](https://github.com/ssh-mitm/ssh-mitm/discussions/83#discussioncomment-1531873)**    # install ssh-mitm as snap package    $ sudo snap install ssh-mitm    # install ssh-mitm as python pip package    $ python3 -m pip install ssh-mitm    # install as Nix package    $ nix-env -iA nixos.ssh-mitm&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;## QuickstartTo start SSH-MITM, all you have to do is run this command in your terminal of choice.    $ ssh-mitm server --remote-host 192.168.0.xNow let's try to connect. SSH-MITM is listening on port 10022.    $ ssh -p 10022 testuser@proxyserverYou will see the credentials in the log output.    INFO     Remote authentication succeeded        Remote Address: 127.0.0.1:22        Username: testuser        Password: secret        Agent: no agent&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;## Session hijackingGetting the plain text credentials is only half the fun.When a client connects, the ssh-mitm starts a new server, which is used for session hijacking.    INFO     â„¹ created mirrorshell on port 34463. connect with: ssh -p 34463 127.0.0.1To hijack the session, you can use your favorite ssh client.    $ ssh -p 34463 127.0.0.1Try to execute somme commands in the hijacked session or in the original session.The output will be shown in both sessions.&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;## Phishing FIDO TokensSSH-MITM is able to phish FIDO2 Tokens which can be used for 2 factor authentication.The attack is called [trivial authentication](https://docs.ssh-mitm.at/trivialauth.html) ([CVE-2021-36367](https://docs.ssh-mitm.at/CVE-2021-36367.html), [CVE-2021-36368](https://docs.ssh-mitm.at/CVE-2021-36368.html)) and can be enabled with the command line argument `--enable-trivial-auth`.  ssh-mitm server --enable-trivial-authUsing the trivial authentication attack does not break password authentication, because the attack is only performed when a publickey login is possible.&lt;p align=&quot;center&quot;&gt;  &lt;b&gt;Video explaining the phishing attack:&lt;/b&gt;&lt;br/&gt;  &lt;i&gt;Click to view video on vimeo.com&lt;/i&gt;&lt;br/&gt;  &lt;a href=&quot;https://vimeo.com/showcase/9059922/video/651517195&quot;&gt;  &lt;img src=&quot;https://github.com/ssh-mitm/ssh-mitm/raw/master/doc/images/ds2021-video.png&quot; alt=&quot;Click to view video on vimeo.com&quot;&gt;  &lt;/a&gt;&lt;/p&gt;&lt;p align=&quot;center&quot;&gt;  &lt;b&gt;&lt;a href=&quot;https://github.com/ssh-mitm/ssh-mitm/files/7568291/deepsec.pdf&quot;&gt;Downlaod presentation slides&lt;/a&gt;&lt;/b&gt;&lt;/p&gt;&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;## ContributingContributions are what make the open source community such an amazing place to learn, inspire, and create. Any contributions you make are **greatly appreciated**.If you have a suggestion that would make this better, please fork the repo and create a pull request. You can also simply open an issue with the tag &quot;enhancement&quot;.Don't forget to give the project a star! Thanks again!1. Fork the Project2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)4. Push to the Branch (`git push origin feature/AmazingFeature`)5. Open a Pull RequestSee also the list of [contributors](https://github.com/ssh-mitm/ssh-mitm/graphs/contributors) who participated in this project.&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;## Contact- E-Mail: support@ssh-mitm.at- [Issue Tracker](https://github.com/ssh-mitm/ssh-mitm/issues)&lt;p align=&quot;right&quot;&gt;(&lt;a href=&quot;#top&quot;&gt;back to top&lt;/a&gt;)&lt;/p&gt;</longdescription>
</pkgmetadata>