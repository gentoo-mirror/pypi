<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>nfelib - bindings Python para e ler e gerir XML de NF-e, NFS-e nacional, CT-e, MDF-e, BP-e===&lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;https://akretion.com/pt_BR&quot; &gt;  &lt;img src=&quot;https://raw.githubusercontent.com/akretion/nfelib/master/ext/nfelib.jpg&quot;/&gt;&lt;/a&gt;&lt;/p&gt;&lt;p align=&quot;center&quot;&gt;&lt;a href=&quot;https://codecov.io/gh/akretion/nfelib&quot; &gt;  &lt;img src=&quot;https://codecov.io/gh/akretion/nfelib/branch/master/graph/badge.svg?token=IqcCHJzhuw&quot;/&gt;&lt;/a&gt;&lt;a href=&quot;https://pypi.org/project/nfelib/&quot;&gt;&lt;img alt=&quot;PyPI&quot; src=&quot;https://img.shields.io/pypi/v/nfelib&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://pepy.tech/project/nfelib&quot;&gt;&lt;img alt=&quot;Downloads&quot; src=&quot;https://pepy.tech/badge/nfelib&quot;&gt;&lt;/a&gt;&lt;/p&gt;## Porque escolher a nfelib* **Simples e confiável**. As outras bibliotecas costumam ter dezenas de milhares de linhas de código feito tudo manualmente para fazer o que o nfelib faz tudo automaticamente com algumas linhas para gerir código com o [xsdata](https://xsdata.readthedocs.io/) a partir dos últimos pacotes xsd da Fazenda. O xsdata é uma biblioteca de databinding extremamente bem escrita e bem testada. A própria nfelib tem testes para ler e gerir todos documentos fiscais.* **Completa**: já que gerir os bindings ficou trivial, a nfelib mantém atualizada todos os bindings para interagir com todos os serviços e eventos de NF-e, NFS-e nacional, CT-e, MDF-e, BP-e. Os testes detetam também quando sai uma nova versão de algum esquema.**Importante** Esta é a nova **versão 2.x** da nfelib onde os bindings são geridos com xsdata. Na versão 1.x os &quot;bindings&quot; eram geridos com generateDS. Fora algumas exceções listadas nos elementos *Substitution* no arquivo de configuração ```.xsdata.xml```, os novos bindings tem os mesmos campos que também correspondem aos atributos dos xsd. O nome das classes dos bindings ficou diferente (mais &quot;pythonico&quot;) porém então para ler os bindings a compatibilidade é quase perfeita, mas para montar bindings o código deve ser adaptado.Para facilitar a fase de transição para a nfelib 2.0, as primeiras versões da nfelib 2.0 estão empacotando também os antigos bindings da versão 1.x, no mesmo caminho ```nfelib/v4_00```.Se vc estiver procurando o codigo &quot;legacy da versão 1.x, ele esta na branch [master_gen_v4_00](https://github.com/akretion/nfelib/tree/master_gen_v4_00)## Instalação```bashpip install nfelib```## Como usar**NF-e**```python&gt;&gt;&gt; # Ler o XML de uma NF-e:&gt;&gt;&gt; from nfelib.nfe.bindings.v4_0.proc_nfe_v4_00 import NfeProc&gt;&gt;&gt; nfe_proc = NfeProc.from_path(&quot;nfelib/nfe/samples/v4_0/leiauteNFe/NFe35200159594315000157550010000000012062777161.xml&quot;)&gt;&gt;&gt; # (pode ser usado também o metodo from_xml(xml) )&gt;&gt;&gt;&gt;&gt;&gt; nfe_proc.NFe.infNFe.emit.CNPJ'59594315000157'&gt;&gt;&gt; nfe_proc.NFe.infNFe.emitTnfe.InfNfe.Emit(CNPJ='59594315000157', CPF=None, xNome='Akretion LTDA', xFant='Akretion', enderEmit=TenderEmi(xLgr='Rua Paulo Dias', nro='586', xCpl=None, xBairro=None, cMun='3501152', xMun='Alumínio', UF=&lt;TufEmi.SP: 'SP'&gt;, CEP='18125000', cPais=&lt;TenderEmiCPais.VALUE_1058: '1058'&gt;, xPais=&lt;TenderEmiXPais.BRASIL: 'Brasil'&gt;, fone='2130109965'), IE='755338250133', IEST=None, IM=None, CNAE=None, CRT=&lt;EmitCrt.VALUE_1: '1'&gt;)&gt;&gt;&gt; nfe_proc.NFe.infNFe.emit.enderEmit.UF.value'SP'&gt;&gt;&gt;&gt;&gt;&gt; # Serializar uma NF-e:&gt;&gt;&gt; nfe_proc.to_xml()'&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;\n&lt;nfeProc xmlns=&quot;http://www.portalfiscal.inf.br/nfe&quot; versao=&quot;4.00&quot;&gt;\n  &lt;NFe&gt;\n    &lt;infNFe versao=&quot;4.00&quot; Id=&quot;35200159594315000157550010000000012062777161&quot;&gt;\n      &lt;ide&gt;\n        &lt;cUF&gt;35&lt;/cUF&gt;\n        &lt;cNF&gt;06277716&lt;/cNF&gt;\n        &lt;natOp&gt;Venda&lt;/natOp&gt;\n        &lt;mod&gt;55&lt;/mod&gt;\n        &lt;serie&gt;1&lt;/serie&gt;\n        &lt;nNF&gt;1&lt;/nNF&gt;\n        &lt;dhEmi&gt;2020-01-01T12:00:00+01:00&lt;/dhEmi&gt;\n        &lt;dhSaiEnt&gt;2020-01-01T12:00:00+01:00&lt;/dhSaiEnt&gt;\n        &lt;tpNF&gt;1&lt;/tpNF&gt;\n        &lt;idDest&gt;1&lt;/idDest&gt;\n [...]&gt;&gt;&gt;&gt;&gt;&gt; # Montar uma NFe do zero:&gt;&gt;&gt; from nfelib.nfe.bindings.v4_0.nfe_v4_00 import Nfe&gt;&gt;&gt; nfe=Nfe(infNFe=Nfe.InfNfe(emit=Nfe.InfNfe.Emit(xNome=&quot;Minha Empresa&quot;, CNPJ='59594315000157')))&gt;&gt;&gt; nfeNfe(infNFe=Tnfe.InfNfe(ide=None, emit=Tnfe.InfNfe.Emit(CNPJ='59594315000157', CPF=None, xNome='Minha Empresa', xFant=None, enderEmit=None, IE=None, IEST=None, IM=None, CNAE=None, CRT=None), avulsa=None, dest=None, retirada=None, entrega=None, autXML=[], det=[], total=None, transp=None, cobr=None, pag=None, infIntermed=None, infAdic=None, exporta=None, compra=None, cana=None, infRespTec=None, infSolicNFF=None, versao=None, Id=None), infNFeSupl=None, signature=None)&gt;&gt;&gt; &gt;&gt;&gt; # Validar o XML de uma nota:&gt;&gt;&gt; nfe.validate_xml()[&quot;Element '{http://www.portalfiscal.inf.br/nfe}infNFe': The attribute 'versao' is required but missing.&quot;, &quot;Element '{http://www.portalfiscal.inf.br/nfe}infNFe': The attribute 'Id' is required but missing.&quot; [...]```**NFS-e padrão nacional**```python&gt;&gt;&gt; # Ler uma NFS-e:&gt;&gt;&gt;&gt; from nfelib.nfse.bindings.v1_0.nfse_v1_00 import Nfse&gt;&gt;&gt; nfse = Nfse.from_path(&quot;alguma_nfse.xml&quot;)&gt;&gt;&gt;&gt;&gt;&gt; # Serializar uma NFS-e:&gt;&gt;&gt; nfse.to_xml()&gt;&gt;&gt; # Ler uma DPS:&gt;&gt;&gt;&gt; from nfelib.nfse.bindings.v1_0.dps_v1_00 import Dps&gt;&gt;&gt; dps = Nfse.from_path(&quot;nfelib/nfse/samples/v1_0/GerarNFSeEnvio-env-loterps.xml&quot;)&gt;&gt;&gt;&gt;&gt;&gt; # Serializar uma DPS:&gt;&gt;&gt; dps.to_xml()```**MDF-e**```python&gt;&gt;&gt; # Ler um MDF-e:&gt;&gt;&gt;&gt; from nfelib.mdfe.bindings.v3_0.mdfe_v3_00 import Mdfe&gt;&gt;&gt; mdfe = Mdfe.from_path(&quot;nfelib/mdfe/samples/v3_0/ComPagtoPIX_41210780568835000181580010402005751006005791-procMDFe.xml&quot;)&gt;&gt;&gt;&gt;&gt;&gt; # Serializar um MDF-e:&gt;&gt;&gt; mdfe.to_xml()```**CT-e**```python&gt;&gt;&gt; # Ler um CT-e:&gt;&gt;&gt;&gt; from nfelib.cte.bindings.v4_0.cte_v4_00 import Cte&gt;&gt;&gt; cte = Cte.from_path(&quot;nfelib/cte/samples/v4_0/43120178408960000182570010000000041000000047-cte.xml&quot;)&gt;&gt;&gt;&gt;&gt;&gt; # Serializar um CT-e:&gt;&gt;&gt; cte.to_xml()```**BP-e**```python&gt;&gt;&gt; # Ler um BP-e:&gt;&gt;&gt;&gt; from nfelib.bpe.bindings.v1_0.bpe_v1_00 import Bpe&gt;&gt;&gt; bpe = Bpe.from_path(&quot;algum_bpe.xml&quot;)&gt;&gt;&gt;&gt;&gt;&gt; # Serializar um BP-e:&gt;&gt;&gt; bpe.to_xml()```## Desenvolvimento / testesPara rodar os testes:```bashpytest```Para atualizar os bindings:1. baixar o novo zip dos esquemas e atualizar a pasta ```nfelib/&lt;nfe|nfse|cte|mdfe|bpe&gt;/schemas/&lt;versao&gt;/```2. gerir os bindings de um pacote de esquemas xsd, por examplo da NF-e:    ```bash    xsdata generate nfelib/nfe/schemas/v4_0 --package nfelib.nfe.bindings.v4_0    ```Para gerir todos bindings com xsdata:```bash./script.sh```## Versões dos esquemas e pastasA nfelib usa apenas 2 dígitos para caracterizar a versão. Isso foi decidido observando que a Fazenda nunca usa o terceiro dígito da versão e que a mudança do segundo dígito já caracteriza uma mudança maior. Nisso qualquer alteração de esquema que não mudar o primeiro nem o segundo dígito da versão do esquema vai na mesma pasta e se sobreponha a antiga versão, assumindo que é possível usar o mais novo esquema no lugar do antigo (por exemplo é possível ler uma NFe 4.00 pacote nº 9j (NT 2022.003 v.1.00b) com os bindings da versão nfe pacote nº 9k (NT 2023.001 v.1.20).Pelo contrário, caso houver uma mudança maior afetando os 2 primeiros dígitos como NFe 3.0 e NFe 3.1 ou NFe 3.1 e NFe 4.0, será possível também suportar as várias versões ao mesmo tempo usando pastas diferentes. Assim seria possível por exemplo emitir a futura NFe 5.0 e ainda importar uma NFe 4.0.</longdescription>
</pkgmetadata>