<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># AMP Renderer![Python 3.6+](https://img.shields.io/badge/python-3.6%2B-blue) [![Build Status](https://travis-ci.com/chasefinch/amp-renderer.svg?branch=main)](https://travis-ci.com/chasefinch/amp-renderer) ![Coverage](https://img.shields.io/badge/coverage-90%25-brightgreen)Unofficial Python port of [server-side rendering](https://amp.dev/documentation/guides-and-tutorials/optimize-and-measure/amp-optimizer-guide/explainer/?format=websites) from [AMP Optimizer](https://github.com/ampproject/amp-toolbox/tree/main/packages/optimizer). Supports Python 3.6 and above.AMP Renderer performs the following optimizations:1. Inject the specific layout markup into each AMP element2. Insert the AMP runtime styles into the document3. Remove the AMP boilerplate styles, if possible4. Mark the document as “transformed” with the appropriate tags on the `html` element5. Insert `img` tags for images with the data-hero attributeIt also makes these formatting updates:1. Remove empty `class` and `style` tags for AMP HTML elements2. Convert tag names and attribute names to lowercase3. Convert numerical attribute values to strings4. Use double quotes (&quot;&quot;) for attributes, and escape double quotes inside attribute values5. Remove whitespace between html attributes6. If desired, removes comments (disabled by default)7. If desired, trims whitespace around HTML attribute values (disabled by default, and not always a good idea)AMPRenderer can be used on a block of arbitrary HTML, but when used on a full document, it will insert the AMP runtime styles and, if possible, remove the AMP boilerplate styles.Boilerplate styles can be removed except in these cases:- An AMP element uses an unsupported value for the `layout` attribute- `amp-audio` is used- There is at least one `amp-experiment` active- Transformation fails for one or more elements due to an invalid attribute value for `media`, `sizes`, or `heights`- Any render-delaying extension is used. Currently this means:  - `amp-dynamic-css-classes`  - `amp-story`If boilerplate styles can’t be removed, the attribute `no_boilerplate` will be set to `True` after calling `render`; otherwise it will be `False`. Until `render` runs, the `no_boilerplate` attribute isn’t set at all.## UsageIf using Django, you can use the [Django AMP Renderer middleware](https://github.com/chasefinch/django-amp-renderer).Otherwise, install via PyPI:pip install amp-rendererMinimal usage:from amp_renderer import AMPRenderer...RUNTIME_VERSION = &quot;012345678&quot; /* Current AMP runtime version number */RUNTIME_STYLES = &quot;...&quot; /* Current contents of https://cdn.ampproject.org/v0.css */renderer = AMPRenderer(runtime_version=RUNTIME_VERSION,runtime_styles=RUNTIME_STYLES)original_html = &quot;&quot;&quot;    &lt;!doctype html&gt;    &lt;html ⚡&gt;      ...    &lt;/html&gt;&quot;&quot;&quot;result = renderer.render(original_html)print(result)Remove comments and/or trim attributes:renderer.should_strip_comments = Truerenderer.should_trim_attributes = Trueresult = renderer.render(original_html)print(result)The AMPRenderer class inherits from [HTMLParser](https://docs.python.org/3/library/html.parser.html), and can be similarly extended.## Testing, etc.Install requrements:make installSort imports (Requires Python &gt;= 3.8):make formatLint (Requires Python &gt;= 3.8):make lintTest:make test## DiscussionThere are still some aspects of the official AMP Optimizer implementation that haven’t been addressed yet. PRs welcome.### General- [x] ~Tested against AMP Optimizer’s ServerSideRendering spec~- [ ] Automatic runtime version management### Dynamic attributes- [x] ~Support `sizes`, `media`, and `heights` via CSS injection~- [x] ~Group CSS injections for `media` attributes by shared media queries to reduce necessary bytes~- [ ] Support percent values in `heights`- [ ] Warn or fail if CSS injection puts the `amp-custom` element over the byte limit### Hero Images- [x] ~Inject `img` tag for `amp-img`s with the `data-hero` attribute~- [ ] Enforce 2-image limit on `data-hero`- [ ] Autodetect hero images- [ ] Support hero image functionality for `amp-iframe`, `amp-video`, and `amp-video-iframe`### PerformanceThe Python AMP Renderer does not insert `preload` links into the `head` of the DOM object for hero images; This can be done by hand for more control over the critical path.&lt;!--Since AMPRenderer adds the `amp-runtime` styles to the document, you can also use the [AMP Module Build](https://amp.dev/documentation/guides-and-tutorials/optimize-and-measure/amp-optimizer-guide/explainer/?format=websites#amp-module-build-(coming-soon)) by hand. To take advantage of this, rewrite the import scripts such that imports like this:&lt;script async src=&quot;https://cdn.ampproject.org/v0.js&quot;&gt;&lt;/script&gt;...become 2-part imports based on [Javascript Modules](https://v8.dev/features/modules#browser), like this:&lt;script type=&quot;module&quot; async src=&quot;https://cdn.ampproject.org/v0.mjs&quot;&gt;&lt;/script&gt;&lt;script nomodule async src=&quot;https://cdn.ampproject.org/v0.js&quot;&gt;&lt;/script&gt;--&gt;</longdescription>
</pkgmetadata>