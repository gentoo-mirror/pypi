<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>[![PyPI](https://img.shields.io/pypi/v/kafka_connect_py.svg)](https://pypi.org/project/kafka-connect-py/)[![Dockerhub](https://img.shields.io/docker/v/aidanmelen/kafka-connect-py?color=blue&amp;label=docker%20build)](https://hub.docker.com/r/aidanmelen/kafka-connect-py)[![Tests](https://github.com/aidanmelen/kafka-connect-py/actions/workflows/tests.yaml/badge.svg)](https://github.com/aidanmelen/kafka-connect-py/actions/workflows/tests.yaml)[![Coverage Status](https://coveralls.io/repos/github/aidanmelen/kafka-connect-py/badge.svg?branch=main)](https://coveralls.io/github/aidanmelen/kafka-connect-py?branch=main)# Kafka Connect PythonThe Kafka Connect REST API allows you to manage connectors that move data between Apache Kafka and other systems.The Kafka Connect command line tool, also known as `kc` or `kafka-connect`, allows users to manage their Kafka Connect cluster and connectors. With this tool, users can retrieve information about the cluster and connectors, create new connectors, update existing connectors, delete connectors, and perform other actions.This project aims to supported all features of the [Kafka Connect REST API](https://docs.confluent.io/platform/current/connect/references/restapi.html#kconnect-rest-interface).## Install```bashpip install kafka-connect-py```## Command Line Usage### Getting Basic Connect Cluster InformationTo get basic Connect cluster information including the worker version, the commit it’s on, and its Kafka cluster ID, use the following command:```bashkc info```### Listing Installed PluginsTo list the plugins installed on the worker, use the following command:```bashkc list-plugins```To format the result of the installed plugin list for easier readability, pipe the output to the `jq` command:```bashkc list-plugins | jq```### Create a Connector InstanceTo create a connector instance with JSON data containing the connector’s configuration:```bashkc update source-debezium-orders-00 -d '{    &quot;connector.class&quot;: &quot;io.debezium.connector.mysql.MySqlConnector&quot;,    &quot;value.converter&quot;: &quot;io.confluent.connect.json.JsonSchemaConverter&quot;,    &quot;value.converter.schemas.enable&quot;: &quot;true&quot;,    &quot;value.converter.schema.registry.url&quot;: &quot;'$SCHEMA_REGISTRY_URL'&quot;,    &quot;value.converter.basic.auth.credentials.source&quot;: &quot;'$BASIC_AUTH_CREDENTIALS_SOURCE'&quot;,    &quot;value.converter.basic.auth.user.info&quot;: &quot;'$SCHEMA_REGISTRY_BASIC_AUTH_USER_INFO'&quot;,    &quot;database.hostname&quot;: &quot;mysql&quot;,    &quot;database.port&quot;: &quot;3306&quot;,    &quot;database.user&quot;: &quot;debezium&quot;,    &quot;database.password&quot;: &quot;dbz&quot;,    &quot;database.server.id&quot;: &quot;42&quot;,    &quot;database.server.name&quot;: &quot;asgard&quot;,    &quot;table.whitelist&quot;: &quot;demo.orders&quot;,    &quot;database.history.kafka.bootstrap.servers&quot;: &quot;'$BOOTSTRAP_SERVERS'&quot;,    &quot;database.history.consumer.security.protocol&quot;: &quot;SASL_SSL&quot;,    &quot;database.history.consumer.sasl.mechanism&quot;: &quot;PLAIN&quot;,    &quot;database.history.consumer.sasl.jaas.config&quot;: &quot;org.apache.kafka.common.security.plain.PlainLoginModule required username=\&quot;'$CLOUD_KEY'\&quot; password=\&quot;'$CLOUD_SECRET'\&quot;;&quot;,    &quot;database.history.producer.security.protocol&quot;: &quot;SASL_SSL&quot;,    &quot;database.history.producer.sasl.mechanism&quot;: &quot;PLAIN&quot;,    &quot;database.history.producer.sasl.jaas.config&quot;: &quot;org.apache.kafka.common.security.plain.PlainLoginModule required username=\&quot;'$CLOUD_KEY'\&quot; password=\&quot;'$CLOUD_SECRET'\&quot;;&quot;,    &quot;database.history.kafka.topic&quot;: &quot;dbhistory.demo&quot;,    &quot;topic.creation.default.replication.factor&quot;: &quot;3&quot;,    &quot;topic.creation.default.partitions&quot;: &quot;3&quot;,    &quot;decimal.handling.mode&quot;: &quot;double&quot;,    &quot;include.schema.changes&quot;: &quot;true&quot;,    &quot;transforms&quot;: &quot;unwrap,addTopicPrefix&quot;,    &quot;transforms.unwrap.type&quot;: &quot;io.debezium.transforms.ExtractNewRecordState&quot;,    &quot;transforms.addTopicPrefix.type&quot;:&quot;org.apache.kafka.connect.transforms.RegexRouter&quot;,    &quot;transforms.addTopicPrefix.regex&quot;:&quot;(.*)&quot;,    &quot;transforms.addTopicPrefix.replacement&quot;:&quot;mysql-debezium-$1&quot;}'```Or create/update a connector instance with a JSON file:```bashkc update &lt;connector&gt; --config-file &lt;config_file&gt;```### Update a ConnectorAs mentioned above, if there’s a connector to update, you can use the `update` sub-command to amend the configuration (see [Create a Connector Instance](https://github.com/aidanmelen/kafka-connect-py/blob/main/README.md#create-a-connector-instance) above). Because update is used to both create and update connectors, it’s the standard command that you should use most of the time (which also means that you don’t have to completely rewrite your configs).### List Connector InstancesUse the following command to list of all extant connectors:```bashkc list [--expand=info|status] [--pattern=regex] [--state=running|paused|unassigned|failed]```### Inspect Config and Status for a ConnectorInspect the config for a given connector as follows:```bashkc config sink-elastic-orders-00```You can also look at a connector’s status. While the config command shows a connector’s static configuration, the status shows the connector as a runtime entity:```bashkc status sink-elastic-orders-00```You can also use `list` with the `--expand=status` option to show the status of many connectors at once. We can filter down the response using a regex pattern and/or connector state. Use the following to show all connector names prefixed with the word `sink-` and that are in a `FAILED` connector state.```bashkc list --expand=status -p sink-.* -s failed```### Delete a ConnectorIf something is wrong in your setup and you don’t think a config change would help, or if you simply don’t need a connector to run anymore, you can delete it by name:```bashkc delete sink-elastic-orders-00```The `delete` sub-command also supports multiple deletions using the `--all` option. On its own it will apply the sub-command to all connectors.The following will delete all connector names prefixed with the word `sink-` and that are in a `PAUSED` connector state.```bashkc delete --all --pattern sink-.* -s paused```The `--all` option is supported by several sub-commands, including `delete`, `restart`, `resume`, and `pause`. However, for better testing and control over the outcome of your actions, we recommend using the list filtering option before executing any of these sub-commands. This way, you can ensure that your filters are working as intended and avoid unintended consequences. To use list filtering, simply run the `list` sub-command and apply your filters.### Inspect Task DetailsThe following command returns the connector status:```bashkc status source-debezium-orders-00 | jq```If your connector fails, the details of the failure belong to the task. So to inspect the problem, you’ll need to find the stack trace for the task. The task is the entity that is actually running the connector and converter code, so the state for the stack trace lives in it.```bashkc task-status source-debezium-orders-00 &lt;task-id&gt; | jq```### Restart the Connector and TasksIf after inspecting a task, you have determined that it has failed and you have fixed the reason for the failure (perhaps restarted a database), you can restart the connector with the following:```kc restart source-debezium-orders-00```Keep in mind though that restarting the connector doesn’t restart all of its tasks. You will also need to restart the failed task and then get its status again as follows:```bashkc task-status source-debezium-orders-00 &lt;task-id&gt; ```What's more, you can restart the connector and all its failed tasks with the following:```bashkc restart source-debezium-orders-00 --include-tasks --failed-only```and check the status again:```bashkc status source-debezium-orders-00 | jq```### Pause and Resume a ConnectorUnlike restarting, pausing a connector does pause its tasks. This happens asynchronously, though, so when you pause a connector, you can’t rely on it pausing all of its tasks at exactly the same time. The tasks are running in a thread pool, so there’s no fancy mechanism to make this happen simultaneously.A connector and its tasks can be paused as follows:```bashkc pause source-debezium-orders-00```Just as easily, a connector and its tasks can be resumed:```bashkc resume source-debezium-orders-00```### Display All of a Connector’s TasksA convenient way to display all of a connector’s tasks at once is as follows:```bashkc list-tasks source-debezium-orders-00 | jq```This information is similar to what you can get from other APIs, but it is broken down by task, and configs for each are shown.Get a List of Topics Used by a ConnectorAs of Apache Kafka 2.5, it is possible to get a list of topics used by a connector:```bashkc list-topics source-debezium-orders-00 | jq```This shows the topics that a connector is consuming from or producing to. This may not be particularly useful for connectors that are consuming from or producing to a single topic. However, some developers, for example, use regular expressions for topic names in Connect, so this is a major benefit in situations where topic names are derived computationally.This could also be useful with a source connector that is using SMTs to dynamically change the topic names to which it is producing.## Python```python# Import the classfrom kafka_connect import KafkaConnectimport json# Instantiate the clientclient = KafkaConnect(url=&quot;http://localhost:8083&quot;)# Get the version and other details of the Kafka Connect clustercluster = client.get_cluster_info()print(cluster)# Get a list of active connectorsconnectors = client.list_connectors(expand=&quot;status&quot;)print(json.dumps(connectors, indent=2))# Create a new connectorconfig = {    &quot;name&quot;: &quot;my-connector&quot;,    &quot;config&quot;: {        &quot;connector.class&quot;: &quot;io.confluent.connect.jdbc.JdbcSourceConnector&quot;,        &quot;tasks.max&quot;: &quot;1&quot;,        &quot;connection.url&quot;: &quot;jdbc:postgresql://localhost:5432/mydatabase&quot;,        &quot;connection.user&quot;: &quot;myuser&quot;,        &quot;connection.password&quot;: &quot;mypassword&quot;,        &quot;table.whitelist&quot;: &quot;mytable&quot;,        &quot;mode&quot;: &quot;timestamp+incrementing&quot;,        &quot;timestamp.column.name&quot;: &quot;modified_at&quot;,        &quot;validate.non.null&quot;: &quot;false&quot;,        &quot;incrementing.column.name&quot;: &quot;id&quot;,        &quot;topic.prefix&quot;: &quot;my-connector-&quot;,    },}response = client.create_connector(config)print(response)# Update an existing connectornew_config = {    &quot;config&quot;: {        &quot;connector.class&quot;: &quot;io.confluent.connect.jdbc.JdbcSourceConnector&quot;,        &quot;tasks.max&quot;: &quot;1&quot;,        &quot;connection.url&quot;: &quot;jdbc:postgresql://localhost:5432/mydatabase&quot;,        &quot;connection.user&quot;: &quot;myuser&quot;,        &quot;connection.password&quot;: &quot;mypassword&quot;,        &quot;table.whitelist&quot;: &quot;mytable&quot;,        &quot;mode&quot;: &quot;timestamp+incrementing&quot;,        &quot;timestamp.column.name&quot;: &quot;modified_at&quot;,        &quot;validate.non.null&quot;: &quot;false&quot;,        &quot;incrementing.column.name&quot;: &quot;id&quot;,        &quot;topic.prefix&quot;: &quot;my-connector-&quot;,    },}response = client.update_connector(&quot;my-connector&quot;, new_config)print(response)# Get status for a connectorresponse = client.get_connector_status(&quot;my-connector&quot;)print(json.dumps(response, indent=2))# Restart a connectorresponse = client.restart_connector(&quot;my-connector&quot;)print(response)# Delete a connectorresponse = client.delete_connector(&quot;my-connector&quot;)print(response)```## License[Apache 2.0 License - aidanmelen/kafka-connect-py](https://github.com/aidanmelen/kafka-connect-py/blob/main/README.md)## CreditsThe entire [Command Line Usage](https://github.com/aidanmelen/kafka-connect-py/blob/main/README.md#command-line-usage) section was copied directly from the Confluence's [Kafka Connect’s REST API](https://developer.confluent.io/learn-kafka/kafka-connect/rest-api/) course.</longdescription>
</pkgmetadata>