<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># **C**ommon **O**perations **O**n **L**ots-of **Seq**uences ToolThe **cool-seq-tool** provides:  - Transcript alignment data from the [UTA](https://github.com/biocommons/uta) database  - Fast access to sequence data using [SeqRepo](https://github.com/biocommons/biocommons.seqrepo)  - Liftover between assemblies (GRCh38 &lt;--&gt; GRCh37) from [PyLiftover](https://github.com/konstantint/pyliftover)  - Lifting over to preferred [MANE](https://www.ncbi.nlm.nih.gov/refseq/MANE/) compatible transcript. See [here](docs/TranscriptSelectionPriority.md) for more information.## Installation### pip```commandlinepip install cool-seq-tool[dev,tests]```### DevelopmentClone the repo:```commandlinegit clone https://github.com/GenomicMedLab/cool-seq-toolcd cool_seq_tool```[Install Pipenv](https://pipenv-fork.readthedocs.io/en/latest/#install-pipenv-today) if necessary.Install backend dependencies and enter Pipenv environment:```commandlinepipenv shellpipenv updatepipenv install --dev```### UTA Database Installation`cool-seq-tool` uses intalls local UTA database. For other ways to install, visit [biocommons.uta](https://github.com/biocommons/uta).#### Local Installation_The following commands will likely need modification appropriate for the installation environment._1. Install [PostgreSQL](https://www.postgresql.org/)2. Create user and database.    ```    $ createuser -U postgres uta_admin    $ createuser -U postgres anonymous    $ createdb -U postgres -O uta_admin uta    ```3. To install locally, from the _cool_seq_tool/data_ directory:```export UTA_VERSION=uta_20210129.pgd.gzcurl -O http://dl.biocommons.org/uta/$UTA_VERSIONgzip -cdq ${UTA_VERSION} | grep -v &quot;^REFRESH MATERIALIZED VIEW&quot; | psql -h localhost -U uta_admin --echo-errors --single-transaction -v ON_ERROR_STOP=1 -d uta -p 5433```##### UTA Installation IssuesIf you have trouble installing UTA, you can visit [these two READMEs](https://github.com/ga4gh/vrs-python/tree/main/docs/setup_help).#### Connecting to the databaseTo connect to the UTA database, you can use the default url (`postgresql://uta_admin@localhost:5433/uta/uta_20210129`). If you use the default url, you must either set the password using environment variable `UTA_PASSWORD` or setting the parameter `db_pwd` in the UTA class.If you do not wish to use the default, you must set the environment variable `UTA_DB_URL` which has the format of `driver://user:pass@host:port/database/schema`.### Data Downloads#### SeqRepo`cool-seq-tool` relies on [seqrepo](https://github.com/biocommons/biocommons.seqrepo), which you must download yourself.Use the `SEQREPO_ROOT_DIR` environment variable to set the path of an already existing SeqRepo directory. The default is `/usr/local/share/seqrepo/latest`.From the _root_ directory:```pip install seqreposudo mkdir /usr/local/share/seqreposudo chown $USER /usr/local/share/seqreposeqrepo pull -i 2021-01-29  # Replace with latest version using `seqrepo list-remote-instances` if outdated```If you get an error similar to the one below:```PermissionError: [Error 13] Permission denied: '/usr/local/share/seqrepo/2021-01-29._fkuefgd' -&gt; '/usr/local/share/seqrepo/2021-01-29'```You will want to do the following:\(*Might not be ._fkuefgd, so replace with your error message path*)```consolesudo mv /usr/local/share/seqrepo/2021-01-29._fkuefgd /usr/local/share/seqrepo/2021-01-29exit```#### transcript_mappings.tsv`cool-seq-tool` uses [Ensembl BioMart](http://www.ensembl.org/biomart/martview) to retrieve `cool_seq_tool/data/transcript_mappings.tsv`. We currently use `Human Genes (GRCh38.p13)` for the dataset and the following attributes we use are: Gene stable ID, Gene stable ID version, Transcript stable ID, Transcript stable ID version, Protein stable ID, Protein stable ID version, RefSeq match transcript (MANE Select), Gene name.![image](biomart.png)Use the `TRANSCRIPT_MAPPINGS_PATH` environment variable to set the path of an already existing `transcript_mappings.tsv`. The default is `cool_seq_tool/data/transcript_mapping.tsv`.#### LRG_RefSeqGene`cool-seq-tool` fetches the latest version of `LRG_RefSeqGene` if the environment variable `LRG_REFSEQGENE_PATH` is not set. When `LRG_REFSEQGENE_PATH` is set, `cool-seq-tool` will look at this path and expect the LRG_RefSeqGene file. This file is found can be found [here](https://ftp.ncbi.nlm.nih.gov/refseq/H_sapiens/RefSeqGene).#### MANE Summary Data`cool-seq-tool` fetches the latest version of `MANE.GRCh38.*.summary.txt.gz` if the environment variable `MANE_SUMMARY_PATH` is not set. When `MANE_SUMMARY_PATH` is set, `cool-seq-tool` will look at this path and expect the MANE Summary Data file. This file is found can be found [here](https://ftp.ncbi.nlm.nih.gov/refseq/MANE/MANE_human/current/).## Starting the UTA Tools Service LocallyTo start the service, run the following:```commandlineuvicorn cool_seq_tool.main:app --reload```Next, view the FastAPI on your local machine: http://127.0.0.1:8000/cool_seq_tool## Init coding style testsCode style is managed by [flake8](https://github.com/PyCQA/flake8) and checked prior to commit.We use [pre-commit](https://pre-commit.com/#usage) to run conformance tests.This ensures:* Check code style* Check for added large files* Detect AWS Credentials* Detect Private KeyBefore first commit run:```pre-commit install```## TestingFrom the _root_ directory of the repository:```pytest```</longdescription>
</pkgmetadata>