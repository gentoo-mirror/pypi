<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># pbipy![PyPI](https://img.shields.io/pypi/v/pbipy) ![GitHub tag (latest SemVer)](https://img.shields.io/github/v/tag/andrewvillazon/pbipy) ![PyPI - Python Version](https://img.shields.io/pypi/pyversions/pbipy) ![GitHub](https://img.shields.io/github/license/andrewvillazon/pbipy) ![Static Badge](https://img.shields.io/badge/Python-blue?logo=python&amp;logoColor=yellow) ![Static Badge](https://img.shields.io/badge/power-bi-yellow?logoColor=yellow&amp;labelColor=yellow&amp;color=black)`pbipy` is a Python Library for interacting with the Power BI Rest API. It aims to simplyify working with the Power BI Rest API and support programatic administration of Power BI in Python.`pbipy` supports operations for Apps, Datasets, Groups (Workspaces) and Reports, allowing users to perform actions on their PowerBI instance using Python.See [development progress](#development-progress) below for what's been implemented and what's coming.## Installation```consolepip install pbipy```Or to install the latest development code:```consolepip install git+https://github.com/andrewvillazon/pbipy```## Getting Started: AuthenticationTo use `pbipy` you'll first need to acquire a `bearer_token`.*How do I get a `bearer_token`?*To acquire a `bearer_token` you'll need to authenticate against your [Registered Azure Power BI App](https://learn.microsoft.com/en-us/power-bi/developer/embedded/register-app?tabs=customers). Registering is the first step in turning on the Power BI Rest API, so from this point on it's assumed your Power BI Rest API is up and running.To authenticate against the Registered App, Microsoft provides the `MSAL` and `azure-identity` python libraries. These libraries support many different ways of acquiring a `bearer_token`.Because there are multiple ways to acquire the token, `pbipy` assumes you'll do this in the way that suits, rather than directly handling authentication (of course, this might change in future).This `README` doesn't cover Authentication in detail, however, these are some helpful resources that look at acquiring a `bearer_token` in the context of Power BI:* [Power BI REST API with Python and MSAL. Part II.](https://www.datalineo.com/post/power-bi-rest-api-with-python-and-msal-part-ii)* [Power BI REST API with Python Part III, azure-identity](https://www.datalineo.com/post/power-bi-rest-api-with-python-part-iii-azure-identity)* [Monitoring Power BI using REST APIs from Python](https://data-goblins.com/power-bi/power-bi-api-python)The example below uses the `msal` library to to get a `bearer_token`.## UseageStart by creating the `PowerBI()` client. All interactions with the Power BI Rest API go through this object. ```pythonimport msalfrom pbipy import PowerBI#  msal auth setupdef acquire_bearer_token(username, password, azure_tenant_id, client_id, scopes):    app = msal.PublicClientApplication(client_id, authority=azure_tenant_id)    result = app.acquire_token_by_username_password(username, password, scopes)    return result[&quot;access_token&quot;]bearer_token = acquire_bearer_token(    username=&quot;your-username&quot;,    password=&quot;your-password&quot;,    azure_tenant_id=&quot;https://login.microsoftonline.com/your-azure-tenant-id&quot;,    client_id=&quot;your-pbi-client-id&quot;,    scopes=[&quot;https://analysis.windows.net/powerbi/api/.default&quot;],)# Create Clientpbi = PowerBI(bearer_token)```To interact with the API, simply call the relevant method from the client.```python# Grab the datasets from a workspacepbi.datasets(group=&quot;f089354e-8366-4e18-aea3-4cb4a3a50b48&quot;)````pbipy` converts API responses into regular Python objects, with snake case included! üêçüêç```pythonsales = pbi.dataset(&quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;)print(type(sales))print(hasattr(sales, &quot;configured_by&quot;))# &lt;class 'pbipy.resources.Dataset'&gt;# True```Most methods take in an object id...```pythondataset = pbi.dataset(&quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;, group=&quot;a2f89923-421a-464e-bf4c-25eab39bb09f&quot;)```... or just pass in the object itself.```pythongroup = pbi.group(&quot;a2f89923-421a-464e-bf4c-25eab39bb09f&quot;)dataset = pbi.dataset(&quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;, group=group)```If you need to access the raw json representation, this is supported to.```pythonsales = pbi.dataset(&quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;)print(sales.raw)# {#   &quot;id&quot;: &quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;,#   &quot;name&quot;: &quot;SalesMarketing&quot;,#   &quot;addRowsAPIEnabled&quot;: False,#   &quot;configuredBy&quot;: &quot;john@contoso.com&quot;,#   ...# }```## Example: Working with DatasetsLet's see how `pbipy` works by performing some operations on a Dataset.First, we need to load the Dataset from the API. To do this, we call the `dataset()` method from the `pbi` client we created above. The Power BI Rest API will look for the Dataset in the current user's workspace if we don't provide a group argument.```pythonsales = pbi.dataset(id=&quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;)print(sales)# &lt;Dataset id='cfafbeb1-8037-4d0c-896e-a46fb27ff229', name='SalesMarketing', ...&gt;```But we likely want to target a Dataset in a *Workspace*. To do this, we provide the `group_id` when we call the `dataset()` method.```pythonsales = pbi.dataset(    &quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;,    group=&quot;f089354e-8366-4e18-aea3-4cb4a3a50b48&quot;,)```Now that we've got our target Dataset let's look at its Refresh History. We call the `refresh_history()` method on our Dataset. Easy.```pythondataset = pbi.dataset(    &quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;,    group=&quot;f089354e-8366-4e18-aea3-4cb4a3a50b48&quot;,)refresh_history = dataset.refresh_history()for entry in refresh_history:    print(entry)# {&quot;refreshType&quot;:&quot;ViaApi&quot;, &quot;startTime&quot;:&quot;2017-06-13T09:25:43.153Z&quot;, &quot;status&quot;: &quot;Completed&quot; ...}```How about adding some user permissions to our Dataset? That's easy too. Just call the `add_user()` method with the User's details and permissions.```pythonsales_ds = pbi.dataset( &quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;)# Give John 'Read' access on the datasetsales_ds.add_user(&quot;john@contoso.com&quot;, &quot;User&quot;, &quot;Read&quot;)```Lastly, if we're feeling adventurous, we can execute DAX against a Dataset and use the results in Python.```pythondataset = pbi.dataset( &quot;cfafbeb1-8037-4d0c-896e-a46fb27ff229&quot;)dxq_result = dataset.execute_queries(&quot;EVALUATE VALUES(MyTable)&quot;)print(dxq_result)# {#   &quot;results&quot;: [#     {#       &quot;tables&quot;: [#         {#           &quot;rows&quot;: [#             {#               &quot;MyTable[Year]&quot;: 2010,#               &quot;MyTable[Quarter]&quot;: &quot;Q1&quot;#             },# ...# }```## More examples### Datasets in a Workspace```pythondatasets = pbi.datasets(group=&quot;f089354e-8366-4e18-aea3-4cb4a3a50b48&quot;)for dataset in datasets:    print(dataset)# &lt;Dataset id='cfafbeb1-8037-4d0c-896e-a46fb27ff229', ...&gt;# &lt;Dataset id='f7fc6510-e151-42a3-850b-d0805a391db0', ...&gt;```### List Workspaces```pythongroups = pbi.groups()for group in groups:    print(group)# &lt;Group id='a2f89923-421a-464e-bf4c-25eab39bb09f', name='contoso'&gt;# &lt;Group id='3d9b93c6-7b6d-4801-a491-1738910904fd', name='marketing'&gt;```### Create a Workspace```pythongroup = pbi.create_group(&quot;contoso&quot;)print(group)# &lt;Group id='a2f89923-421a-464e-bf4c-25eab39bb09f', name='contoso'&gt;```### Users and their access```pythongroup = pbi.group(&quot;a2f89923-421a-464e-bf4c-25eab39bb09f&quot;)users = group.users()for user in users:    print(user)# {&quot;identifier&quot;: &quot;john@contoso.com&quot;, &quot;groupUserAccessRight&quot;: &quot;Admin&quot;, ... }# {&quot;identifier&quot;: &quot;Adam@contoso.com&quot;, &quot;groupUserAccessRight&quot;: &quot;Member&quot;, ... }```## Power BI Rest API Operations`pbipy` methods wrap around the Operations described in the Power BI Rest API Reference:[Power BI REST APIs for embedded analytics and automation - Power BI REST API](https://learn.microsoft.com/en-us/rest/api/power-bi/)## Development Progress`pbipy` is in development so expect a few features to be missing. The aim is to cover off most of the core stuff like Datasets, Workspaces (Groups), Reports, Apps, etc., and the rest later on. Check back regularly to see what's been added or still in the pipeline.| PowerBI Component   | Progress | Notes ||---------------------|----------|-------|| Datasets            | Done     |       || Groups (Workspaces) | Done    |       || Reports             | Done      |       || Apps                | Done   |       || Dataflows           | Doing    |       || Admin Operations     | Todo     |       || Dashboards          | Todo     |       || Everything else     | Backlog  |       |## ContributingContributions such as bug reports, fixes, documentation or docstrings, enhancements, and ideas are welcome. `pbipy` uses github to host code, track issues, record feature requests, and accept pull requests.A `contributing.md` is in the works, but in the meantime below is a general guide.### Making a contributionPull requests are the best way to make a contribution to the code:1. Fork the repo and create your branch from master.2. If you've added code that should be tested, add tests.3. Add docstrings.4. Ensure the test suite passes.5. Format your code (`pbipy` uses [black](https://github.com/psf/black)).6. Issue that pull request!### Reporting a bugGreat Bug Reports tend to have:* A quick summary and/or background* Steps to reproduce. Be specific! Give sample code if you can.* What you expected would happen* What actually happens* Notes (possibly including why you think this might be happening, or stuff you tried that didn't work)## AcknowledgementsThe design of this library was heavily inspired by (basically copied) the [pycontribs/jira](https://github.com/pycontribs/jira) library. It also borrows elements of [cmberryay's pypowerbi wrapper](https://github.com/cmberryau/pypowerbi).Thank You to all the contributors to these libraries for the great examples of what an API Wrapper can be.</longdescription>
</pkgmetadata>