<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>[![banner](https://raw.githubusercontent.com/keyko-io/assets/master/images/logo/small/keyko_logo@2x-100.jpg)](https://keyko.io)# DeFi Crawler Python library&gt; [keyko.io](https://keyko.io)---## Table of Contents  - [Features](#features)  - [Prerequisites](#prerequisites)  - [Quick-start](#quick-start)     - [Usage](#usage)     - [Supported protocols](#supported-protocols)     - [Testing](#testing)  - [Contributions](#contributions)  - [License](#license)---## FeaturesThis library allows to get DeFi data from several protocols in a structured and standard way. This data comes from different subgraphs displayed in The Graph protocol## PrerequisitesPython 3.6## Quick-start```pip install deficrawler```### UsageTo get data from a protocol, it's needed to create an instance of the protocol with the name, version and blockchain where the protocols exists, the supported protocols can be found in [supported protocols](#supported-protocols) section. And the entities for the protocols with the field types in the [entities](#https://github.com/keyko-io/defi-crawler-py/tree/main/docs/entities) folderTo get data from Lending protocols```python# Instanciate the protocol with the name, version and chainfrom deficrawler import Lendingaave = Lending(protocol=&quot;Aave&quot;, chain=&quot;Ethereum&quot;, version=2)aave_polygon = Lending(protocol=&quot;Aave&quot;, chain=&quot;Polygon&quot;, version=2)compound = Lending(protocol=&quot;Compound&quot;, chain=&quot;Ethereum&quot;, version=2)cream = Lending(protocol=&quot;Cream&quot;, chain=&quot;Ethereum&quot;, version=2)cream_bsc = Lending(protocol=&quot;Cream&quot;, chain=&quot;bsc&quot;, version=2)# Not all the protocols has the same available events to get data, to know which entities are supported for each protocol:aave.supported_entities()uniswap.suported_entities()## For each different entity, data can be retrieved in a specific time range.compound.get_data_from_date_range(start_date, end_date, &quot;borrow&quot;)# To get the all the users of a protocolcream_bsc.get_all_users()# And the user positions cream_bsc.get_all_users(user)```To get data from Dex protocols```python# Instanciate the protocol with the name, version and chainfrom deficrawler import Dexuniswap = Dex(protocol=&quot;Uniswap&quot;, chain=&quot;Ethereum&quot;, version=2)balancer = Dex(protocol=&quot;Balancer&quot;, chain=&quot;Ethereum&quot;, version=1)bancor = Dex(&quot;Bancor&quot;, chain=&quot;Ethereum&quot;, version=1)shushi = Dex(&quot;SushiSwap&quot;, chain=&quot;Ethereum&quot;, version=1)# Not all the protocols has the same available events to get data, to know which entities are supported for each protocol:uniswap.supported_entities()balancer.suported_entities()## For each different entity, data can be retrieved in a specific time range.uniswap.get_data_from_date_range(start_date_amm, end_date_amm, &quot;swap&quot;)# To get the all the pools of a protocoluniswap.get_all_pools()```To get prices from the oracles it's needed to instanciate an oracle object and call the functions.```python# Instanciate the oracle with the name, version and chainfrom deficrawler import Oraclechainlink = Oracle(protocol=&quot;chainlink&quot;, version=1, chain=&quot;Ethereum&quot;)#Get all the available pairs to get the datachainlink.get_all_pairs() #Get the price for a specific pair in a time rangechainlink.get_price_from_date_range(from_date=start_date, to_date=end_date, pair=&quot;ETH/USD&quot;)```### Supported-protocols#### ProtocolsName | Type | Version | Chain--------|-------|---------|-------Aave | Lending | 2 | EthereumAave | Lending | 2 | PolygonAave | Lending | 2 | AvalancheCompound | Lending | 2 | EthereumCream | Lending | 2 | EthereumCream | Lending | 2 | BSCCream | Lending | 2 | PolygonCream | Lending | 2 | ArbitrumCream | Lending | 2 | AvalanceCream | Lending | 2 | FantomKashi | Lending | 1 | EthereumKashi | Lending | 1 | PolygonKashi | Lending | 1 | xDaiKashi | Lending | 1 | fantomUniswap | Dexes | 2 | EthereumUniswap | Dexes | 3 | EthereumUniswap | Dexes | 3 | OptimismBalancer | Dexes | 2 | EthereumBalancer | Dexes | 2 | ArbitrumBalancer | Dexes | 2 | PolygonBancor | Dexes | 1 | EthereumSushiSwap | Dexes | 1 | EthereumSushiSwap | Dexes | 1 | BSCSushiSwap | Dexes | 1 | PolygonSushiSwap | Dexes | 1 | FantomSushiSwap | Dexes | 1 | CeloDodoex | Dexes | 2 | EthereumDodoex | Dexes | 2 | PolygonDodoex | Dexes | 2 | BSCDodoex | Dexes | 2 | ArbitrumUbeswap | Dexes | 1 | CeloPancakeswap | Dexes | 2 | BSCPangolin | Dexes | 1 | AvalancheTraderjoe | Dexes | 1 | Avalanche#### OraclesName | Type | Version | Chain--------|-------|---------|-------Chainlink | Oracle | 1 | Ethereum#### TestingTests are creatd using Pytest library. To run the tests        pytest -v #### ExamplesTo run the examples run         python3 docs/examples.py ### ContributionsIf you want to add a new protocol to be supported or a new entity to retrive data, create a PR with the new configuration of the protocol and the unit/integration tests of this new feature.To add a new protocol, create a new json config file in the config folder, with the struture `protocolname-version.json`.Inside this configuration file must be the following sections:##### ProtocolThis section specifies the global configuration of the protocol. The required fields are   - **Name:** Protocol name.  - **Type:** Protocol type (Borrowing lending)  - **Version:** Version of the protcol  - **Enpoint:** Subgrapn endpoint to send the http request to get the data. If the protocols exists on more than one chain, several enpoints can be provided **Example**````json  &quot;protocol&quot;: {    &quot;name&quot;: &quot;AAVE&quot;,    &quot;type&quot;: &quot;Lending&quot;,    &quot;version&quot;: 2,    &quot;endpoint&quot;: {      &quot;ethereum&quot;: &quot;https://api.thegraph.com/subgraphs/name/aave/protocol-v2&quot;,      &quot;polygon&quot;: &quot;https://api.thegraph.com/subgraphs/name/aave/aave-v2-matic&quot;    }  }````  After this section the supported entities should be specified. Each entity has three different sections inside of them.  - **Entity:** The entity contains the fields to create a common entity from a shared type of event of different protocols (borrow, swap, deposit...). The entity starts with the name that will be applied to this specific event across all the protocols. Then should be a field for each attribute that will be contained in the entity, and each field shoud have an array, with the path to find this element in the corresponding subpgraph, these fields will be used to create the query. As example for borrow entity in Aave:    ````    &quot;borrow&quot;: {      &quot;attributes&quot;: {        &quot;tx_id&quot;:[          &quot;id&quot;        ],        &quot;user&quot;: [          &quot;user&quot;,          &quot;id&quot;        ],        &quot;token&quot;: [          &quot;reserve&quot;,          &quot;symbol&quot;        ],        &quot;amount&quot;: [          &quot;amount&quot;        ],        &quot;timestamp&quot;: [          &quot;timestamp&quot;        ]      }  - **Query:**: Each query in each protocol can be named different, to allow create the query dynamically, the query name should be specified and the field to order by if will be more that one batch to retrive. In this section also can be specified, additional fields to get data from the subgraph that will be needed to apply transformations, but will not be part of the output itself. As example for Aave we need to get the decimals for the token to divide the amount, but the decimals are not part of the entity. As example      ````          &quot;query&quot;: {            &quot;extra_fields&quot;: {              &quot;decimals&quot;: [                &quot;reserve&quot;,                &quot;decimals&quot;              ]            },            &quot;name&quot;: &quot;borrows&quot;,            &quot;params&quot;: {              &quot;orderBy&quot;: &quot;timestamp&quot;            }          }  - **Tranformations:** This section specified the transformations that should be applied to the fields (if any transformation should be applied). Here we can specify the field of the common entity (the output) that needs to be transform, and the function that will be applied. This funtion will be call dinamically in the transformation phase. As example:      ````          &quot;transformations&quot;: {            &quot;amount&quot;: &quot;decimals&quot;,            &quot;tx_id&quot;:&quot;tx_id_colon&quot;          }      ````    ## License```textCopyright 2020 Keyko GmbH.Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);you may not use this file except in compliance with the License.You may obtain a copy of the License at   http://www.apache.org/licenses/LICENSE-2.0Unless required by applicable law or agreed to in writing, softwaredistributed under the License is distributed on an &quot;AS IS&quot; BASIS,WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.See the License for the specific language governing permissions andlimitations under the License.```</longdescription>
</pkgmetadata>