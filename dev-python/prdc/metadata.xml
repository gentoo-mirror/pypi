<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>## Reliable Fidelity and Diversity Metrics for Generative Models[Paper: Reliable Fidelity and Diversity Metrics for Generative Models](https://arxiv.org/abs/2002.09797)Muhammad Ferjad Naeem &lt;sup&gt;1,3*&lt;/sup&gt;, Seong Joon Oh&lt;sup&gt;2*&lt;/sup&gt;, Yunjey Choi&lt;sup&gt;1&lt;/sup&gt;, Youngjung Uh&lt;sup&gt;1&lt;/sup&gt;, Jaejun Yoo&lt;sup&gt;1,4&lt;/sup&gt;  &lt;sub&gt;**Work done at Clova AI Research**&lt;/sub&gt;&lt;sub&gt;\* Equal contribution&lt;/sub&gt;&lt;sup&gt;1&lt;/sup&gt; &lt;sub&gt;Clova AI Research, NAVER Corp.&lt;/sub&gt;&lt;sup&gt;2&lt;/sup&gt; &lt;sub&gt;Clova AI Research, LINE Plus Corp.&lt;/sub&gt;&lt;sup&gt;3&lt;/sup&gt; &lt;sub&gt;Technische Universit&amp;auml;t M&amp;uuml;nchen&lt;/sub&gt;&lt;sup&gt;4&lt;/sup&gt; &lt;sub&gt;EPFL&lt;/sub&gt;Devising indicative evaluation metrics for the image generation task remains an open problem.The most widely used metric for measuring the similarity between real and generated images has been the Fr&amp;eacute;chet Inception Distance (FID) score. Because it does not differentiate the _fidelity_ and _diversity_ aspects of the generated images, recent papers have introduced variants of precision and recall metrics to diagnose those properties separately.In this paper, we show that even the latest version of the precision and recall (Kynk&amp;auml;&amp;auml;nniemi et al., 2019) metrics are not reliable yet. For example, they fail to detect the match between two identical distributions, they are not robust against outliers, and the evaluation hyperparameters are selected arbitrarily. We propose **density and coverage** metrics that solve the above issues. We analytically and experimentally show that density and coverage provide more interpretable and reliable signals for practitioners than the existing metrics.## 1. Background### Precision and recall metricsPrecision and recall are defined below:&lt;a href=&quot;https://www.codecogs.com/eqnedit.php?latex=\fn_cm&amp;space;\text{precision}:=\frac{1}{M}\sum_{j=1}^{M}1_{Y_j\in\text{manifold}(X_1,\cdots,X_N)}&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://latex.codecogs.com/svg.latex?\fn_cm&amp;space;\text{precision}:=\frac{1}{M}\sum_{j=1}^{M}1_{Y_j\in\text{manifold}(X_1,\cdots,X_N)}&quot; title=&quot;\text{precision}:=\frac{1}{M}\sum_{j=1}^{M}1_{Y_j\in\text{manifold}(X_1,\cdots,X_N)}&quot; /&gt;&lt;/a&gt;&lt;a href=&quot;https://www.codecogs.com/eqnedit.php?latex=\fn_cm&amp;space;\text{recall}:=\frac{1}{N}\sum_{i=1}^{N}1_{X_i\in\text{manifold}(Y_1,\cdots,Y_M)}&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://latex.codecogs.com/svg.latex?\fn_cm&amp;space;\text{recall}:=\frac{1}{N}\sum_{i=1}^{N}1_{X_i\in\text{manifold}(Y_1,\cdots,Y_M)}&quot; title=&quot;\text{recall}:=\frac{1}{N}\sum_{i=1}^{N}1_{X_i\in\text{manifold}(Y_1,\cdots,Y_M)}&quot; /&gt;&lt;/a&gt;where the manifold is the defined as&lt;a href=&quot;https://www.codecogs.com/eqnedit.php?latex=\fn_cm&amp;space;\text{manifold}(X_1,\cdots,X_N):=&amp;space;\bigcup_{i=1}^{N}&amp;space;B(X_i,\text{NND}_k(X_i))&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://latex.codecogs.com/svg.latex?\fn_cm&amp;space;\text{manifold}(X_1,\cdots,X_N):=&amp;space;\bigcup_{i=1}^{N}&amp;space;B(X_i,\text{NND}_k(X_i))&quot; title=&quot;\text{manifold}(X_1,\cdots,X_N):= \bigcup_{i=1}^{N} B(X_i,\text{NND}_k(X_i))&quot; /&gt;&lt;/a&gt;&lt;a href=&quot;https://www.codecogs.com/eqnedit.php?latex=\inline&amp;space;\fn_cm&amp;space;B(x,r)&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://latex.codecogs.com/svg.latex?\inline&amp;space;\fn_cm&amp;space;B(x,r)&quot; title=&quot;B(x,r)&quot; /&gt;&lt;/a&gt; is the ball around the point `x` with radius `r`. &lt;a href=&quot;https://www.codecogs.com/eqnedit.php?latex=\inline&amp;space;\fn_cm&amp;space;\text{NND}_k(X_i)&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://latex.codecogs.com/svg.latex?\inline&amp;space;\fn_cm&amp;space;\text{NND}_k(X_i)&quot; title=&quot;\text{NND}_k(X_i)&quot; /&gt;&lt;/a&gt;is the distance to the kth-nearest neighbour. ### Density and coverage metricsDensity and coverage are defined below:&lt;a href=&quot;https://www.codecogs.com/eqnedit.php?latex=\fn_cm&amp;space;\text{density}:=\frac{1}{kM}\sum_{j=1}^{M}\sum_{i=1}^{N}1_{Y_j\in&amp;space;B(X_i,\text{NND}_k(X_i))}&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://latex.codecogs.com/svg.latex?\fn_cm&amp;space;\text{density}:=\frac{1}{kM}\sum_{j=1}^{M}\sum_{i=1}^{N}1_{Y_j\in&amp;space;B(X_i,\text{NND}_k(X_i))}&quot; title=&quot;\text{density}:=\frac{1}{kM}\sum_{j=1}^{M}\sum_{i=1}^{N}1_{Y_j\in B(X_i,\text{NND}_k(X_i))}&quot; /&gt;&lt;/a&gt;&lt;a href=&quot;https://www.codecogs.com/eqnedit.php?latex=\fn_cm&amp;space;\text{coverage}:=\frac{1}{N}\sum_{i=1}^{N}1_{\exists\text{&amp;space;}j\text{&amp;space;s.t.&amp;space;}&amp;space;Y_j\in&amp;space;B(X_i,\text{NND}_k(X_i))}&quot; target=&quot;_blank&quot;&gt;&lt;img src=&quot;https://latex.codecogs.com/svg.latex?\fn_cm&amp;space;\text{coverage}:=\frac{1}{N}\sum_{i=1}^{N}1_{\exists\text{&amp;space;}j\text{&amp;space;s.t.&amp;space;}&amp;space;Y_j\in&amp;space;B(X_i,\text{NND}_k(X_i))}&quot; title=&quot;\text{coverage}:=\frac{1}{N}\sum_{i=1}^{N}1_{\exists\text{ }j\text{ s.t. } Y_j\in B(X_i,\text{NND}_k(X_i))}&quot; /&gt;&lt;/a&gt;### Why are DC better than PR?&lt;p align=&quot;center&quot;&gt;  &lt;img src=&quot;https://github.com/clovaai/prdc/blob/master/figure/p_vs_d.png?raw=true&quot; alt=&quot;Precision versus density.&quot; width=&quot;500&quot;/&gt;&lt;/p&gt;**Precision versus Density.** Because of the real outlier sample, the manifold is overestimated. Generating many fake samples around the real outlier is enough to increase the precision measure. The problem of overestimating precision (100%) is resolved using the density estimate (60%). &lt;p align=&quot;center&quot;&gt;  &lt;img src=&quot;https://github.com/clovaai/prdc/blob/master/figure/r_vs_c.png?raw=true&quot; alt=&quot;Recall versus coverage.&quot; width=&quot;600&quot;/&gt;&lt;/p&gt;**Recall versus Coverage.** The real and fake samples are identical across left and right.Since models often generate many unrealistic yet diverse samples, the fake manifold is often an overestimation of the true fake distribution. In the figure above, while the fake samples are generally far from the modes in real samples, the recall measure is rewarded by the fact that real samples are contained in the overestimated fake manifold.## 2. Usage### Installation```bashpip3 install prdc```### ExampleTest 10000 real and fake samples form the standard normal distribution N(0,I) in 1000-dimensional Euclidean space.Set the nearest neighbour `k=5`. We compute precision, recall, density, and coverage estimates below.```pythonimport numpy as npfrom prdc import compute_prdcnum_real_samples = num_fake_samples = 10000feature_dim = 1000nearest_k = 5real_features = np.random.normal(loc=0.0, scale=1.0,                                 size=[num_real_samples, feature_dim])fake_features = np.random.normal(loc=0.0, scale=1.0,                                 size=[num_fake_samples, feature_dim])metrics = compute_prdc(real_features=real_features,                       fake_features=fake_features,                       nearest_k=nearest_k)print(metrics)```Above test code will result in the following estimates (may fluctuate due to randomness).```python{'precision': 0.4772, 'recall': 0.4705, 'density': 1.0555, 'coverage': 0.9735}```## 3. Miscellaneous### ReferencesKynk&amp;auml;&amp;auml;nniemi et al., 2019. Improved precision and recall metric for assessing generative models. Neurips 2019.### License```Copyright (c) 2020-present NAVER Corp.Permission is hereby granted, free of charge, to any person obtaining a copyof this software and associated documentation files (the &quot;Software&quot;), to dealin the Software without restriction, including without limitation the rightsto use, copy, modify, merge, publish, distribute, sublicense, and/or sellcopies of the Software, and to permit persons to whom the Software isfurnished to do so, subject to the following conditions:The above copyright notice and this permission notice shall be included inall copies or substantial portions of the Software.THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS ORIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THEAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHERLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS INTHE SOFTWARE.```### Cite this work```@article{ferjad2020ganeval,title = {Reliable Fidelity and Diversity Metrics for Generative Models},author = {Naeem, Muhammad Ferjad and Oh, Seong Joon and Uh, Youngjung and Choi, Yunjey and Yoo, Jaejun},year = {2020},journal = {arXiv},}```</longdescription>
</pkgmetadata>