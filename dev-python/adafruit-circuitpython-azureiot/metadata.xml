<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>Adafruit_CircuitPython_AzureIoT================================.. image:: https://readthedocs.org/projects/adafruit-circuitpython-azureiot/badge/?version=latest    :target: https://docs.circuitpython.org/projects/azureiot/en/latest/    :alt: Documentation Status.. image:: https://raw.githubusercontent.com/adafruit/Adafruit_CircuitPython_Bundle/main/badges/adafruit_discord.svg    :target: https://adafru.it/discord    :alt: Discord.. image:: https://github.com/adafruit/Adafruit_CircuitPython_AzureIoT/workflows/Build%20CI/badge.svg    :target: https://github.com/adafruit/Adafruit_CircuitPython_AzureIoT/actions/    :alt: Build Status.. image:: https://img.shields.io/badge/code%20style-black-000000.svg    :target: https://github.com/psf/black    :alt: Code Style: BlackA CircuitPython device library for `Microsoft Azure IoT Services &lt;https://azure.microsoft.com/overview/iot/?WT.mc_id=academic-3168-jabenn&gt;`_ from a CircuitPython device. This library only supports key-base authentication, it currently doesn't support X.509 certificates.Installing from PyPI=====================On supported GNU/Linux systems like the Raspberry Pi, you can install the driver locally `fromPyPI &lt;https://pypi.org/project/adafruit-circuitpython-azureiot/&gt;`_. To install for current user:.. code-block:: shell    pip3 install adafruit-circuitpython-azureiotTo install system-wide (this may be required in some cases):.. code-block:: shell    sudo pip3 install adafruit-circuitpython-azureiotTo install in a virtual environment in your current project:.. code-block:: shell    mkdir project-name &amp;&amp; cd project-name    python3 -m venv .venv    source .venv/bin/activate    pip3 install adafruit-circuitpython-azureiotDependencies=============This driver depends on:* `Adafruit CircuitPython &lt;https://github.com/adafruit/circuitpython&gt;`_* `Adafruit CircuitPython MiniMQTT &lt;https://github.com/adafruit/Adafruit_CircuitPython_MiniMQTT&gt;`_* `Adafruit CircuitPython Requests &lt;https://github.com/adafruit/Adafruit_CircuitPython_Requests&gt;`_* `Adafruit CircuitPython BinASCII &lt;https://github.com/adafruit/Adafruit_CircuitPython_Binascii&gt;`_* `Adafruit CircuitPython Logging &lt;https://github.com/adafruit/Adafruit_CircuitPython_Logging&gt;`_Please ensure all dependencies are available on the CircuitPython filesystem.This is easily achieved by downloading`the Adafruit library and driver bundle &lt;https://github.com/adafruit/Adafruit_CircuitPython_Bundle&gt;`_.**Board Compatibility:** The following built-in modules must be available: gc, json, ssl, timeUsage Example=============This library supports both `Azure IoT Hub &lt;https://azure.microsoft.com/services/iot-hub/?WT.mc_id=academic-3168-jabenn&gt;`_ and `Azure IoT Central &lt;https://azure.microsoft.com/services/iot-central/?WT.mc_id=academic-3168-jabenn&gt;`__.To create an Azure IoT Hub instance or an Azure IoT Central app, you will need an Azure subscription. If you don't have an Azure subscription, you can sign up for free:- If you are a student 18 or over, head to `aka.ms/FreeStudentAzure &lt;https://aka.ms/FreeStudentAzure&gt;`_ and sign up, validating with your student email address. This will give you $100 of Azure credit and free tiers of a load of service, renewable each year you are a student. You will not need a credit card.- If you are not a student, head to `aka.ms/FreeAz &lt;https://aka.ms/FreeAz&gt;`_ and sign up to get $200 of credit for 30 days, as well as free tiers of a load of services. You will need a credit card for validation only, your card will not be charged.ESP32 AirLift Networking========================To use this library, you will need to create an ESP32_SPI WifiManager, connected to WiFi. You will also need to set the current time, as this is used to generate time-based authentication keys. One way to do this is with the following code:.. code-block:: python    # get_time will raise ValueError if the time isn't available yet so loop until    # it works.    now_utc = None    while now_utc is None:        try:            now_utc = time.localtime(esp.get_time()[0])        except ValueError:            pass    rtc.RTC().datetime = now_utcNative Networking=================To use this library, with boards that have native networking support, you need to be connected to a network. You will also need to set the current time, as this is used to generate time-based authentication keys. One way to do this is the `Adafruit NTP library &lt;https://github.com/adafruit/Adafruit_CircuitPython_NTP&gt;`_ with the following code:.. code-block:: python    pool = socketpool.SocketPool(wifi.radio)    ntp = adafruit_ntp.NTP(pool, tz_offset=0)    # NOTE: This changes the system time so make sure you aren't assuming that time    # doesn't jump.    rtc.RTC().datetime = ntp.datetimeAzure IoT Hub-------------To interact with Azure IoT Hub, you will need to create a hub, and a register a device inside that hub. There is a free tier available, and this free tier allows up to 8,000 messages a day, so try not to send messages too often if you are using this tier.- Open the `Azure Portal &lt;https://aka.ms/AzurePortalHome&gt;`_.- Follow the instructions in `Microsoft Docs &lt;https://aka.ms/CreateIoTHub&gt;`_ to create an Azure IoT Hub and register a device.- Copy the devices Primary or secondary connection string, and add this to your ``secrets.py`` file.You can find the device connection string by selecting the IoT Hub in the `Azure Portal &lt;https://aka.ms/AzurePortalHome&gt;`_, *selecting Explorer -&gt; IoT devices*, then selecting your device... image:: iot-hub-device.png   :alt: Locating the device in the IoT hub blade*Locating the device in the IoT hub blade*Then copy either the primary or secondary connection string using the copy button next to the value... image:: iot-hub-device-keys.png   :alt: Copy the primary connection string*Copy the primary connection string***Connect your device to Azure IoT Hub**.. code-block:: python    from adafruit_azureiot import IoTHubDevice    device = IoTHubDevice(wifi, secrets[&quot;device_connection_string&quot;])    device.connect()Once the device is connected, you will regularly need to run a ``loop`` to poll for messages from the cloud... code-block:: python    while True:        device.loop()        time.sleep(1)**Send a device to cloud message**.. code-block:: python    message = {&quot;Temperature&quot;: temp}    device.send_device_to_cloud_message(json.dumps(message))**Receive device to cloud messages**.. code-block:: python    def cloud_to_device_message_received(body: str, properties: dict):        print(&quot;Received message with body&quot;, body, &quot;and properties&quot;, json.dumps(properties))    # Subscribe to cloud to device messages    device.on_cloud_to_device_message_received = cloud_to_device_message_received**Receive direct methods**.. code-block:: python    def direct_method_invoked(method_name: str, payload) -&gt; IoTResponse:        print(&quot;Received direct method&quot;, method_name, &quot;with data&quot;, str(payload))        # return a status code and message to indicate if the direct method was handled correctly        return IoTResponse(200, &quot;OK&quot;)    # Subscribe to direct methods    device.on_direct_method_invoked = direct_method_invoked**Update reported properties on the device twin***This is not supported on Basic tier IoT Hubs, only on the free and standard tiers.*.. code-block:: python    patch = {&quot;Temperature&quot;: temp}    device.update_twin(patch)**Subscribe to desired property changes on the device twin***This is not supported on Basic tier IoT Hubs, only on the free and standard tiers.*.. code-block:: python    def device_twin_desired_updated(desired_property_name: str, desired_property_value, desired_version: int):        print(&quot;Property&quot;, desired_property_name, &quot;updated to&quot;, str(desired_property_value), &quot;version&quot;, desired_version)    # Subscribe to desired property changes    device.on_device_twin_desired_updated = device_twin_desired_updatedAzure IoT Central-----------------To use Azure IoT Central, you will need to create an Azure IoT Central app, create a device template and register a device against the template.- Head to `Azure IoT Central &lt;https://apps.azureiotcentral.com/?WT.mc_id=academic-3168-jabenn&gt;`__- Follow the instructions in the `Microsoft Docs &lt;https://docs.microsoft.com/azure/iot-central/core/quick-deploy-iot-central?WT.mc_id=academic-3168-jabenn&gt;`__ to create an application. Every tier is free for up to 2 devices.- Follow the instructions in the `Microsoft Docs &lt;https://docs.microsoft.com/azure/iot-central/core/quick-create-simulated-device?WT.mc_id=academic-3168-jabenn&gt;`__ to create a device template.- Create a device based off the template, and select **Connect** to get the device connection details. Store the ID Scope, Device ID and either the primary or secondary device SAS key in your ``secrets.py`` file... image:: iot-central-connect-button.png   :alt: The IoT Central connect button*The connect button*.. image:: iot-central-connect-dialog.png   :alt: The IoT Central connection details dialog*The connection details dialog*.. code-block:: python    secrets = {        # WiFi settings        &quot;ssid&quot;: &quot;&quot;,        &quot;password&quot;: &quot;&quot;,        # Azure IoT Central settings        &quot;id_scope&quot;: &quot;&quot;,        &quot;device_id&quot;: &quot;&quot;,        &quot;device_sas_key&quot;: &quot;&quot;    }**Connect your device to your Azure IoT Central app**.. code-block:: python    from adafruit_azureiot import IoTCentralDevice    device = IoTCentralDevice(wifi, secrets[&quot;id_scope&quot;], secrets[&quot;device_id&quot;], secrets[&quot;device_sas_key&quot;])    device.connect()Once the device is connected, you will regularly need to run a ``loop`` to poll for messages from the cloud... code-block:: python    while True:        device.loop()        time.sleep(1)**Send telemetry**.. code-block:: python    message = {&quot;Temperature&quot;: temp}    device.send_telemetry(json.dumps(message))**Listen for commands**.. code-block:: python    def command_executed(command_name: str, payload) -&gt; IoTResponse:        print(&quot;Command&quot;, command_name, &quot;executed with payload&quot;, str(payload))        # return a status code and message to indicate if the command was handled correctly        return IoTResponse(200, &quot;OK&quot;)    # Subscribe to commands    device.on_command_executed = command_executed**Update properties**.. code-block:: python    device.send_property(&quot;Desired_Temperature&quot;, temp)**Listen for property updates**.. code-block:: python    def property_changed(property_name, property_value, version):        print(&quot;Property&quot;, property_name, &quot;updated to&quot;, str(property_value), &quot;version&quot;, str(version))    # Subscribe to property updates    device.on_property_changed = property_changedLearning more about Azure IoT services--------------------------------------If you want to learn more about setting up or using Azure IoT Services, check out the following resources:- `Azure IoT documentation on Microsoft Docs &lt;https://docs.microsoft.com/azure/iot-fundamentals/?WT.mc_id=academic-3168-jabenn&gt;`_- `IoT learning paths and modules on Microsoft Learn &lt;https://docs.microsoft.com/learn/browse/?term=iot&amp;WT.mc_id=academic-3168-jabenn&gt;`_ - Free, online, self-guided hands on learning with Azure IoT servicesDocumentation=============API documentation for this library can be found on `Read the Docs &lt;https://docs.circuitpython.org/projects/azureiot/en/latest/&gt;`_.For information on building library documentation, please check out `this guide &lt;https://learn.adafruit.com/creating-and-sharing-a-circuitpython-library/sharing-our-docs-on-readthedocs#sphinx-5-1&gt;`_.Contributing============Contributions are welcome! Please read our `Code of Conduct&lt;https://github.com/adafruit/Adafruit_CircuitPython_AzureIoT/blob/main/CODE_OF_CONDUCT.md&gt;`_before contributing to help this project stay welcoming.</longdescription>
</pkgmetadata>