<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># widgetsMerging code and data in webpages[![Build Python package](https://github.com/FredHutch/widgets/actions/workflows/package.yaml/badge.svg)](https://github.com/FredHutch/widgets/actions/workflows/package.yaml)[![Test Coverage](https://github.com/FredHutch/widgets/actions/workflows/lint.yaml/badge.svg)](https://github.com/FredHutch/widgets/actions/workflows/lint.yaml)## PurposeWhile the technical skills required for visualizing data have become vastly moreaccessible in recent years, there are still a large number of people who would liketo be able to easily visualize their data without the need for writing any codewhatsoever.To provide a no-code data visualization experience, we introduce &quot;widgets&quot; - aflexible framework for merging data and code into a single standalone file whichcan be rendered by a modern web browser into a wide array of data visualizations.## How Widgets WorkLet's say that you're using a widget which is used to make volcano plots (acommonly-used way to show which genes are expressed differently in two groupsof samples, for example).When you open the widget, it loads directly in your web browser.You don't need to install anything on your computer in order to open it.The volcano plot widget needs a table of data to display, which you can uploadas a CSV or Excel spreadsheet.Once you've uploaded your data and customized your plot, you can now downloada new copy of that widget _which has your data embedded in it_.That new version of the widget will be an HTML file, which means that it canbe opened in a web browser.When you open up that copy of the widget, your data will load directly and bedisplayed in the same way as when you downloaded the copy.Another way of thinking about widgets is that they are a way of taking your dataand embedding them directly into a customized visualization which can be openedon any computer.## How to Make a New WidgetTo create your own widget, simply make a Python script which defines thebehavior of the widget, including the data provided by users, the Pythonpackages that it requires, and the visualization which will be displayed.The interactivity of the widget shown below is based on the [Streamlit](https://streamlit.io/)library.Streamlit [provides support for Matplotlib, Plotly, Bokeh, Altair, and other plotting libraries](https://docs.streamlit.io/),as well as flexible user inputs.An example widget is shown below:```#!/usr/bin/env python3# Give the widget a descriptive nameclass SimpleWidget(StreamlitWidget):    # This app will prompt the user to provide a set of inputs,    # one DataFrame (which can be provided as CSV), and    # strings indicating which columns to plot.    # The list of resources will be wrapped in an expand/collapse    # element, which starts off as being expanded by default.    children = [        StExpander(            id='options_expander',            label='Options',            expanded=True,            children=[                StDataFrame(                    id=&quot;df&quot;,                    value=pd.DataFrame(dict(x=[], y=[], label=[])),                    label=&quot;Test CSV&quot;,                ),                StSelectString(                    id=&quot;x_col&quot;,                    label=&quot;X-axis Column&quot;                ),                StString(                    id=&quot;x_label&quot;,                    label=&quot;X-axis Label&quot;,                    value=&quot;x-axis&quot;                ),                StSelectString(                    id=&quot;y_col&quot;,                    label=&quot;Y-axis Column&quot;                ),                StString(                    id=&quot;y_label&quot;,                    label=&quot;Y-axis Label&quot;,                    value=&quot;y-axis&quot;                )            ]        )    ]    # The updated values for each of these resources can be accessed    # and modified using the .get() and .set() functions    # For example:    #   self.get(path=[&quot;x_col&quot;]) -&gt; &quot;x&quot;    #   or    #   self.set(path=[&quot;x_col&quot;], value=&quot;new_value&quot;)    # Additionally, self.all_values() creates a dict with the values    # for all of the resources.    # The attributes of the resources can also be modified, using the    # .set() and .get() functions.    # For example, to update the options displayed for the x_col menu:    #   self.set(path=[&quot;x_col&quot;], attr=&quot;options&quot;, value=[&quot;x&quot;, &quot;y&quot;, &quot;label&quot;])    # Specify any packages which should be installed prior to loading    requirements = [        &quot;pandas&quot;,        &quot;plotly&quot;    ]    # Specify any inputs statements which are needed by the widget    # beyond the following (which will be executed by default):    # import streamlit as st    # from widgets.streamlit import *    extra_imports = [        &quot;import pandas as pd&quot;,        &quot;import plotly.express as px&quot;    ]    # The visualization defined in the viz function will be run and    # updated every time a user changes the inputs, showing a simple    # scatterplot.    def run_self(self):        # Get the updated DataFrame from the UI        df = self.get(path=[&quot;options_expander&quot;, &quot;df&quot;])        # If a table has been uploaded        if df is not None and df.shape[0] &gt; 0:            # Update the options for the x_col, y_col, and label_col variables            self.update_options(df.columns.values)            # After making that update, get the complete set of values            # It is a nuance of streamlit that this object will not be            # updated appropriately if called before .update_options()            vals = self.all_values(path=[&quot;options_expander&quot;])            # Make a plot            fig = px.scatter(                data_frame=df,                x=vals[&quot;x_col&quot;],                y=vals[&quot;y_col&quot;],                hover_data=df.columns.values,                labels={                    vals[&quot;x_col&quot;]: vals[&quot;x_label&quot;],                    vals[&quot;y_col&quot;]: vals[&quot;y_label&quot;]                }            )            # Display the plot            st.plotly_chart(fig)        # If no table has been uploaded        else:            # Print a simple message to the user            st.write(&quot;Please provide data to plot&quot;)        self.download_html_button()        self.download_script_button()    # Custom methods can be defined for the widget    def update_options(self, options):        &quot;&quot;&quot;Update the options displayed for each of the column menus.&quot;&quot;&quot;        # For each of the resources        for resource_id in [&quot;x_col&quot;, &quot;y_col&quot;]:            # Update the options attribute of the resource            self.set(                path=[&quot;options_expander&quot;, resource_id],                attr=&quot;options&quot;,                value=list(options)            )```### Developing Widgets Safely**Extremely Important:**When you execute any command on a file containing code (e.g. runninga widget or converting it to HTML), that code *will be run on your computer*.Do not run any file that contains code which you do not trust.### Local TestingTo test the widget locally (before converting to HTML), installthe `widgets` library (`pip3 install widgets-lib`) and run:```#!/bin/bash# Where app.py is the file containing the code for SimpleWidgetwidgets run app.py SimpleWidget```When you edit the file `app.py`, the interactive display in yourweb browser will give you the option to update with those changes.This auto-update functionality (provided by Streamlit) makes it easyto quickly tweak your code until it meets your needs.### Create HTMLAfter testing locally, the widget code can be converted to an HTMLfile.To create that file, you must specify both the file containing thecode (in this case `app.py`) as well as the name of the widget whichyou defined (in this case `SimpleWidget`).```#!/bin/bash# To create a file called widget.htmlwidgets tohtml app.py SimpleWidget# The complete list of options provided can be seen withwidgets tohtml --help```## Under the HoodThe widgets created using this software library are only possibledue to the advances which have been make in running Python withinweb browsers (IE, Chrome, Firefox, Safari, etc.) via the[Pyodide project](https://pyodide.org/).While Python is an amazingly popular and powerful programminglanguage, it still requires a basic familiarity with softwaredevelopment which requires time and energy to develop.Being able to run Python in the web browser opens up a wholenew world of opportunity for delivering software to an evenwider audience of users.Special thanks goes to [Yuichiro Tachibana](https://github.com/whitphx),who created an adapter which allows Streamlit-based apps to runvia Pyodide.While the `widgets` concept is not unique to Streamlit, thishas provided the initial implementation which is enormouslyuseful.When you open a widget in the web browser, the first step isfor Pyodide to load and install all of the packages which areneeded.This can be a time-consuming process, and so you should expectwidgets to load extremely slowly when you first open them.The loading process will hopefully speed up over time, butyou should definitely tell users to expect slow load times.</longdescription>
</pkgmetadata>