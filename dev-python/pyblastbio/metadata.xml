<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>![](https://github.com/jvrana/pyblast/workflows/Python%package/badge.svg)[![Coverage Status](https://coveralls.io/repos/github/jvrana/pyblast/badge.svg?branch=master)](https://coveralls.io/github/jvrana/pyblast?branch=master)[![PyPI version](https://badge.fury.io/py/pyblastbio.svg)](https://badge.fury.io/py/pyblastbio)![Build package](https://github.com/jvrana/pyblast2/workflows/Build%20package/badge.svg)# pyblastThis is a wrapper for other applications to run blast searches on SeqRecord objects and JSON objects. Intended tobe used in small python applications.Features include:* Automatic BLAST parsing to JSON* Alignment to circular queries, using either linear or circular subjects* Blast self installation# InstallationYou can install BLAST to the pyblast directory using the following command:```pyblast install```This will install it to pyblast/blast_bin in your python install location. If you want BLAST installed somewhere else, move the *ncbi-blast-X.X.X+* folderto your desired location and add *path/to/ncbi-blast-X.X.X+/bin* to you $PATH. **PyBlast** will prefer to use the blast storedin your executable path. If it cannot find a blast executable there, it looks for it in that paths in the pyblast/blast_bin/_paths.txt.file. _paths.txt is automatically updated when you run install_blast.py so theres no need to manage the paths manually.After installing and verifying the `blastn` command works from the cmd line,```pip install pyblastbio```## UsageThis package is a python wrapper for the BLAST command line, intended to be run along with a microservice (e.g. Flask) or for a quick alignment in a jupyter notebook or small python script/app.This package also includes a basic python-based installation script which is used in unit-testing.### Running a blast query on a Bio.SeqRecord objectWe can do a quick alignment to some sequences using the following, which gives us a nice dictionary of the results:```pythonfrom pyblast import BioBlastfrom pyblast.utils import make_linear, make_circularfrom Bio.SeqRecord import SeqRecordfrom Bio.Seq import Seqqueries = [  SeqRecord(Seq(&quot;ACGTGATTCGTCGTGTAGTTGAGTGTTACGTTGCATGTCGTACGTGTGTAGTGTCGTGTAGTGCTGATGCTACGTGATCG&quot;))]subjects = [  SeqRecord(Seq(&quot;ACGTGATTCGTCGTGTAGTTGAGTGTTACGTTGCATGTCGTTACGTGATCG&quot;))]# pyblast requires a 'topology' annotation on the SeqRecords.# we can make records circular or linear using `make_linear` or `make_circular` methodssubjects = make_linear(subjects)queries = make_linear(queries)blast = BioBlast(subjects, queries)results = blast.quick_blastn()print(results)``````json[  {    &quot;query&quot;: {      &quot;start&quot;: 1,      &quot;end&quot;: 46,      &quot;bases&quot;: &quot;ACGTGATTCGTCGTGTAGTTGAGTGTTACGTTGCATGTCGT-ACGTG&quot;,      &quot;strand&quot;: 1,      &quot;length&quot;: 80,      &quot;sequence_id&quot;: &quot;11e17df2-579f-4234-a1e6-f4e3fadfe277&quot;,      &quot;circular&quot;: false,      &quot;name&quot;: &quot;&lt;unknown name&gt;&quot;,      &quot;origin_key&quot;: &quot;bbadd55c-9413-4394-a23c-0da983630b98&quot;,      &quot;origin_record_id&quot;: &quot;&lt;unknown id&gt;&quot;,      &quot;origin_sequence_length&quot;: 80    },    &quot;subject&quot;: {      &quot;start&quot;: 1,      &quot;end&quot;: 47,      &quot;bases&quot;: &quot;ACGTGATTCGTCGTGTAGTTGAGTGTTACGTTGCATGTCGTTACGTG&quot;,      &quot;strand&quot;: 1,      &quot;length&quot;: 51,      &quot;sequence_id&quot;: &quot;69248d23-1044-4a75-80c9-53b999796d48&quot;,      &quot;circular&quot;: false,      &quot;name&quot;: &quot;&lt;unknown name&gt;&quot;,      &quot;origin_key&quot;: &quot;1f627d51-93df-458b-ba36-9b5a7b483a4d&quot;,      &quot;origin_record_id&quot;: &quot;&lt;unknown id&gt;&quot;,      &quot;origin_sequence_length&quot;: 51    },    &quot;meta&quot;: {      &quot;query acc.&quot;: &quot;11e17df2-579f-4234-a1e6-f4e3fadfe277&quot;,      &quot;subject acc.&quot;: &quot;69248d23-1044-4a75-80c9-53b999796d48&quot;,      &quot;score&quot;: 43,      &quot;evalue&quot;: 0,      &quot;bit score&quot;: 80,      &quot;alignment length&quot;: 47,      &quot;identical&quot;: 46,      &quot;gap opens&quot;: 1,      &quot;gaps&quot;: 1,      &quot;query length&quot;: 80,      &quot;q. start&quot;: 1,      &quot;q. end&quot;: 46,      &quot;subject length&quot;: 51,      &quot;s. start&quot;: 1,      &quot;s. end&quot;: 47,      &quot;subject strand&quot;: &quot;plus&quot;,      &quot;query seq&quot;: &quot;ACGTGATTCGTCGTGTAGTTGAGTGTTACGTTGCATGTCGT-ACGTG&quot;,      &quot;subject seq&quot;: &quot;ACGTGATTCGTCGTGTAGTTGAGTGTTACGTTGCATGTCGTTACGTG&quot;,      &quot;span_origin&quot;: true    }  }]```### Running blast on circular subjects and queriesPyblast handles alignments to circular subjects and queries as well. As you can see below, we get a complete alignment of the subject (1 to 50) to the circular query (82 over origin to 30). Circular subjects and circular queries can be mixed together, as well as multiple queries.```seq = &quot;ACGTTGTAGTGTAGTTGATGATGATGTCTGTGTCGTGTGATGTGCTGTAGTGTTTAGGGGCGGCGCGGAGTATGCTG&quot;queries = [SeqRecord(Seq(seq))]subjects = [SeqRecord(Seq(seq[-20:] + seq[:30]))]# pyblast requires a 'topology' annotation on the SeqRecords.# we can make records circular or linear using `make_linear` or `make_circular` methodssubjects = make_circular(subjects)queries = make_circular(queries)blast = BioBlast(subjects, queries)results = blast.quick_blastn()print(results)``````json[  {    &quot;query&quot;: {      &quot;start&quot;: 82,      &quot;end&quot;: 30,      &quot;strand&quot;: 1,      &quot;...&quot;: &quot;...&quot;    },    &quot;subject&quot;: {      &quot;start&quot;: 1,      &quot;end&quot;: 50,      &quot;strand&quot;: 1,      &quot;...&quot;: &quot;...&quot;    },    &quot;meta&quot;: {    &quot;...&quot;: &quot;...&quot;    }]```### BioBlastFactoryIn some cases, we will want to share the same sequences for different types of alignments. For example, we may want to align a set of primers and a set of templates to the same query records. In these types of cases, we can use the **BioBlastFactory**:```pythonfrom pyblast import BioBlastFactory# initialize a new factoryfactory = BioBlastFactory()# add records accessible by keywordfactory.add_records(records1, &quot;primers&quot;)factory.add_records(records2, &quot;templates&quot;)factory.add_records(records3, &quot;queries&quot;)# we spawn new BioBlast alignmers from the keywords aboveprimer_alignment = factory(&quot;primers&quot;, &quot;queries&quot;)template_alignment = factory(&quot;templates&quot;, &quot;queries&quot;)# we can then run alignments, ensuring the queries in both results# refer to the exact same queryprimer_results = primer_alignment.quick_short_blastn()template_results = template_alignment.quick_blastn()```### Utilities for reading files**pyblast** includes utilities for reading in *fasta* and *genbank* files.```pythonfrom pyblast.utils import load_glob, load_genbank_glob, load_fasta_glob# load many genbank files into a list of SeqRecords# 'topology' is automatically detected here# we enforce all record_ids to be unique (a requirement for pyblast)records1 = load_genbank_glob(&quot;~/mydesigns/*.gb&quot;, force_unique_ids=True)# load many fasta files into a list of SeqRecords# 'topology' is NOT detected# we enforce all record_ids to be unique (a requirement for pyblast)records2 = make_linear(load_fasta_glob(&quot;~/mydesigns/*.fasta&quot;), force_unique_ids=True)```</longdescription>
</pkgmetadata>