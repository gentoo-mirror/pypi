<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Utility bill scraper[![build](https://github.com/ryanfobel/utility-bill-scraper/actions/workflows/build.yml/badge.svg?branch=main)](https://github.com/ryanfobel/utility-bill-scraper/actions/workflows/build.yml)[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/ryanfobel/utility-bill-scraper/main)[![PyPI version shields.io](https://img.shields.io/pypi/v/utility-bill-scraper.svg)](https://pypi.python.org/pypi/utility-bill-scraper/)Download energy usage data and estimate CO&lt;sub&gt;2&lt;/sub&gt; emissions from utility websites or pdf bills.## What is this?The science is clear — global temperatures are rising and we need to drastically reduce our use of fossil fuels if we want to keep our planet habitable for future generations. Many governments around the world are declaring [climate emergencies](https://qz.com/1786781/which-cities-have-declared-climate-emergencies/) and are setting ambitious targets to reduce emissions (e.g., [net zero by 2050](https://www.ipcc.ch/sr15/), [50% reduction by 2030](https://www.npr.org/2021/04/16/987667828/how-the-u-s-could-halve-climate-emissions-by-2030)). While broad systemic changes are clearly required, individual action is also important. For those living in the [Global North](https://en.wikipedia.org/wiki/Global_North_and_Global_South), the majority of fossil-fuel emissions arise from heating/cooling our homes, using electricity, transportation, and the food we eat. It's obvious that we need to rapidly transition off fossil fuels, which will require (1) **clear targets**, (2) **a plan to achieve them**, and (3) **tools for measuring progress**.There are [many](https://app.projectneutral.org/) [existing](https://coolclimate.berkeley.edu/calculator) [carbon](https://www.nature.org/en-us/get-involved/how-to-help/carbon-footprint-calculator/) [footprint](https://www.carbonfootprint.com/calculator.aspx) [calculators](https://www3.epa.gov/carbon-footprint-calculator/), but they often require manual data entry, leading most people to try them once to get a static snapshot at a point in time. While useful for gaining a high-level understanding of your personal emission sources, it would be much better if this footprint could be automatically updated over time to provide people with **feedback** on the impact of their actions. This project aims to do just that — to assist individuals with collecting data from utility companies (e.g., electricity and natural gas) by automatically downloading their data and converting usage into CO&lt;sub&gt;2&lt;/sub&gt; emissions.![monthly_co2_emissions](https://raw.githubusercontent.com/ryanfobel/utility-bill-scraper/main/notebooks/canada/on/images/monthly_co2_emissions_natural_gas.png)&lt;!-- START doctoc generated TOC please keep comment here to allow auto update --&gt;&lt;!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE --&gt;## Table of contents- [Supported utilities](#supported-utilities)- [Install](#install)- [Data storage](#data-storage)- [Getting and plotting data using the Python API](#getting-and-plotting-data-using-the-python-api)  - [Update data](#update-data)  - [Plot monthly gas consumption](#plot-monthly-gas-consumption)  - [Convert gas consumption to CO&lt;sub&gt;2&lt;/sub&gt; emissions](#convert-gas-consumption-to-cosub2sub-emissions)  - [Plot Annual CO&lt;sub&gt;2&lt;/sub&gt; emissions](#plot-annual-cosub2sub-emissions)- [Command line utilities](#command-line-utilities)  - [Update data](#update-data-1)  - [Export data](#export-data)  - [Options](#options)  - [Environment variables](#environment-variables)- [Contributors](#contributors)&lt;!-- END doctoc generated TOC please keep comment here to allow auto update --&gt;## Supported utilitiesThe simplest way to get started is to click on one of the following links, which will open a session on https://mybinder.org where you can try downloading some data. **Note: after you click on the link, it will take a couple of minutes to load an interactive Jupyter notebook.** Then follow the instructions (e.g., provide your `username` and `password`) to run the notebook directly from your browser. * [Kitchener Utilities (gas &amp; water)](https://mybinder.org/v2/gh/ryanfobel/utility-bill-scraper/main?labpath=notebooks%2Fcanada%2Fon%2Fkitchener_utilities.ipynb) * [Kitchener-Wilmot Hydro](https://mybinder.org/v2/gh/ryanfobel/utility-bill-scraper/main?labpath=notebooks%2Fcanada%2Fon%2Fkitchener_wilmot_hydro.ipynb) ## Install```shpip install utility-bill-scraper```## Data storageAll data is stored in a file located at `$DATA_PATH/$UTILITY_NAME/monthly.csv`. The path to this file can be set as input argument when initializing an API object via the `data_path` argument.```└───data    └───Kitchener Utilities        └───monthly.csv        └───statements            │───2021-10-18 - Kitchener Utilities - $102.30.pdf            ...            └───2021-06-15 - Kitchener Utilities - $84.51.pdf```## Getting and plotting data using the Python API### Update data```pythonimport utility_bill_scraper.canada.on.kitchener_utilities as kuapi = ku.KitchenerUtilitiesAPI(username='username', password='password')# Get new statements.updates = api.update()if updates is not None:    print(f&quot;{ len(updates) } statements_downloaded&quot;)api.history(&quot;monthly&quot;).tail()```![history tail](https://raw.githubusercontent.com/ryanfobel/utility-bill-scraper/main/notebooks/canada/on/images/history_tail.png)### Plot monthly gas consumption```pythonimport matplotlib.pyplot as pltdf = ku_api.history(&quot;monthly&quot;)plt.figure()plt.bar(df.index, df[&quot;Gas Consumption&quot;], width=0.9, alpha=0.5)plt.xticks(rotation=90)plt.title(&quot;Monthly Gas Consumption&quot;)plt.ylabel(&quot;m$^3$&quot;)```![monthly gas consumption](https://raw.githubusercontent.com/ryanfobel/utility-bill-scraper/main/notebooks/canada/on/images/monthly_gas_consumption.png)### Convert gas consumption to CO&lt;sub&gt;2&lt;/sub&gt; emissions```pythonfrom utility_bill_scraper import GAS_KGCO2_PER_CUBIC_METERdf[&quot;kgCO2&quot;] = df[&quot;Gas Consumption&quot;] * GAS_KGCO2_PER_CUBIC_METER```### Plot Annual CO&lt;sub&gt;2&lt;/sub&gt; emissions```pythonfrom utility_bill_scraper import GAS_KGCO2_PER_CUBIC_METERdf[&quot;kgCO2&quot;] = df[&quot;Gas Consumption&quot;] * GAS_KGCO2_PER_CUBIC_METERdf[&quot;year&quot;] = [int(x[0:4]) for x in df.index]df[&quot;month&quot;] = [int(x[5:7]) for x in df.index]plt.figure()df.groupby(&quot;year&quot;).sum()[&quot;Gas Consumption&quot;].plot.bar(width=bin_width, alpha=alpha)plt.ylabel(&quot;m$^3$&quot;)ylim = plt.ylim()ax = plt.gca()ax2 = ax.twinx()plt.ylabel(&quot;tCO$_2$e&quot;)plt.ylim([GAS_KGCO2_PER_CUBIC_METER * y / 1e3 for y in ylim])plt.title(&quot;Annual CO$_2$e emissions from natural gas&quot;)```![annual co2_emissions](https://raw.githubusercontent.com/ryanfobel/utility-bill-scraper/main/notebooks/canada/on/images/annual_co2_emissions_natural_gas.png)## Command line utilitiesUpdate and export your utility data from the command line.### Update data```sh&gt; ubs --utilty-name &quot;Kitchener Utilities&quot; update --user $USER --password $PASSWORD```### Export data```sh&gt; ubs --utilty-name &quot;Kitchener Utilities&quot; export --output monthly.csv```### Options```sh&gt; ubs --helpusage: ubs [-h] [-e ENV] [--data-path DATA_PATH] [--utility-name UTILITY_NAME]              [--google-sa-credentials GOOGLE_SA_CREDENTIALS]              {update,export} ...ubs (Utility bill scraper)optional arguments:  -h, --help            show this help message and exit  -e ENV, --env ENV     path to .env file  --data-path DATA_PATH                        folder containing the data file and statements  --utility-name UTILITY_NAME                        name of the utility  --google-sa-credentials GOOGLE_SA_CREDENTIALS                        google service account credentialssubcommands:  {update,export}       available sub-commands```### Environment variablesNote that many options can be set via environment variables (useful for continuous integration and/or working with containers). The following can be set in your shell or via a `.env` file passed using the `-e` option.```shDATA_PATH=&quot;folder containing the data file and statements&quot;UTILITY_NAME=&quot;name of the utility&quot;GOOGLE_SA_CREDENTIALS=&quot;google service account credentials&quot;USER=&quot;username&quot;PASSWORD=&quot;password&quot;SAVE_STATEMENTS=&quot;save downloaded statements (default=True)&quot;MAX_DOWNLOADS=&quot;maximum number of statements to download&quot;```## Contributors* Ryan Fobel ([@ryanfobel](https://github.com/ryanfobel))</longdescription>
</pkgmetadata>