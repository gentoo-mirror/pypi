<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>[![PyPI - Version](https://img.shields.io/pypi/v/nextline-graphql.svg)](https://pypi.org/project/nextline-graphql)[![PyPI - Python Version](https://img.shields.io/pypi/pyversions/nextline-graphql.svg)](https://pypi.org/project/nextline-graphql)[![Test Status](https://github.com/simonsobs/nextline-graphql/actions/workflows/unit-test.yml/badge.svg)](https://github.com/simonsobs/nextline-graphql/actions/workflows/unit-test.yml)[![Test Status](https://github.com/simonsobs/nextline-graphql/actions/workflows/unit-test-dev.yml/badge.svg)](https://github.com/simonsobs/nextline-graphql/actions/workflows/unit-test.yml)[![Test Status](https://github.com/simonsobs/nextline-graphql/actions/workflows/type-check.yml/badge.svg)](https://github.com/simonsobs/nextline-graphql/actions/workflows/type-check.yml)[![codecov](https://codecov.io/gh/simonsobs/nextline-graphql/branch/main/graph/badge.svg)](https://codecov.io/gh/simonsobs/nextline-graphql)# nextline-graphqlA GraphQL API for Nextline_Nextline_ allows line-by-line execution of concurrent Python scripts bymultiple users simultaneously from web browsers. Nextline is being developed asa DAQ sequencer of the [Observatory Control System(OCS)](https://github.com/simonsobs/ocs/).## Packages- [**nextline:**](https://github.com/simonsobs/nextline) (Python) the core functionality. imported in _nextline-graphql._- [**nextline-graphql:**](https://github.com/simonsobs/nextline-graphql) (Python) this package. the GraphQL API- [**nextline-web:**](https://github.com/simonsobs/nextline-web) (JavaScript) the client website## How to run the Nextline GraphQL APIThe section shows how to run the Nextline GraphQL API server. How to run theclient website will be described[elsewhere](https://github.com/simonsobs/nextline-web).### As a Docker containerDocker images of the Nextline GraphQL API server are created as[ghcr.io/simonsobs/nextline-graphql](https://github.com/simonsobs/nextline-graphql/pkgs/container/nextline-graphql).These images are created by the[Dockerfile](https://github.com/simonsobs/nextline-graphql/blob/main/Dockerfile).Use, for example, the following command to run as a Docker container.```bashdocker run -p 8080:8000 ghcr.io/simonsobs/nextline-graphql```If you access to the API server with a web browser, you will see the GraphQL IDE: &lt;http://localhost:8080/&gt;.### With a persistent DBNextline-graphql stores the execution history and other information in the DB.It uses [SQLAlchemy](https://www.sqlalchemy.org/), with, by default, a [SQLitein-memory database](https://www.sqlite.org/inmemorydb.html).#### An environment variable in the containerThe container has one environment variable, which is to change the [DB URL](https://docs.sqlalchemy.org/en/14/core/engines.html#database-urls) of SQLAlchemy.| Environment variable | Default value                                | Description                                                                                   || -------------------- | -------------------------------------------- | --------------------------------------------------------------------------------------------- || `NEXTLINE_DB__URL`   | `sqlite:///:memory:?check_same_thread=false` | The [DB URL](https://docs.sqlalchemy.org/en/14/core/engines.html#database-urls) of SQLAlchemy |For example, the following command uses a file on the host machine`db/db.sqlite3` as the persistent DB. The directory `db/` and the file`db.sqlite3` will be created if they don't exist.```bashdocker run -p 8080:8000 --env NEXTLINE_DB__URL='sqlite:////db/db.sqlite3' -v &quot;$(pwd)/db:/db&quot; ghcr.io/simonsobs/nextline-graphql```### from PyPIIt is also possible to install with pip and run.```bashpip install nextline-graphqluvicorn --lifespan on --factory --port 8080 nextlinegraphql:create_app```The environment variable `NEXTLINE_DB__URL` mentioned above can be used tospecify the SQLAlchemy DB URL.Check with a web browser at &lt;http://localhost:8080/&gt;.## Check out code for developmentThis section shows an example way to check out code from GitHub for development.```bashpython -m venv venvsource venv/bin/activategit clone git@github.com:simonsobs/nextline.gitgit clone git@github.com:simonsobs/nextline-graphql.gitpip install -e ./nextline/&quot;[tests,dev]&quot;pip install -e ./nextline-graphql/&quot;[tests,dev]&quot;```To run```bashuvicorn --port 8080 --lifespan on --factory --reload --reload-dir nextline-graphql --reload-dir nextline nextlinegraphql:create_app```---## License- _Nextline_ is licensed under the MIT license.---## Contact- [Tai Sakuma](https://github.com/TaiSakuma) &lt;span itemscope itemtype=&quot;https://schema.org/Person&quot;&gt;&lt;a itemprop=&quot;sameAs&quot; content=&quot;https://orcid.org/0000-0003-3225-9861&quot; href=&quot;https://orcid.org/0000-0003-3225-9861&quot; target=&quot;orcid.widget&quot; rel=&quot;me noopener noreferrer&quot; style=&quot;vertical-align:text-top;&quot;&gt;&lt;img src=&quot;https://orcid.org/sites/default/files/images/orcid_16x16.png&quot; style=&quot;width:1em;margin-right:.5em;&quot; alt=&quot;ORCID iD icon&quot;&gt;&lt;/a&gt;&lt;/span&gt;</longdescription>
</pkgmetadata>