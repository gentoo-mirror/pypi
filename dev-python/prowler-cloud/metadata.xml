<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>&lt;p align=&quot;center&quot;&gt;  &lt;img align=&quot;center&quot; src=&quot;https://github.com/prowler-cloud/prowler/blob/62c1ce73bbcdd6b9e5ba03dfcae26dfd165defd9/docs/img/prowler-pro-dark.png?raw=True#gh-dark-mode-only&quot; width=&quot;150&quot; height=&quot;36&quot;&gt;  &lt;img align=&quot;center&quot; src=&quot;https://github.com/prowler-cloud/prowler/blob/62c1ce73bbcdd6b9e5ba03dfcae26dfd165defd9/docs/img/prowler-pro-light.png?raw=True#gh-light-mode-only&quot; width=&quot;15%&quot; height=&quot;15%&quot;&gt;&lt;/p&gt;&lt;p align=&quot;center&quot;&gt;  &lt;b&gt;&lt;i&gt;See all the things you and your team can do with ProwlerPro at &lt;a href=&quot;https://prowler.pro&quot;&gt;prowler.pro&lt;/a&gt;&lt;/i&gt;&lt;/b&gt;&lt;/p&gt;&lt;hr&gt;&lt;p align=&quot;center&quot;&gt;  &lt;img src=&quot;https://user-images.githubusercontent.com/3985464/113734260-7ba06900-96fb-11eb-82bc-d4f68a1e2710.png&quot; /&gt;&lt;/p&gt;&lt;p align=&quot;center&quot;&gt;  &lt;a href=&quot;https://join.slack.com/t/prowler-workspace/shared_invite/zt-1hix76xsl-2uq222JIXrC7Q8It~9ZNog&quot;&gt;&lt;img alt=&quot;Slack Shield&quot; src=&quot;https://img.shields.io/badge/slack-prowler-brightgreen.svg?logo=slack&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://pypi.org/project/prowler/&quot;&gt;&lt;img alt=&quot;Python Version&quot; src=&quot;https://img.shields.io/pypi/v/prowler.svg&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://pypi.python.org/pypi/prowler/&quot;&gt;&lt;img alt=&quot;Python Version&quot; src=&quot;https://img.shields.io/pypi/pyversions/prowler.svg&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://pypistats.org/packages/prowler&quot;&gt;&lt;img alt=&quot;PyPI Prowler Downloads&quot; src=&quot;https://img.shields.io/pypi/dw/prowler.svg?label=prowler%20downloads&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://pypistats.org/packages/prowler-cloud&quot;&gt;&lt;img alt=&quot;PyPI Prowler-Cloud Downloads&quot; src=&quot;https://img.shields.io/pypi/dw/prowler-cloud.svg?label=prowler-cloud%20downloads&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://hub.docker.com/r/toniblyx/prowler&quot;&gt;&lt;img alt=&quot;Docker Pulls&quot; src=&quot;https://img.shields.io/docker/pulls/toniblyx/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://hub.docker.com/r/toniblyx/prowler&quot;&gt;&lt;img alt=&quot;Docker&quot; src=&quot;https://img.shields.io/docker/cloud/build/toniblyx/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://hub.docker.com/r/toniblyx/prowler&quot;&gt;&lt;img alt=&quot;Docker&quot; src=&quot;https://img.shields.io/docker/image-size/toniblyx/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://gallery.ecr.aws/prowler-cloud/prowler&quot;&gt;&lt;img width=&quot;120&quot; height=19&quot; alt=&quot;AWS ECR Gallery&quot; src=&quot;https://user-images.githubusercontent.com/3985464/151531396-b6535a68-c907-44eb-95a1-a09508178616.png&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;p align=&quot;center&quot;&gt;  &lt;a href=&quot;https://github.com/prowler-cloud/prowler&quot;&gt;&lt;img alt=&quot;Repo size&quot; src=&quot;https://img.shields.io/github/repo-size/prowler-cloud/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://github.com/prowler-cloud/prowler/issues&quot;&gt;&lt;img alt=&quot;Issues&quot; src=&quot;https://img.shields.io/github/issues/prowler-cloud/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://github.com/prowler-cloud/prowler/releases&quot;&gt;&lt;img alt=&quot;Version&quot; src=&quot;https://img.shields.io/github/v/release/prowler-cloud/prowler?include_prereleases&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://github.com/prowler-cloud/prowler/releases&quot;&gt;&lt;img alt=&quot;Version&quot; src=&quot;https://img.shields.io/github/release-date/prowler-cloud/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://github.com/prowler-cloud/prowler&quot;&gt;&lt;img alt=&quot;Contributors&quot; src=&quot;https://img.shields.io/github/contributors-anon/prowler-cloud/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://github.com/prowler-cloud/prowler&quot;&gt;&lt;img alt=&quot;License&quot; src=&quot;https://img.shields.io/github/license/prowler-cloud/prowler&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://twitter.com/ToniBlyx&quot;&gt;&lt;img alt=&quot;Twitter&quot; src=&quot;https://img.shields.io/twitter/follow/toniblyx?style=social&quot;&gt;&lt;/a&gt;  &lt;a href=&quot;https://twitter.com/prowlercloud&quot;&gt;&lt;img alt=&quot;Twitter&quot; src=&quot;https://img.shields.io/twitter/follow/prowlercloud?style=social&quot;&gt;&lt;/a&gt;&lt;/p&gt;# Description`Prowler` is an Open Source security tool to perform AWS, GCP and Azure security best practices assessments, audits, incident response, continuous monitoring, hardening and forensics readiness.It contains hundreds of controls covering CIS, NIST 800, NIST CSF, CISA, RBI, FedRAMP, PCI-DSS, GDPR, HIPAA, FFIEC, SOC2, GXP, AWS Well-Architected Framework Security Pillar, AWS Foundational Technical Review (FTR), ENS (Spanish National Security Scheme) and your custom security frameworks.| Provider | Checks | Services | [Compliance Frameworks](https://docs.prowler.cloud/en/latest/tutorials/compliance/) | [Categories](https://docs.prowler.cloud/en/latest/tutorials/misc/#categories) ||---|---|---|---|---|| AWS | 283 | 55 -&gt; `prowler aws --list-services` | 25 -&gt; `prowler aws --list-compliance` | 5 -&gt; `prowler aws --list-categories` || GCP | 73 | 11 -&gt; `prowler gcp --list-services` | 1 -&gt; `prowler gcp --list-compliance` | 0 -&gt; `prowler gcp --list-categories`|| Azure | 20 | 3 -&gt; `prowler azure --list-services` | CIS soon | 1 -&gt; `prowler azure --list-categories` || Kubernetes | Planned | - | - | - |# üìñ DocumentationThe full documentation can now be found at [https://docs.prowler.cloud](https://docs.prowler.cloud)## Looking for Prowler v2 documentation?For Prowler v2 Documentation, please go to https://github.com/prowler-cloud/prowler/tree/2.12.1.# ‚öôÔ∏è Install## Pip packageProwler is available as a project in [PyPI](https://pypi.org/project/prowler-cloud/), thus can be installed using pip with Python &gt;= 3.9:```consolepip install prowlerprowler -v```More details at https://docs.prowler.cloud## ContainersThe available versions of Prowler are the following:- `latest`: in sync with master branch (bear in mind that it is not a stable version)- `&lt;x.y.z&gt;` (release): you can find the releases [here](https://github.com/prowler-cloud/prowler/releases), those are stable releases.- `stable`: this tag always point to the latest release.The container images are available here:- [DockerHub](https://hub.docker.com/r/toniblyx/prowler/tags)- [AWS Public ECR](https://gallery.ecr.aws/prowler-cloud/prowler)## From GithubPython &gt;= 3.9 is required with pip and poetry:```git clone https://github.com/prowler-cloud/prowlercd prowlerpoetry shellpoetry installpython prowler.py -v```# üìê‚úèÔ∏è High level architectureYou can run Prowler from your workstation, an EC2 instance, Fargate or any other container, Codebuild, CloudShell and Cloud9.![Architecture](https://github.com/prowler-cloud/prowler/assets/38561120/080261d9-773d-4af1-af79-217a273e3176)# üìù RequirementsProwler has been written in Python using the [AWS SDK (Boto3)](https://boto3.amazonaws.com/v1/documentation/api/latest/index.html#), [Azure SDK](https://azure.github.io/azure-sdk-for-python/) and [GCP API Python Client](https://github.com/googleapis/google-api-python-client/).## AWSSince Prowler uses AWS Credentials under the hood, you can follow any authentication method as described [here](https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html#cli-configure-quickstart-precedence).Make sure you have properly configured your AWS-CLI with a valid Access Key and Region or declare AWS variables properly (or instance profile/role):  ```console  aws configure  ```  or  ```console  export AWS_ACCESS_KEY_ID=&quot;ASXXXXXXX&quot;  export AWS_SECRET_ACCESS_KEY=&quot;XXXXXXXXX&quot;  export AWS_SESSION_TOKEN=&quot;XXXXXXXXX&quot;  ```Those credentials must be associated to a user or role with proper permissions to do all checks. To make sure, add the following AWS managed policies to the user or role being used:  - arn:aws:iam::aws:policy/SecurityAudit  - arn:aws:iam::aws:policy/job-function/ViewOnlyAccess  &gt; Moreover, some read-only additional permissions are needed for several checks, make sure you attach also the custom policy [prowler-additions-policy.json](https://github.com/prowler-cloud/prowler/blob/master/permissions/prowler-additions-policy.json) to the role you are using.  &gt; If you want Prowler to send findings to [AWS Security Hub](https://aws.amazon.com/security-hub), make sure you also attach the custom policy [prowler-security-hub.json](https://github.com/prowler-cloud/prowler/blob/master/permissions/prowler-security-hub.json).  ## Azure  Prowler for Azure supports the following authentication types:- Service principal authentication by environment variables (Enterprise Application)- Current az cli credentials stored- Interactive browser authentication- Managed identity authentication### Service Principal authenticationTo allow Prowler assume the service principal identity to start the scan, it is needed to configure the following environment variables:```consoleexport AZURE_CLIENT_ID=&quot;XXXXXXXXX&quot;export AZURE_TENANT_ID=&quot;XXXXXXXXX&quot;export AZURE_CLIENT_SECRET=&quot;XXXXXXX&quot;```If you try to execute Prowler with the `--sp-env-auth` flag and those variables are empty or not exported, the execution is going to fail.### AZ CLI / Browser / Managed Identity authenticationThe other three cases do not need additional configuration, `--az-cli-auth` and `--managed-identity-auth` are automated options, `--browser-auth` needs the user to authenticate using the default browser to start the scan. Also `--browser-auth` needs the tenant id to be specified with `--tenant-id`.### PermissionsTo use each one, you need to pass the proper flag to the execution. Prowler for Azure handles two types of permission scopes, which are:- **Azure Active Directory permissions**: Used to retrieve metadata from the identity assumed by Prowler and future AAD checks (not mandatory to have access to execute the tool)- **Subscription scope permissions**: Required to launch the checks against your resources, mandatory to launch the tool.#### Azure Active Directory scopeAzure Active Directory (AAD) permissions required by the tool are the following:- `Directory.Read.All`- `Policy.Read.All`#### Subscriptions scopeRegarding the subscription scope, Prowler by default scans all the subscriptions that is able to list, so it is required to add the following RBAC builtin roles per subscription  to the entity that is going to be assumed by the tool:- `Security Reader`- `Reader`## Google Cloud PlatformProwler will follow the same credentials search as [Google authentication libraries](https://cloud.google.com/docs/authentication/application-default-credentials#search_order):1. [GOOGLE_APPLICATION_CREDENTIALS environment variable](https://cloud.google.com/docs/authentication/application-default-credentials#GAC)2. [User credentials set up by using the Google Cloud CLI](https://cloud.google.com/docs/authentication/application-default-credentials#personal)3. [The attached service account, returned by the metadata server](https://cloud.google.com/docs/authentication/application-default-credentials#attached-sa)Those credentials must be associated to a user or service account with proper permissions to do all checks. To make sure, add the following roles to the member associated with the credentials:  - Viewer  - Security Reviewer  - Stackdriver Account Viewer&gt; By default, `prowler` will scan all accessible GCP Projects, use flag `--project-ids` to specify the projects to be scanned.# üíª Basic UsageTo run prowler, you will need to specify the provider (e.g aws or azure):```consoleprowler &lt;provider&gt;```![Prowler Execution](https://github.com/prowler-cloud/prowler/blob/b91b0103ff38e66a915c8a0ed84905a07e4aae1d/docs/img/short-display.png?raw=True)&gt; Running the `prowler` command without options will use your environment variable credentials.By default, prowler will generate a CSV, a JSON and a HTML report, however you can generate JSON-ASFF (only for AWS Security Hub) report with `-M` or `--output-modes`:```consoleprowler &lt;provider&gt; -M csv json json-asff html```The html report will be located in the `output` directory as the other files and it will look like:![Prowler Execution](https://github.com/prowler-cloud/prowler/blob/62c1ce73bbcdd6b9e5ba03dfcae26dfd165defd9/docs/img/html-output.png?raw=True)You can use `-l`/`--list-checks` or `--list-services` to list all available checks or services within the provider.```consoleprowler &lt;provider&gt; --list-checksprowler &lt;provider&gt; --list-services```For executing specific checks or services you can use options `-c`/`--checks` or `-s`/`--services`:```consoleprowler aws --checks s3_bucket_public_accessprowler aws --services s3 ec2```Also, checks and services can be excluded with options `-e`/`--excluded-checks` or `--excluded-services`:```consoleprowler aws --excluded-checks s3_bucket_public_accessprowler aws --excluded-services s3 ec2```You can always use `-h`/`--help` to access to the usage information and all the possible options:```consoleprowler -h```## Checks ConfigurationsSeveral Prowler's checks have user configurable variables that can be modified in a common **configuration file**.This file can be found in the following path:```prowler/config/config.yaml```## AWSUse a custom AWS profile with `-p`/`--profile` and/or AWS regions which you want to audit with `-f`/`--filter-region`:```consoleprowler aws --profile custom-profile -f us-east-1 eu-south-2```&gt; By default, `prowler` will scan all AWS regions.## AzureWith Azure you need to specify which auth method is going to be used:```consoleprowler azure [--sp-env-auth, --az-cli-auth, --browser-auth, --managed-identity-auth]```&gt; By default, `prowler` will scan all Azure subscriptions.## Google Cloud PlatformOptionally, you can provide the location of an application credential JSON file with the following argument:```consoleprowler gcp --credentials-file path```&gt; By default, `prowler` will scan all accessible GCP Projects, use flag `--project-ids` to specify the projects to be scanned.# üìÉ LicenseProwler is licensed as Apache License 2.0 as specified in each file. You may obtain a copy of the License at&lt;http://www.apache.org/licenses/LICENSE-2.0&gt;</longdescription>
</pkgmetadata>