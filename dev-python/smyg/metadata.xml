<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># ShowMeYourGit**showmeyourgit** (or smyg) is a project for calculating git metrics: added lines, deleted lines, commits count, changed files, code changes ratio, code churn ratio.## InstallationUse the package manager [pip](https://pip.pypa.io/en/stable/) to install smyg.```bashpip install --user smyg```## UsageClone [example project](https://github.com/nmix/example-project)```bashgit clone https://github.com/nmix/example-project.gitcd example-project```### commit Show commit info```bash# --- show command help$ smyg commit --help# --- show last commit info for current branch$ smyg commitcdcb7c6ac0b92b1e16cfdd6f1e6abf0ed8f73e48 | update README2023-02-20 16:42:41+03:00 | Nikolay Mikhaylichenko['main']Added lines:       26Deleted lines:      0Changed files:      1# --- show last commit info in json format$ smyg commit --output json | jq{  &quot;hash&quot;: &quot;cdcb7c6ac0b92b1e16cfdd6f1e6abf0ed8f73e48&quot;,  &quot;msg&quot;: &quot;update README&quot;,  &quot;author_name&quot;: &quot;Nikolay Mikhaylichenko&quot;,  &quot;author_email&quot;: &quot;nn.mikh@yandex.ru&quot;,  &quot;author_date&quot;: &quot;2023-02-20 16:42:41+03:00&quot;,  &quot;committer_name&quot;: &quot;Nikolay Mikhaylichenko&quot;,  &quot;committer_email&quot;: &quot;nn.mikh@yandex.ru&quot;,  &quot;committer_date&quot;: &quot;2023-02-20 16:42:41+03:00&quot;,  &quot;project_name&quot;: &quot;example-project&quot;,  &quot;added&quot;: 26,  &quot;deleted&quot;: 0,  &quot;changed_files&quot;: 1,  &quot;branches&quot;: [    &quot;main&quot;  ]}# --- show info about arbitary commit$ smyg commit 07cb19ceba138f1d7e4a1d48f024e520f3657a1d07cb19ceba138f1d7e4a1d48f024e520f3657a1d | commit 2-12023-02-20 16:26:48+03:00 | Nikolay Mikhaylichenko['branch-2']Added lines:        6Deleted lines:      0Changed files:      1```### branch-commitsShow changes for bundle of commits in branch.If we know last commit of previous bundle then we take all commits after that. In Gitlab CI previous commit SHA may be in `CI_COMMIT_BEFORE_SHA` environment variable (see [Predefined variables reference](https://docs.gitlab.com/ee/ci/variables/predefined_variables.html)).If we dont have previous commit then we take only commits for *single* branch. *Signle* branch means that commit belongs only one branch. **Here it is mandatory to have a complete local copy of the repository with all branches.**```bash# --- show command help$ smyg branch-commits --help# --- if you just clone the example repository, the entire commit list will be displayed (from Initial commit)#     this is because only one branch is locally received and all commits belongs to it$ smyg branch-commitscdcb7c6ac0b92b1e16cfdd6f1e6abf0ed8f73e48 | update README2023-02-20 16:42:41+03:00 | Nikolay Mikhaylichenko['main']Added lines:       26Deleted lines:      0Changed files:      17febdeea7b4f82d15f7fa0765c12f10928af7a1a | lorem ipsum in main2023-02-20 16:33:58+03:00 | Nikolay Mikhaylichenko['main']Added lines:        6Deleted lines:      0Changed files:      1# ... skip remaining commits# --- checkout branch-3 and repeat the command#     we get only 3 commits for the branch$ git checkout branch-3Switched to a new branch 'branch-3'$ smyg branch-commits414d13a92998f9de86dd60d41f05f092e64350f3 | commit 3-32023-02-20 16:32:42+03:00 | Nikolay Mikhaylichenko['branch-3']Added lines:        2Deleted lines:      0Changed files:      1776206b033b8a149c4ee491ec9bee23273f98afc | commit 3-22023-02-20 16:32:13+03:00 | Nikolay Mikhaylichenko['branch-3']Added lines:        2Deleted lines:      0Changed files:      1aa4f97ed8366b8d72a0be2c1c114aa503b531190 | commit 3-12023-02-20 16:31:54+03:00 | Nikolay Mikhaylichenko['branch-3']Added lines:        4Deleted lines:      0Changed files:      1# --- branch commits with previous SHA$ git checkout mainsmyg branch-commits 5317cd6080033ae5a9ce3166095745e862a52c9dcdcb7c6ac0b92b1e16cfdd6f1e6abf0ed8f73e48 | update README2023-02-20 16:42:41+03:00 | Nikolay Mikhaylichenko['main']Added lines:       26Deleted lines:      0Changed files:      17febdeea7b4f82d15f7fa0765c12f10928af7a1a | lorem ipsum in main2023-02-20 16:33:58+03:00 | Nikolay Mikhaylichenko['main']Added lines:        6Deleted lines:      0Changed files:      1bbead3ba03de57909ee622fac4b973de180f5e5f | Branch 2 (#2)commit 2-1  | commit 2-2 | commit 2-32023-02-20 16:29:39+03:00 | Nikolay Mikhaylichenko['branch-3', 'main']Added lines:        8Deleted lines:      0Changed files:      1```### codechangesShow total added and deleted lines count for current ref.```bash# --- show command help$ smyg codechanges --help# --- changes for current ref$ smyg codechangesRatio (%):         11Added lines:      107Deleted lines:     12# --- code changes between commits$ smyg codechanges --from-commit 3a085582e8df7c1d622c412eb54eb5ee96e82c48  \  --to-commit bbead3ba03de57909ee622fac4b973de180f5e5fRatio (%):         42Added lines:       26Deleted lines:     11```### codechurnShow count of added lines and count of deleted lines from those that were added. Displays the level of work that was not released.&gt; Ideally, it should coincide with the codechanges for whole project history. For complex branching it may slightly different.```bash# --- show command help$ smyg codechurn --help# --- churn for current ref (equal with codechanges, it is expected)smyg codechurnRatio (%):         11Added lines:      107Deleted lines:     12# --- churn from specified commit (not equal with codechanges, it is expected)$ smyg codechurn --from-commit 44c6334f38fe796f38c39e1d11a8d19925684926 \    --to-commit fccfa86625353409018ccd467f0050b57152656eRatio (%):         23Added lines:       26Deleted lines:      6```## Prometheus MetricsYou can push metrics to Prometheus PushGateway. Recommended to use Aggregation Gateway like https://github.com/zapier/prom-aggregation-gateway.`commit` and `branch_commits` is a *Counter* type, `codechanges` and `codechurn` - *Gauge*. You must specify environment variables `PUSHGATEWAY_URL` and `PROJECT_NAME` and command option `--push-metrics` to send metrics. For basic auth access specify `PUSHGATEWAY_USERNAME` and `PUSHGATEWAY_PASSWORD`.```bash$ git checkout main$ docker run --rm -p 8080:80 ghcr.io/zapier/prom-aggregation-gateway:v0.7.0$ PUSHGATEWAY_URL=localhost:8080 PROJECT_NAME=example_project \    smyg commit --push-metricscdcb7c6ac0b92b1e16cfdd6f1e6abf0ed8f73e48 | update README2023-02-20 16:42:41+03:00 | Nikolay Mikhaylichenko['main']Added lines:       26Deleted lines:      0Changed files:      1$ curl localhost:8080/metrics# HELP commit_added_lines_total Number of added lines in commit# TYPE commit_added_lines_total countercommit_added_lines_total{author_email=&quot;nn.mikh@yandex.ru&quot;,author_name=&quot;Nikolay Mikhaylichenko&quot;,job=&quot;showmeyourgit&quot;,project_name=&quot;example_project&quot;} 26# HELP commit_changed_files_total Number of changed files in commit# TYPE commit_changed_files_total countercommit_changed_files_total{author_email=&quot;nn.mikh@yandex.ru&quot;,author_name=&quot;Nikolay Mikhaylichenko&quot;,job=&quot;showmeyourgit&quot;,project_name=&quot;example_project&quot;} 1# HELP commit_deleted_lines_total Number of added deleted in commit# TYPE commit_deleted_lines_total countercommit_deleted_lines_total{author_email=&quot;nn.mikh@yandex.ru&quot;,author_name=&quot;Nikolay Mikhaylichenko&quot;,job=&quot;showmeyourgit&quot;,project_name=&quot;example_project&quot;} 0# HELP commits_total Number of commits# TYPE commits_total countercommits_total{author_email=&quot;nn.mikh@yandex.ru&quot;,author_name=&quot;Nikolay Mikhaylichenko&quot;,job=&quot;showmeyourgit&quot;,project_name=&quot;example_project&quot;} 1```## Develop &amp; Test```bash$ git clone git@github.com:nmix/showmeyourgit.git$ cd showmeyourgit$ poetry install$ poetry shell$ pytest```## ContributingPull requests are welcome. For major changes, please open an issue firstto discuss what you would like to change.Please make sure to update tests as appropriate.## License[MIT](https://choosealicense.com/licenses/mit/)</longdescription>
</pkgmetadata>