<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>Taxoniq: Taxon Information Query - fast, offline querying of NCBI Taxonomy and related data===========================================================================================Taxoniq is a Python and command-line interface to the[NCBI Taxonomy database](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7408187/) and selected data sources thatcross-reference it.Taxoniq's features include:- Pre-computed indexes updated monthly from NCBI, [WoL](https://biocore.github.io/wol/) and cross-referenced databases- Offline operation: all indexes are bundled with the package; no network calls are made when querying taxon information  (separately, Taxoniq can fetch the nucleotide or protein sequences over the network given a taxon or sequence  accession ID - see **Retrieving sequences** below)- A CLI capable of JSON I/O, batch processing and streaming of inputs for ease of use and pipelining in shell scripts- A stable, [well-documented](https://chanzuckerberg.github.io/taxoniq/#module-taxoniq), type-hinted Python API  (Python 3.6 and higher is supported)- Comprehensive testing and continuous integration- An intuitive interface with useful defaults- Compactness, readability, and extensibilityThe Taxoniq package bundles an indexed, compressed copy of the[NCBI taxonomy database files](https://ncbiinsights.ncbi.nlm.nih.gov/2018/02/22/new-taxonomy-files-available-with-lineage-type-and-host-information/),the [NCBI RefSeq](https://www.ncbi.nlm.nih.gov/refseq/) nucleotide and protein sequence accession IDs associated witheach taxon, the [WoL](https://biocore.github.io/wol/) kingdom-wide phylogenomic distance database, and relevantinformation from other databases. Sequence accession IDs which appear in the NCBI RefSeq BLAST databases are indexed sothat given a taxon ID, accession ID, or taxon name, you can quickly retrieve the taxon's rank, lineage, description,citations, representative RefSeq IDs, LCA information, evolutionary distance, sequence (with a network call), and more,as described in the **Cookbook** section below. Full [API documentation](https://chanzuckerberg.github.io/taxoniq/#module-taxoniq)is available.## Installation    pip3 install taxoniqPre-built wheels are available for Python 3.5+ on Linux and MacOS. On MacOS 11 Big Sur, Pip 20.3+ is required to installpre-built wheels (you can check your version with `pip3 --version` and upgrade with `pip3 install --upgrade pip`).## Synopsis```python&gt;&gt;&gt; import taxoniq&gt;&gt;&gt; t = taxoniq.Taxon(9606)&gt;&gt;&gt; t.scientific_name'Homo sapiens'&gt;&gt;&gt; t.common_name'human'&gt;&gt;&gt; t.ranked_lineage[taxoniq.Taxon(9606), taxoniq.Taxon(9605), taxoniq.Taxon(9604), taxoniq.Taxon(9443), taxoniq.Taxon(40674), taxoniq.Taxon(7711), taxoniq.Taxon(33208), taxoniq.Taxon(2759)]&gt;&gt;&gt; len(t.lineage)32&gt;&gt;&gt; [(t.rank.name, t.scientific_name) for t in t.ranked_lineage][('species', 'Homo sapiens'), ('genus', 'Homo'), ('family', 'Hominidae'), ('order', 'Primates'), ('class', 'Mammalia'), ('phylum', 'Chordata'), ('kingdom', 'Metazoa'), ('superkingdom', 'Eukaryota')]&gt;&gt;&gt; [(c.rank.name, c.common_name) for c in t.child_nodes][('subspecies', 'Neandertal'), ('subspecies', 'Denisova hominin')]&gt;&gt;&gt; t.refseq_representative_genome_accessions[:10][taxoniq.Accession('NC_000001.11'), taxoniq.Accession('NC_000002.12'), taxoniq.Accession('NC_000003.12'), taxoniq.Accession('NC_000004.12'), taxoniq.Accession('NC_000005.10'), taxoniq.Accession('NC_000006.12'), taxoniq.Accession('NC_000007.14'), taxoniq.Accession('NC_000008.11'), taxoniq.Accession('NC_000009.12'), taxoniq.Accession('NC_000010.11')]&gt;&gt;&gt; t.url'https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&amp;id=9606'# Wikidata provides structured links to many databases about taxa represented on Wikipedia&gt;&gt;&gt; t.wikidata_url'https://www.wikidata.org/wiki/Q15978631'``````&gt;&gt;&gt; t2 = taxoniq.Taxon(scientific_name=&quot;Bacillus anthracis&quot;)&gt;&gt;&gt; t2.description'&lt;p class=&quot;mw-empty-elt&quot;&gt; &lt;/p&gt; &lt;p class=&quot;mw-empty-elt&quot;&gt; &lt;/p&gt; &lt;p&gt;&lt;i&gt;&lt;b&gt;Bacillus anthracis&lt;/b&gt;&lt;/i&gt; is the agent of anthrax—a common disease of livestock and, occasionally, of humans—and the only obligate pathogen within the genus &lt;i&gt;Bacillus&lt;/i&gt;. This disease can be classified as a zoonosis, causing infected animals to transmit the disease to humans. &lt;i&gt;B. anthracis&lt;/i&gt; is a Gram-positive, endospore-forming, rod-shaped bacterium, with a width of 1.0–1.2 µm and a length of 3–5&amp;#160;µm. It can be grown in an ordinary nutrient medium under aerobic or anaerobic conditions.&lt;/p&gt; &lt;p&gt;It is one of few bacteria known to synthesize a protein capsule (poly-D-gamma-glutamic acid). Like &lt;i&gt;Bordetella pertussis&lt;/i&gt;, it forms a calmodulin-dependent adenylate cyclase exotoxin known as anthrax edema factor, along with anthrax lethal factor. It bears close genotypic and phenotypic resemblance to &lt;i&gt;Bacillus cereus&lt;/i&gt; and &lt;i&gt;Bacillus thuringiensis&lt;/i&gt;. All three species share cellular dimensions and morphology&lt;/p&gt;...'``````python&gt;&gt;&gt; t3 = taxoniq.Taxon(accession_id=&quot;NC_000913.3&quot;)&gt;&gt;&gt; t3.scientific_name'Escherichia coli str. K-12 substr. MG1655&quot;'&gt;&gt;&gt; t3.parent.parent.common_name'E. coli'&gt;&gt;&gt; t3.refseq_representative_genome_accessions[0].length4641652# The get_from_s3() method is the only command that will trigger a network call.&gt;&gt;&gt; seq = t3.refseq_representative_genome_accessions[0].get_from_s3().read()&gt;&gt;&gt; len(seq)4641652&gt;&gt;&gt; seq[:64]b'AGCTTTTCATTCTGACTGCAACGGGCAATATGTCTCTGTGTGGATTAAAAAAAGAGTGTCTGAT'```## Retrieving sequencesMirrors of the NCBI BLAST databases are maintained on [AWS S3](https://registry.opendata.aws/ncbi-blast-databases/)(`s3://ncbi-blast-databases`) and Google Storage (`gs://blast-db`). This is a key resource, since S3 and GS havesuperior bandwidth and throughput compared to the NCBI FTP server, so range requests can be used to retrieve individualsequences from the database files without downloading and keeping a copy of the whole database.The Taxoniq PyPI distribution (the package you install using `pip3 install taxoniq`) indexes sequence accession IDs forthe following NCBI BLAST databases:- Refseq viruses representative genomes (`ref_viruses_rep_genomes`) (nucleotide)- Refseq prokaryote representative genomes (contains refseq assembly) (`ref_prok_rep_genomes`) (nucleotide)- RefSeq Eukaryotic Representative Genome Database (`ref_euk_rep_genomes`) (nucleotide)- Betacoronavirus (nucleotide)Given an accession ID, Taxoniq can issue a single HTTP request and return a file-like object streaming the nucleotidesequence from the S3 or GS mirror as follows:```pythonwith taxoniq.Accession(&quot;NC_000913.3&quot;).get_from_s3() as fh:    fh.read()```For brevity, you can use [urllib3.response.HTTPResponse.stream](https://urllib3.readthedocs.io/en/latest/advanced-usage.html)instead of `read(...)` to avoid holding the entire sequence in memory:```pythonwith taxoniq.Accession(&quot;NC_000913.3&quot;).get_from_s3() as fh:    for chunk in fh.stream():        sys.stdout.buffer.write(chunk)```To retrieve many sequences quickly, you may want to use a threadpool to open multiple network connections at once:```pythonfrom concurrent.futures import ThreadPoolExecutordef fetch_seq(accession):    seq = accession.get_from_s3().read()    return (accession, seq)taxon = taxoniq.Taxon(scientific_name=&quot;Apis mellifera&quot;)for accession, seq in ThreadPoolExecutor().map(fetch_seq, taxon.refseq_representative_genome_accessions):    print(accession, len(seq))```This operation is also available in the CLI, as described below.## Command-line interface`pip3 install taxoniq` installs a command-line utility, `taxoniq`, which can be used to perform many of the samefunctions provided by the Python API:```&gt;taxoniq child-nodes --taxon-id 2 --output-format '{tax_id}: {scientific_name}'[    &quot;1224: Proteobacteria&quot;,    &quot;2323: Bacteria incertae sedis&quot;,    &quot;32066: Fusobacteria&quot;,    &quot;40117: Nitrospirae&quot;,    &quot;48479: environmental samples&quot;,    &quot;49928: unclassified Bacteria&quot;,    &quot;57723: Acidobacteria&quot;,    &quot;68297: Dictyoglomi&quot;,    &quot;74152: Elusimicrobia&quot;,    &quot;200783: Aquificae&quot;,    &quot;200918: Thermotogae&quot;,    &quot;200930: Deferribacteres&quot;,    &quot;200938: Chrysiogenetes&quot;,    &quot;200940: Thermodesulfobacteria&quot;,    &quot;203691: Spirochaetes&quot;,    &quot;508458: Synergistetes&quot;,    &quot;1783257: PVC group&quot;,    &quot;1783270: FCB group&quot;,    &quot;1783272: Terrabacteria group&quot;,    &quot;1802340: Nitrospinae/Tectomicrobia group&quot;,    &quot;1930617: Calditrichaeota&quot;,    &quot;2138240: Coprothermobacterota&quot;,    &quot;2498710: Caldiserica/Cryosericota group&quot;,    &quot;2698788: Candidatus Krumholzibacteriota&quot;,    &quot;2716431: Coleospermum&quot;,    &quot;2780997: Vogosella&quot;]```See `taxoniq --help` for full details.#### Retrieving sequences using the CLITo retrieve an individual sequence in FASTA format given an accession ID, use `taxoniq get-from-s3 --accession-id ACCESSION_ID`.To retrieve multiple sequences in FASTA format, use `--accession-id -` and pass the IDs on standard input, one per line:`taxoniq refseq-representative-genome-accessions --scientific-name=&quot;Apis mellifera&quot; | jq -r .[] | taxoniq get-from-s3 --accession-id -`.## Using the nr/nt databasesBecause of their size, taxoniq wheels with indexes of the NT (GenBank Non-redundant nucleotide) BLAST database aredistributed on GitHub instead of PyPI. After running `pip3 install taxoniq`, you can install the NT indexes as follows:- Navigate to https://github.com/chanzuckerberg/taxoniq/releases/latest- In the &quot;Assets&quot; section, for each link that starts with &quot;ncbi_genbank&quot; and ends with &quot;.whl&quot;:  - Right-click on the asset link, and click &quot;Copy link address&quot;  - Run `pip3 install --upgrade &lt;PASTED LINK ADDRESS&gt;`The NT index packages also contain indexes for the RefSeq representative genomes and Betacoronavirus accessions (meaningthey are are superset of the PyPI packages).## Streaming CLI I/OThe `taxoniq` command-line interface can take streaming input from stdin and produce streaming output on stdout. Thisallows the amortization of startup and index load time and efficient operation as part of shell pipelines.The followingexample shows the pipelined operation of [fastp](https://github.com/OpenGene/fastp),[kraken2](https://github.com/DerrickWood/kraken2/wiki), and taxoniq to annotate hits found in a Betacoronavirus sample:```in progress```&lt;!--fastp --thread $KRAKEN2_NUM_THREADS --low_complexity_filter -i R1.fastq.gz -I R2.fastq.gz -o filtered.R1.fastq.gz -O filtered.R2.fastq.gzkraken2 --paired nohuman_1.fastq nohuman_2.fastq --classified-out 'classified#.fastq' | taxoniq--&gt;## CookbookIn progress## Links* [Project home page (GitHub)](https://github.com/chanzuckerberg/taxoniq)* [Documentation](https://chanzuckerberg.github.io/taxoniq/)* [Package distribution (PyPI)](https://pypi.python.org/pypi/taxoniq)* [Change log](https://github.com/chanzuckerberg/taxoniq/blob/master/Changes.rst)* [ETE Toolkit](http://etetoolkit.org/) and the [ETE Tutorial](http://etetoolkit.org/docs/latest/tutorial/index.html) - a general purpose  phylogenetic tree toolkit with a rich Python interface## LicenseTaxoniq software is licensed under the terms of the [MIT License](LICENSE).Distributions of this package contain data from[NCBI Taxonomy, NCBI GenBank, and NCBI RefSeq](https://www.ncbi.nlm.nih.gov/) (Bethesda (MD): National Library ofMedicine (US), National Center for Biotechnology Information). These data are released into the public domain under the[NCBI Public Domain Notice](LICENSE.NCBI).Distributions of this package contain text excerpts from Wikipedia licensed under the terms of the[CC-BY-SA License](LICENSE.WIKIPEDIA).## BugsPlease report bugs, issues, feature requests, etc. on [GitHub](https://github.com/chanzuckerberg/taxoniq/issues).</longdescription>
</pkgmetadata>