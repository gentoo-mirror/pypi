<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>&lt;img src=&quot;https://github.com/coguardio/coguard-cli/raw/master/logo.png&quot; alt=&quot;Light mode logo&quot; width=&quot;500&quot;&gt;# CoGuard## Why CoGuardInfrastructure as Code (IaC) is here to stay. The versioning andcontinuous scanning of every layer of your IT (on premise and cloud)infrastructure is crucial.CoGuard's team observed that there are a lot of policy checks on the layerscommunicating to the cloud, but the configurations inside specificcompute devices such as physical servers, virtual machines orcontainers are mostly neglected, or have silo-ed solutions at best.In order to have static analysis practices for IaC that go as deep asthe available tools for code, every layer needs to be equally addressed.In our practice, we observed that, at times, even an awareness oflocations of configuration files is lacking. This is why we created acommand line tool helping with discovering those configurations, andscanning them.CoGuard's CLI combines multiple ways to extract and scan your configurationfiles.1. Docker images: Modern   container scanners check for versions of software and libraries   installed on those containers, and establish if there are common known   vulnerabilities and exposures (CVEs). The   CoGuard CLI is trying to find known configuration files for e.g. web   servers or databases, and scans these for security and best practice.   Additionally, the last Docker file used to create an image is analyzed   as well.2. Project Repositories: Modern projects store their infrastructure   information inside code repositories for better visibility and   traceability. CoGuard can extract Infrastructure as Code (IaC)   files and other supported configurations. It also searches for   external container references and scans these as well.3. Cloud configurations not represented as IaC: Many organizations   have either not yet started using IaC tools, or have a hybrid model   of part IaC, part manual management. For these cases, we can   extract cloud configurations for AWS, Azure or GCP, and scan them   as well.## Introduction to the CoGuard CLICoGuard is a comprehensive static analysis tool for IT infrastructureconfigurations (cloud and on-premise).This project is the command line interface to CoGuard, with additionalauto-discovery functionality.In its current release, it scans1. Docker images and its contents,2. Project folders (such as GitHub Repositories) and3. automatically extracted cloud configurations from the three major   cloud providersIn particular, it searches for known configuration files of differentsoftware packages (like webservers, databases, etc.), and scans theseconfigurations for security and best practice.## How to install it### Pre-RequisitesYou need to have `python3`, `pip3` and `docker` installed on your system.Here are the different operating systems and commands to be used for Python and Pip.&lt;details&gt;&lt;summary&gt;Ubuntu/Debian&lt;/summary&gt;```shellsudo apt install -y python3 python3-pip```&lt;/details&gt;&lt;details&gt;&lt;summary&gt;Alpine&lt;/summary&gt;```shellapk add python3 py3-pip```&lt;/details&gt;&lt;details&gt;&lt;summary&gt;CentOS/Fedora&lt;/summary&gt;```shellsudo yum install -y python3 python3-pip```&lt;/details&gt;&lt;details&gt;&lt;summary&gt;Arch Linux&lt;/summary&gt;```shellsudo pacman -S python python-pip```&lt;/details&gt;&lt;details&gt;&lt;summary&gt;Mac OS&lt;/summary&gt;Assuming you are using [Homebrew](https://brew.sh), you have to run```shellbrew install python3```&lt;/details&gt;&lt;details&gt;&lt;summary&gt;Windows&lt;/summary&gt;Download Python3 for Windows using [this link](https://www.python.org/downloads/windows/), andinstall it.&lt;/details&gt;### InstallationCoGuard CLI can either be pulled from this repository and useddirectly, or installed via `pip`:```shellpip3 install coguard-cli```Keep in mind that it is a requirement to have Docker installed locally.### Inclusion into your CI/CD pipelineWe have ready scripts which can be generated to be included into your CI/CD pipeline.The list of supported providers is growing.To generate e.g. a GitHub Actions YAML which automatically scans your repository onpull request/push, simply type```shellcoguard pipeline github add &lt;PATH_TO_YOUR_REPOSITORY&gt;```## How to use itAny of the following options requires you to create a CoGuard account.After completion, this image check will return the findings of CoGuardon this particular image. You can view the latest historical scan resultswhen logging in to [https://portal.coguard.io](https://portal.coguard.io).### Scanning Docker imagesUsing the CoGuard CLI, you can run a scan on your local Docker imagesusing```shellcoguard docker-image [scan] [&lt;YOUR-IMAGE-NAME-OR-ID&gt;]```### Scanning project repository foldersUsing the CoGuard CLI, you can run a scan on your localfile repositories using```shellcoguard folder [scan] [&lt;PATH-TO-FOLDER&gt;]```### Extracting and scanning cloud configurations (BETA)Using the CoGuard CLI, you can run a scan a current snapshot of yourcloud configurations. This requires you to have the respectivecloud CLI tools (`aws-cli` for AWS, `gcloud` for GCP or `az` forAzure) installed and authenticated on your device.```shellcoguard cloud [scan] {aws, azure, gcp}```The extraction may take a couple of minutes, depending on yourinternet speed.### General scanTo get a general scan, which includes all locally installed Dockerimages, anything in the current-working directory (recursive) and anyinstalled cloud provider authentication, simply run```shellcoguard scan```## Screenshot and further informationHere is a screenshot of a sample scan:![](./screenshot.png)As you can see, CoGuard also analyzes the last Dockerfile used.The checks are gathered from different security benchmarks, such as CIS, but alsodirectly from the user manuals of these software projects. At times, known issues forcertain versions and security remediations specific to a certain version are being takeninto account as well.## Installation remarks**Remark 1**: It may happen that the folder where `pip` is installing packages is notin included in `PATH`. We have observed it on some Ubuntu installations, and onHomebrew Mac installs. For the Linux case, such as Ubuntu,you can find the binary usually under `$HOME/.local/bin/coguard`, i.e. you run```shell$HOME/.local/bin/coguard docker-image [&lt;YOUR-IMAGE-NAME-OR-ID&gt;]```For the Mac case, it is often installed under `~/Library/Python/&lt;YOUR_PYTHON_VERSION&gt;/bin/coguard`, i.e. you would run```shell~/Library/Python/&lt;YOUR_PYTHON_VERSION&gt;/bin/coguard docker-image [&lt;YOUR-IMAGE-NAME-OR-ID&gt;]```If you omit the image ID parameter, CoGuard will scan all the images currentlystored on your device.**Remark 2**: Windows users need to be allowed to create and read symbolic links.This can be achieved using three options:&lt;details&gt;&lt;summary&gt;Option 1&lt;/summary&gt;1. Run the CoGuard execution as admin temporarily. This can be achieved by opening the   PowerShell or command prompt as administrative user (right click on the icon),   or by issuing the command   ```shell   Start-Process powershell -Verb runAs   ```   inside an already open command/Powershell window.&lt;/details&gt;&lt;details&gt;&lt;summary&gt;Option 2&lt;/summary&gt;2. Run Windows in Developer Mode (instructions on how to run Windows as a developer can   be found [here](https://docs.microsoft.com/en-us/gaming/game-bar/guide/developer-mode)).&lt;/details&gt;&lt;details&gt;&lt;summary&gt;Option 3&lt;/summary&gt;3. Run CoGuard on a Linux virtual machine, e.g. using the Windows subsystem for Linux.   This is commonly installed with Docker Desktop for Windows. If you do not have it installed,   then installation instructions can be found   [here](https://docs.microsoft.com/en-us/windows/wsl/install).   The installation steps for CoGuard using WSL are equivalent to the pre-requisites   and installation steps described for Linux (dependent on the distribution you choose).&lt;/details&gt;## Current support and future plansThe currently supported auto-discovery of configuration files insideDocker containers, folders and cloud configuration exports is limited to the finders[in this folder](https://github.com/coguardio/coguard-cli/tree/master/src/coguard_cli/discovery/config_file_finders).The list includes, among others,- Apache Kafka- Apache Tomcat- Apache WebServer- ElasticSearch- Kerberos- MongoDB- MySQL- NGINX- OpenTelemetry Collector- PostgreSQL- TerraForm- KubernetesThis listwill expand in the future. In addition, we are scanning theDockerfile used to create the images, and will add some Linuxconfiguration files in the near future.## Learn more- [CoGuard Website](https://www.coguard.io)- [CoGuard Blog](https://www.coguard.io/blog)</longdescription>
</pkgmetadata>