<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Mythic Scripting InterfaceThe `mythic` package creates a way to programmatically interact and control a Mythic instance. Mythic is a Command and Control (C2) framework for Red Teaming. The code is on GitHub (https://github.com/its-a-feature/Mythic) and the Mythic project's documentation is on GitBooks (https://docs.mythic-c2.net).## InstallationYou can install the mythic scripting interface from PyPI:```pip install mythic```## How to useVersion 0.0.13 of the `mythic` package supports version 2.1.* of the Mythic project.Version 0.0.15 of the `mythic` package supports version 2.2.1 of the Mythic project.Version 0.0.20 of the `mythic` package supports version 2.2.6 of the Mythic project (reports as version &quot;3&quot;).Version 0.0.21-25 of the `mythic` package supports version 2.2.8+ of the Mythic project (reports as version &quot;3&quot;).Version 0.0.26 of the `mythic` package supports version 2.3+ of the Mythic project (reports as version &quot;3&quot;).Version 0.0.29-0.0.36 of the `mythic` package supports version 2.3+ of the Mythic project utilizing the new GraphQL endpoints and reports as version &quot;3&quot;.This will be the last version that supports the old mythic_rest interface. Starting with version 0.1.0, the `mythic` PyPi package will only support the new GraphQL interface and will report as version &quot;4&quot;.## New GraphQL InterfaceIn addition to thte old RESTful interfaces and websockets, this version includes a beta set of the GraphQL features. ```import asynciofrom time import timefrom mythic import mythic, mythic_classesasync def main():    mythic_instance = await mythic.login(        username=&quot;mythic_admin&quot;,        password=&quot;mythic_password&quot;,        server_ip=&quot;192.168.53.139&quot;,        server_port=7443,        timeout=-1    )    # ################ Registering a file with Mythic for use in Tasking ################    &quot;&quot;&quot; resp = await mythic.register_file(       mythic=mythic_instance, filename=&quot;test.txt&quot;, contents=b&quot;this is a test&quot;    )    print(f&quot;registered file UUID: {resp}&quot;)    status = await mythic.issue_task(       mythic=mythic_instance,       command_name=&quot;upload&quot;,       parameters={&quot;remote_path&quot;: &quot;test.js&quot;, &quot;new-file&quot;: resp},       callback_id=20,    )    print(f&quot;Issued a task: {status}&quot;) &quot;&quot;&quot;    # ################ Issue Task and Wait for completion or timeout ################    &quot;&quot;&quot;    try:        status = await mythic.issue_task(            mythic=mythic_instance,            command_name=&quot;shell&quot;,            parameters={&quot;command&quot;: &quot;whoami&quot;},            callback_id=0,            timeout=20,            return_on_status=mythic_classes.MythicStatus.Completed,        )        print(f&quot;Issued a task: {status}&quot;)    except Exception as e:        print(f&quot;Got exception trying to issue task: {str(e)}&quot;)    &quot;&quot;&quot;    # ################ Issue Task against all active callbacks ################    &quot;&quot;&quot;status = await mythic.issue_task_all_active_callbacks(        mythic=mythic_instance, command_name=&quot;shell&quot;, parameters=&quot;whoami&quot;    )    print(f&quot;Got the following list back: {status}&quot;)&quot;&quot;&quot;    # ################ Issue Task and wait for output ################    &quot;&quot;&quot; status = await mythic.issue_task_and_waitfor_task_output(        mythic=mythic_instance,        command_name=&quot;shell&quot;,        parameters=&quot;whoami&quot;,        callback_id=156,        timeout=60,        return_on_status=mythic_classes.MythicStatus.Completed,    )    print(f&quot;Got the following output: {status}\n&quot;)    task = await mythic.issue_task(        mythic=mythic_instance,        command_name=&quot;shell&quot;,        parameters=&quot;whoami&quot;,        callback_id=156,        timeout=60,        return_on_status=mythic_classes.MythicStatus.Completed,    )    output = await mythic.waitfor_for_task_output(        mythic=mythic_instance, task_id=task[&quot;id&quot;], timeout=60    )    print(f&quot;Got the following output the 2nd time: {output}\n&quot;) &quot;&quot;&quot;    # ################ Wait for Multiple Subscriptions ################    &quot;&quot;&quot;await asyncio.gather(        new_callbacks(mythic_instance=mythic_instance),        new_tasks(mythic_instance=mythic_instance),        all_tasks(mythic_instance=mythic_instance),        all_tasks_by_callback(mythic_instance=mythic_instance, callback_id=156),    )&quot;&quot;&quot;    # ################ Adding MITRE ATT&amp;CK Techniques To Task ################    &quot;&quot;&quot; await mythic.add_mitre_attack_to_task(        mythic=mythic_instance, task_id=1, mitre_attack_numbers=[&quot;T1033&quot;]    ) &quot;&quot;&quot;    # ################ Create a Payload ################    &quot;&quot;&quot; await mythic.create_payload(        mythic=mythic_instance,        payload_type_name=&quot;poseidon&quot;,        filename=&quot;test.bin&quot;,        operating_system=&quot;macOS&quot;,        commands=[],        c2_profiles=[            {                &quot;c2_profile&quot;: &quot;http&quot;,                &quot;c2_profile_parameters&quot;: {                    &quot;callback_host&quot;: &quot;http://192.168.53.139&quot;,                    &quot;callback_port&quot;: &quot;80&quot;,                },            }        ],        build_parameters=[{&quot;name&quot;: &quot;mode&quot;, &quot;value&quot;: &quot;default&quot;}],        return_on_complete=True,    )    await mythic.create_payload(        mythic=mythic_instance,        payload_type_name=&quot;apfell&quot;,        filename=&quot;apfell_test.js&quot;,        operating_system=&quot;macOS&quot;,        c2_profiles=[            {                &quot;c2_profile&quot;: &quot;http&quot;,                &quot;c2_profile_parameters&quot;: {                    &quot;callback_host&quot;: &quot;http://192.168.53.139&quot;,                    &quot;callback_port&quot;: &quot;80&quot;,                },            }        ],    ) &quot;&quot;&quot;    # ################ Add User to Operation ################    &quot;&quot;&quot; try:        await mythic.add_operator_to_operation(            mythic=mythic_instance,            operation_name=&quot;Operation Chimera&quot;,            operator_username=&quot;bob&quot;,        )    except Exception as e:        print(f&quot;Got exception adding user to operation: {e}&quot;) &quot;&quot;&quot;    # ################ Update Operator View Mode ################    &quot;&quot;&quot; try:        await mythic.update_operator_in_operation(            mythic=mythic_instance,            operation_name=&quot;Operation Chimera&quot;,            operator_username=&quot;bob&quot;,            view_mode=&quot;spectator&quot;,        )    except Exception as e:        print(f&quot;Got exception updating user in operation: {e}&quot;) &quot;&quot;&quot;    # ################ Update Operation ################    &quot;&quot;&quot; try:        await mythic.update_operation(            mythic=mythic_instance,            operation_name=&quot;Operation Chimera&quot;,            webhook_message=&quot;test&quot;,            lead_operator_username=&quot;bob&quot;,        )    except Exception as e:        print(f&quot;Got exception updating operation: {e}&quot;) &quot;&quot;&quot;    # ################ Remove User from Operation ################    &quot;&quot;&quot; try:        await mythic.remove_operator_from_operation(            mythic=mythic_instance,            operation_name=&quot;Operation Chimera&quot;,            operator_username=&quot;bob&quot;,        )    except Exception as e:        print(f&quot;Got exception removing user from operation: {e}&quot;) &quot;&quot;&quot;    # ################ Get all Payloads #############    &quot;&quot;&quot;payloads = await mythic.get_all_payloads(mythic=mythic_instance)    print(payloads)&quot;&quot;&quot;    # ############### Download a Payload ############    &quot;&quot;&quot;payload_bytes = await mythic.download_payload(        mythic=mythic_instance, payload_uuid=&quot;04467b89-dc46-42d1-b7c4-03aca84b194c&quot;    )    print(payload_bytes)&quot;&quot;&quot;    # ############## Update a callback #############    &quot;&quot;&quot;await mythic.update_callback(        mythic=mythic_instance,        description=&quot;test set&quot;,        locked=True,        callback_id=156,        active=False,    )&quot;&quot;&quot;    # ########### Get latest Processes #######    &quot;&quot;&quot;processes = await mythic.get_latest_processes_on_host(        mythic=mythic_instance, host=&quot;SPOOKY.LOCAL&quot;    )    print(processes)&quot;&quot;&quot;    # ########## Search Files and Add Comments ###########    &quot;&quot;&quot; files = await mythic.search_files(mythic=mythic_instance, filename=&quot;apfe&quot;)    for f in files:        print(f[&quot;filename_text&quot;])        await mythic.update_file_comment(            mythic=mythic_instance, file_uuid=f[&quot;agent_file_id&quot;], comment=&quot;auto updated&quot;        ) &quot;&quot;&quot;    # ########## Get Compromised Hosts, Users, IP Addresses ###########    hosts = await mythic.get_unique_compromised_hosts(mythic=mythic_instance)    print(hosts)    users = await mythic.get_unique_compromised_accounts(mythic=mythic_instance)    print(users)    ips = await mythic.get_unique_compromised_ips(mythic=mythic_instance)    print(ips)async def new_callbacks(mythic_instance: mythic_classes.Mythic):    async for callback in mythic.subscribe_new_callbacks(mythic=mythic_instance):        print(f&quot;got new callback:\n{callback}&quot;)async def new_tasks(mythic_instance: mythic_classes.Mythic):    async for task in mythic.subscribe_new_tasks(mythic=mythic_instance, timeout=3):        print(f&quot;got new task: {task}&quot;)async def all_tasks(mythic_instance: mythic_classes.Mythic):    async for task in mythic.subscribe_all_tasks(mythic=mythic_instance):        print(f&quot;got new task: {task}&quot;)async def all_tasks_by_callback(mythic_instance: mythic_classes.Mythic, callback_id: int):    async for task in mythic.subscribe_all_tasks(        mythic=mythic_instance, callback_id=callback_id    ):        print(f&quot;got new task by callback {callback_id}: {task}&quot;)async def all_filebrowser(mythic_instance: mythic_classes.Mythic):    async for f in mythic.subscribe_all_filebrowser(mythic=mythic_instance):        print(f&quot;got all filebrowser obj: {f}&quot;)asyncio.run(main())```### Custom AttributesTo supply your own custom attributes to many of the functions, you need to have each one on their own line like follows:```custom_attributes = &quot;&quot;&quot;hostuserpayload {    id    uuid}&quot;&quot;&quot;results = await mythic.get_all_callbacks(    mythic=mythic_instance, custom_return_attributes=custom_attributes)```# InformationThe Mythic documentation has a whole section on scripting examples (https://docs.mythic-c2.net/scripting) that are useful for how to leverage this package. The `mythic` package leverages async HTTP requests and WebSocket connections, so it's important to make sure your codebase is running asynchronously. An example stub to help with this is on the Mythic documentation scripting page.## TestingTo run unit testing:```pip3 install pytest, gql[aiohttp,websockets], aiohttp, asynciomake all_tests```</longdescription>
</pkgmetadata>