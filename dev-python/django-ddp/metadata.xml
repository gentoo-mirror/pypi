<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>==========Django DDP==========`Django DDP`_ is a Django_/PostgreSQL_ implementation of the Meteor DDPserver,  allowing Meteor_ to subscribe to changes on Django_ models.Released under the MIT license.Requirements------------You must be using PostgreSQL_ with psycopg2_ in your Django_ projectfor django-ddp to work.  There is no requirement on any asynchronousframework such as Redis or crossbar.io as they are simply not neededgiven the asynchronous support provided by PostgreSQL_ with psycopg2_.Since the test suite includes an example Meteor_ project, running thatrequires that Meteor_ is installed (and `meteor` is in your `PATH`).Installation------------Install the latest release from pypi (recommended):.. code:: sh    pip install django-ddpClone and use development version direct from GitHub to test pre-releasecode (no GitHub account required):.. code:: sh    pip install -e git+https://github.com/commoncode/django-ddp@develop#egg=django-ddpOverview and getting started----------------------------1. Django DDP registers handlers for `Django signals`_ on all model save/update operations.    * Add ``'dddp'`` to INSTALLED_APPS in your project settings file.2. Each Django application (ie: your code) registers Collections and Publications via ``ddp`` sub-modules for all INSTALLED_APPS.    * Register collections and publications in a file named ``dddp.py`` inside your application module.3. Clients subscribe to publications, entries are written into the ``dddp.Subscription`` and ``dddp.SubscriptionCollection`` model tables and the ``get_queries`` method of publications are called to retrieve the Django ORM queries that contain the objects that will be sent to the client.    * Run ``manage.py migrate`` to update your database so it has the necessary tables needed for tracking client subscriptions.4. When models are saved, the Django DDP signal handlers send change messages to clients subscribed to relevant publications.    * Use the model ``save()`` and ``delete()`` methods as appropriate in your application code so that appropriate signals are raised and change messages are sent.5. Gevent_ is used to run WebSocket connections concurrently along with any Django views defined in your project (via your project ``urls.py``).    * Run your application using the ``dddp`` command which sets up the gevent mainloop and serves your Django project views.  This command takes care of routing WebSocket connections according to the URLs that Meteor uses, do not add URLs for WebSocket views to your project ``urls.py``.Scalability-----------All database queries to support DDP events are done once by the serverinstance that has made changes via the Django ORM.  Django DDP multiplexesmessages for active subscriptions, broadcasting an aggregated changemessage on channels specific to each Django model that has been published.Peer servers subscribe to aggregate broadcast events which arede-multiplexed and dispatched to individual client connections.No additional database queries are required for de-multiplexingor dispatch by peer servers.Limitations-----------* No support for the SockJS XHR fallback protocol to support browsers  that don't have WebSockets_ (see http://caniuse.com/websockets for  supported browsers).  It is noteworthy that the only current browser  listed that doesn't support WebSockets_ is Opera Mini, which doesn't  support pages that use EcmaScript (JavaScript) for interactivity  anyway.  Offering SockJS XHR fallback wouldn't help to substantially  increase browser support: if Opera Mini is excluded then all current  browser versions including IE, Edge, Firefox, Chrome, Safari, Opera,  iOS Safari, Android Browser Android and Chrome for Android are  supported.  Having said all that, pull requests are welcome.* Changes must be made via the Django ORM as django-ddp uses `Django  signals`_ to receive model save/update signals.  There are no  technical reasons why database triggers couldn't be used - pull  requests are welcome.Example usage-------------Add 'dddp' to your settings.INSTALLED_APPS:.. code:: python    # settings.py    ...    INSTALLED_APPS = list(INSTALLED_APPS) + ['dddp']If you'd like support for the Meteor Accounts package (ie: login/logoutwith django.contrib.auth) consult the section on authentication belowand use the following line instead:.. code:: python    # settings.py    ...    INSTALLED_APPS = list(INSTALLED_APPS) + ['dddp', 'dddp.accounts']Add ddp.py to your Django application:.. code:: python    # bookstore/ddp.py    from dddp.api import API, Collection, Publication    from bookstore import models    class Book(Collection):        model = models.Book    class Author(Collection):        model = models.Author    class AllBooks(Publication):        queries = [            models.Author.objects.all(),            models.Book.objects.all(),        ]    class BooksByAuthorEmail(Publication):        def get_queries(self, author_email):            return [                models.Author.objects.filter(                    email=author_email,                ),                models.Book.objects.filter(                    author__email=author_email,                ),            ]    API.register(        [Book, Author, AllBooks, BooksByAuthorEmail]    )Start the Django DDP service:.. code:: sh    DJANGO_SETTINGS_MODULE=myproject.settings dddpUsing django-ddp as a secondary DDP connection (RAPID DEVELOPMENT)------------------------------------------------------------------Running in this manner allows rapid development through use of the hotcode push features provided by Meteor.Connect your Meteor application to the Django DDP service:.. code:: javascript    // bookstore.js    if (Meteor.isClient) {        // Connect to Django DDP service        Django = DDP.connect('http://'+window.location.hostname+':8000/');        // Create local collections for Django models received via DDP        Authors = new Mongo.Collection(&quot;bookstore.author&quot;, {connection: Django});        Books = new Mongo.Collection(&quot;bookstore.book&quot;, {connection: Django});        // Subscribe to all books by Janet Evanovich        Django.subscribe('BooksByAuthorEmail', 'janet@evanovich.com');    }Start Meteor (from within your meteor application directory):.. code:: sh    meteorUsing django-ddp as the primary DDP connection (RECOMMENDED)------------------------------------------------------------If you'd prefer to not have two DDP connections (one to Meteor and oneto django-ddp) you can set the `DDP_DEFAULT_CONNECTION_URL` environmentvariable to use the specified URL as the primary DDP connection inMeteor.  When doing this, you won't need to use `DDP.connect(...)` orspecify `{connection: Django}` on your collections.  Running withdjango-ddp as the primary connection is recommended, and indeed requiredif you wish to use `dddp.accounts` to provide authentication using`django.contrib.auth` to your meteor app... code:: sh    DDP_DEFAULT_CONNECTION_URL=http://localhost:8000/ meteorServing your Meteor applications from django-ddp------------------------------------------------First, you will need to build your meteor app into a directory (examplesbelow assume target directory named `myapp`):.. code:: sh    meteor build ../myappThen, add a MeteorView to your urls.py:.. code:: python    from dddp.views import MeteorView    urlpatterns = patterns(        url('^(?P&lt;path&gt;/.*)$', MeteorView.as_view(            json_path=os.path.join(                settings.PROJ_ROOT, 'myapp', 'bundle', 'star.json',            ),        ),    )Adding API endpoints (server method definitions)------------------------------------------------API endpoints can be added by calling `register` method of thedddp.api.API object from the ddp.py module of your Django app, on asubclass of dddp.api.APIMixin - both dddp.api.Collection anddddp.api.Publication are suitable, or you may define your own subclassof dddp.api.APIMixin.  A good example of this can be seen indddp/accounts/ddp.py in the source of django-ddp.Authentication--------------Authentication is provided using the standard meteor accounts system,along with the `accounts-secure` package which turns off Meteor'spassword hashing in favour of using TLS (HTTPS + WebSockets). Thisensures strong protection for all data over the wire.  Correctly usingTLS/SSL also protects your site against man-in-the-middle and replayattacks - Meteor is vulnerable to both of these without usingencryption.Add `dddp.accounts` to your `settings.INSTALLED_APPS` as described inthe example usage section above, then add `tysonclugg:accounts-secure`to your Meteor application (from within your meteor applicationdirectory):.. code:: sh    meteor add tysonclugg:accounts-secureThen follow the normal procedure to add login/logout views to yourMeteor application.Contributors------------`Tyson Clugg &lt;https://github.com/tysonclugg&gt;`_    * Author, conceptual design.`Yan Le &lt;https://github.com/janusle&gt;`_    * Validate and bug fix dddp.accounts submodule.`MEERQAT &lt;http://meerqat.com.au/&gt;`_    * Project sponsor - many thanks for allowing this to be released under an open source license!`David Burles &lt;https://github.com/dburles&gt;`_    * Expert guidance on how DDP works in Meteor.`Brenton Cleeland &lt;https://github.com/sesh&gt;`_    * Great conversations around how collections and publications can limit visibility of published documents to specific users.`Muhammed Thanish &lt;https://github.com/mnmtanish&gt;`_    * Making the `DDP Test Suite &lt;https://github.com/meteorhacks/ddptest&gt;`_ available.This project is forever grateful for the love, support and respect givenby the awesome team at `Common Code`_... _Django DDP: https://github.com/django-ddp/django-ddp.. _Django: https://www.djangoproject.com/.. _Django signals: https://docs.djangoproject.com/en/stable/topics/signals/.. _Common Code: https://commoncode.com.au/.. _Gevent: http://www.gevent.org/.. _PostgreSQL: http://postgresql.org/.. _psycopg2: http://initd.org/psycopg/.. _WebSockets: http://www.w3.org/TR/websockets/.. _Meteor: http://meteor.com/</longdescription>
</pkgmetadata>