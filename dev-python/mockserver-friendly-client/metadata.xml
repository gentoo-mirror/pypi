<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># MockServer Python Client[![Build Status](https://travis-ci.org/internap/python-mockserver-friendly-client.svg?branch=master)](https://travis-ci.org/internap/python-mockserver-friendly-client)Python client to James D. Bloom's awesome MockServer : http://www.mock-server.com/## PhilosophyTests should be readable and Mock Server is already very complete and customizable.  This library tries to keep itsimple and straight-forward using python's kwargs to avoid big declarations.We think a mock should be able to fit into one 120 char line of code should the expectation be simple enough :) ```client.stub(request(method=&quot;GET&quot;, path=&quot;/auth&quot;), response(code=401, body=&quot;unauthorized&quot;))```## InstallationWARNING: **THIS IS A VERY EARLY VERSION THE API IS MOST LIKELY TO CHANGE**From source:```git clone https://github.com/internap/python-mockserver-friendly-client.gitcd python-mockserver-friendly-clientpython setup.py install```From [PyPi](https://pypi.org/) directly:```pip install mockserver-friendly-client```## PrerequisiteYou need a running MockServer running, see http://www.mock-server.com/mock_server/getting_started.html#start_mockserverThis project's tests uses the docker image : https://github.com/internap/python-mockserver-friendly-client/blob/master/docker-compose.yml## Usage**The whole Mock Server API is not all covered**. We just implemented what we needed, if you need something not yetimplemented you can open an issue and/or contribute### *Stubbing*(For when you are testing what your code *DOES* with another component's data)```from mockserver import MockServerClient, request, responseclient = MockServerClient(&quot;http://localhost:1080&quot;)client.stub(    request(method=&quot;GET&quot;, path=&quot;/that/thing&quot;, querystring={&quot;is&quot;: &quot;good&quot;}, headers={&quot;so&quot;: &quot;good&quot;}),    response(code=418, body=&quot;i'm a teapot&quot;, headers={&quot;hi&quot;: &quot;haa&quot;}))```* You can also add a `times(N)` as a third parameter to limit how many times this stub can be called, default is unlimited* All parameters are always optional.  When not specified, the match everything.### *Expecting*(For when calling another component *IS* what you are testing)Using the `expect` will remember the request and verify it when `verify_expectations` is called.```import jsonfrom mockserver import MockServerClient, request, response, timesclient = MockServerClient(&quot;http://localhost:1080&quot;)client.expect(    request(method=&quot;POST&quot;, path=&quot;/postme&quot;, body=json.dumps({&quot;some&quot;: &quot;json&quot;})),    response(code=204, body=json.dumps({&quot;return&quot;: &quot;something&quot;}), headers={&quot;Content-Type&quot;: &quot;application/json&quot;}),    times(1))client.verify_expectations()  # AssertionError !```* The `times(N)` parameter is mandatory for expect### *Resetting*(Because tests shouldn't impact each other)```from mockserver import MockServerClientclient = MockServerClient(&quot;http://localhost:1080&quot;)client.reset()```## Customizing and shortcutsThis client consumes Mock Server's REST API : https://app.swaggerhub.com/apis/jamesdbloom/mock-server-openapiHere's a few shortcuts already ready, there may be more to come### Mocking a form post```from mockserver import MockServerClient, request, response, formclient = MockServerClient(&quot;http://localhost:1080&quot;)client.stub(    request(method=&quot;POST&quot;, body=form({&quot;user&quot;: &quot;foo&quot;, &quot;pass&quot;: &quot;bar&quot;})),    response(code=201))```This currently takes a 1 level `dict`. For array mocking, use `{&quot;key[index]&quot;: &quot;value&quot;}` ### Returning JSON```from mockserver import MockServerClient, request, json_responseclient = MockServerClient(&quot;http://localhost:1080&quot;)client.stub(    request(path=&quot;/stuff&quot;),    json_response(code=200, body={&quot;full&quot;: &quot;json&quot;, &quot;structure&quot;: [&quot;with&quot;, &quot;stuff&quot;, 1]}))```This automatically dumps the body in json and appends the `application/json` Content-Type to the headers.### Expecting JSON request```from mockserver import MockServerClient, request, json_equalsclient = MockServerClient(&quot;http://localhost:1080&quot;)client.expect(    request(body=json_equals({&quot;key&quot;: &quot;value&quot;})),    response(),    times(1))```This only matches requests with the provided json body. Json conversation is done automatically.If you only want to match parts of a given JSON you can provide only the matching parts using `json_contains`:```from mockserver import MockServerClient, request, json_containsclient = MockServerClient(&quot;http://localhost:1080&quot;)client.expect(    request(body=json_contains({&quot;key&quot;: &quot;value&quot;})),    response(),    times(1))```I.e. this will match `{&quot;key&quot;: &quot;value&quot;}` or `{&quot;key&quot;: &quot;value&quot;, &quot;another&quot;: &quot;key&quot;}`### Verifying request```from mockserver import MockServerClient, request, timesclient = MockServerClient(&quot;http://localhost:1080&quot;)client.verify(    request(path=&quot;/some_path&quot;, querystring({&quot;key&quot;: &quot;value&quot;})),    times(1))```Verify will check request on MockServer and raise AssertionError if request not found.## More documentationThere is currently no official documentation, however you can consider the tests as a type of documentation, they arepretty explicit and simple to follow and help to clarify the purpose of each feature.## Good practicesHaving your test setup/teardown like this is probably a good idea.```class ServerMockingTestBase(...):    def setUp(self):        super(ServerMockingTestBase, self).setUp()                self.client = MockServerClient(MOCK_SERVER_URL)        self.client.reset()    def tearDown(self):        super(ServerMockingTestBase, self).tearDown()                self.client.verify_expectations()```# TroubleshootingChecking MockServer's logs is the first place to go.  If you don't see any logs, try another LOG_LEVEL such as INFO.If the problem is in the code, please open an issue :)# ContributingThe form may not be final, we would love to hear what you think of the client!Feel free to raise issues and send some pull request, we'll be happy to look at them!Make sure all new code is tested, current tests run against a MockServer container.## Running testsYou can easily run the tests with https://pypi.python.org/pypi/tox```tox -e py34```You can also call the `test-runner.sh` directly, you will need https://pypi.python.org/pypi/nose installedYou can also launch the container```docker-compose up-d```and run the tests in your favorite IDE :)</longdescription>
</pkgmetadata>