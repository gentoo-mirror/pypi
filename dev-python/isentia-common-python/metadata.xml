<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Isentia common tools for PythonThis library collects tools and code that are shared across repositories and projects within Isentia.## Instructions to use this libraryInstallation is simple:```shpip install isentia-common-python```Right now the library only contains json logging code. We might add more features later.## JSON loggingAuthors: Neville Tummon, Toney Thomas, Koen DouterloignePlace the following somewhere near the start of your app.```pythonfrom isentia_common.log import init_json_logginginit_json_logging(&quot;my_namespace&quot;)```Now use logging just like you always do.```pythonimport logginglogging.info(&quot;Hello world!&quot;)logging.warning(&quot;Hello world!&quot;, extra={&quot;http_code&quot;: 418, &quot;reply&quot;: &quot;I'm a teapot&quot;})```This will print```{&quot;asctime&quot;: &quot;2020-07-06 13:01:46,859&quot;, &quot;name&quot;: &quot;root&quot;, &quot;levelname&quot;: &quot;INFO&quot;, &quot;message&quot;: &quot;Hello world!&quot;}{&quot;asctime&quot;: &quot;2020-07-06 13:01:46,859&quot;, &quot;name&quot;: &quot;root&quot;, &quot;levelname&quot;: &quot;WARNING&quot;, &quot;message&quot;: &quot;Hello world!&quot;, &quot;my_namespace&quot;: {&quot;http_code&quot;: 418, &quot;reply&quot;: &quot;I'm a teapot&quot;}}```As you see, it structures the output as JSON and adds the typical fields. You can use the &quot;extra&quot; parameter when logging objects. All objects logged like this will be put into the namespace that you specified in the init call, when you did `init_json_logging(&quot;my_namespace&quot;)`.The namespacing makes it very easy to search through your logs in tools like ElasticSearch / Kibana. In particular, it prevents conflicts with other teams or projects that want to use the same field names.By default, the logging level is set to INFO. You can override this just like normal, using```pythonlogging.getLogger().setLevel(logging.DEBUG)```### More fieldsBy default we only print the time, logger name (usually root), level, message and extra fields. If you need more visibility, you can enable `extended` mode.```pythoninit_json_logging(&quot;my_namespace&quot;, extended=True)logging.info(&quot;Hello world!&quot;)```Enabling `extended` will also include process id, filename, lineno and funcname in the JSON:```{&quot;asctime&quot;: &quot;2020-07-06 13:48:38,015&quot;, &quot;name&quot;: &quot;root&quot;, &quot;levelname&quot;: &quot;INFO&quot;, &quot;message&quot;: &quot;Hello world!&quot;, &quot;process&quot;: 8015, &quot;filename&quot;: &quot;inspect_logging.py&quot;, &quot;lineno&quot;: 8, &quot;funcName&quot;: &quot;&lt;module&gt;&quot;}```### Module-level loggersAll Python logging will output JSON. In particular, module-level loggers will also log to JSON. (As an aside, code typically does not require module level loggers)```pythonmodule_lvl_logger = logging.getLogger(&quot;special.module&quot;)module_lvl_logger.setLevel(logging.DEBUG)module_lvl_logger.debug(    &quot;an info message&quot;, extra={&quot;http_status_code&quot;: 200, &quot;endpoint&quot;: &quot;/api/no-problemo&quot;})```will print```{&quot;asctime&quot;: &quot;2020-07-06 13:01:46,859&quot;, &quot;name&quot;: &quot;special.module&quot;, &quot;levelname&quot;: &quot;DEBUG&quot;, &quot;message&quot;: &quot;an info message&quot;, &quot;my_namespace&quot;: {&quot;http_status_code&quot;: 200, &quot;endpoint&quot;: &quot;/api/no-problemo&quot;}}```Only the &quot;name&quot; field changes.### Global overrideNow you may be thinking: Great, all fields are namespaced, but what if I want to track a field across projects / apps? Like traceID or summary_id? I still want my apps to have different namespaces, but I also want to be able to log some fields that are global, i.e. that live outside of the namespace.For this usecase we've made the extra field &quot;global&quot; a special field, which gets moved out of the &quot;extra&quot;. Look at the following example:```pythonimport logginglogging.info(&quot;Hello world!&quot;, extra={&quot;http_code&quot;: 418, &quot;reply&quot;: &quot;I'm a teapot&quot;, &quot;global&quot;: {&quot;request_id&quot;: 50}})```This will print```{&quot;asctime&quot;: &quot;2020-07-06 13:01:46,859&quot;, &quot;name&quot;: &quot;root&quot;, &quot;levelname&quot;: &quot;INFO&quot;, &quot;message&quot;: &quot;info with global&quot;, &quot;global&quot;: {&quot;request_id&quot;: 50}, &quot;my_app_name&quot;: {&quot;http_code&quot;: 418, &quot;reply&quot;: &quot;I'm a teapot&quot;}}```In short, the field &quot;global&quot; is like a shared namespace. Only put in there what you need, as you might clash with other teams.### ConstantsIf you wish a global variable to be included with every log message (e.g. a trace_id or request_id)you can set this in the init call.```pythoninit_json_logging('my_namespace', constants={'trace_id':123})logging.info(&quot;Hello world!&quot;, extra={&quot;http_code&quot;: 418, &quot;reply&quot;: &quot;I'm a teapot&quot;, &quot;global&quot;: {&quot;request_id&quot;: 50}})```This will print```{&quot;asctime&quot;: &quot;2020-07-06 13:01:46,859&quot;, &quot;name&quot;: &quot;root&quot;, &quot;levelname&quot;: &quot;INFO&quot;, &quot;message&quot;: &quot;info with global&quot;, &quot;global&quot;: {&quot;trace_id&quot;:123, &quot;request_id&quot;: 50}, &quot;my_app_name&quot;: {&quot;http_code&quot;: 418, &quot;reply&quot;: &quot;I'm a teapot&quot;}}```And every other message will include the trace_id in global namespace.### Low-level detailsThis library is built on top of [python-json-logger](https://github.com/madzak/python-json-logger). We extended python-json-logger via monkey-patching to add the concept of namespacing and global overrides.</longdescription>
</pkgmetadata>