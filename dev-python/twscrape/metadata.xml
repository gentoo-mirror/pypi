<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># twscrape&lt;div align=&quot;center&quot; style=&quot;padding-bottom: 8px&quot;&gt;  &lt;a href=&quot;https://pypi.org/project/twscrape&quot;&gt;    &lt;img src=&quot;https://badgen.net/pypi/v/twscrape&quot; alt=&quot;version&quot; /&gt;  &lt;/a&gt;  &lt;a href=&quot;https://pypi.org/project/twscrape&quot;&gt;    &lt;img src=&quot;https://badgen.net/pypi/python/twscrape&quot; alt=&quot;python versions&quot; /&gt;  &lt;/a&gt;  &lt;a href=&quot;https://github.com/vladkens/twscrape/actions&quot;&gt;    &lt;img src=&quot;https://github.com/vladkens/twscrape/workflows/test/badge.svg&quot; alt=&quot;test status&quot; /&gt;  &lt;/a&gt;  &lt;a href=&quot;https://pypi.org/project/twscrape&quot;&gt;    &lt;img src=&quot;https://badgen.net/pypi/dm/twscrape&quot; alt=&quot;downloads&quot; /&gt;  &lt;/a&gt;  &lt;a href=&quot;https://github.com/vladkens/twscrape/blob/main/LICENSE&quot;&gt;    &lt;img src=&quot;https://badgen.net/github/license/vladkens/twscrape&quot; alt=&quot;license&quot; /&gt;  &lt;/a&gt;&lt;/div&gt;Twitter GraphQL API implementation with [SNScrape](https://github.com/JustAnotherArchivist/snscrape) data models.&lt;div align=&quot;center&quot;&gt;  &lt;img src=&quot;https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0erkeMBhl_qqRofIeU5jMQ.png&quot; alt=&quot;example of cli usage&quot; width=&quot;560px&quot;&gt;&lt;/div&gt;## Install```bashpip install twscrape```Or development version:```bashpip install git+https://github.com/vladkens/twscrape.git```## Features- Support both Search &amp; GraphQL Twitter API- Async/Await functions (can run multiple scrapers in parallel at the same time)- Login flow (with receiving verification code from email)- Saving/restoring account sessions- Raw Twitter API responses &amp; SNScrape models- Automatic account switching to smooth Twitter API rate limits## UsageSince this project works through an authorized API, accounts need to be added. You can register and add an account yourself. You can also google sites that provide these things.The email password is needed to get the code to log in to the account automatically (via imap protocol).Data models:- [User](https://github.com/vladkens/twscrape/blob/main/twscrape/models.py#L87)- [Tweet](https://github.com/vladkens/twscrape/blob/main/twscrape/models.py#L136)```pythonimport asynciofrom twscrape import API, gatherfrom twscrape.logger import set_log_levelasync def main():    api = API()  # or API(&quot;path-to.db&quot;) - default is `accounts.db`    # ADD ACCOUNTS (for CLI usage see BELOW)    await api.pool.add_account(&quot;user1&quot;, &quot;pass1&quot;, &quot;u1@example.com&quot;, &quot;mail_pass1&quot;)    await api.pool.add_account(&quot;user2&quot;, &quot;pass2&quot;, &quot;u2@example.com&quot;, &quot;mail_pass2&quot;)    await api.pool.login_all()    # or add account with COOKIES (with cookies login not required)    cookies = &quot;abc=12; ct0=xyz&quot;  # or '{&quot;abc&quot;: &quot;12&quot;, &quot;ct0&quot;: &quot;xyz&quot;}'    await api.pool.add_account(&quot;user3&quot;, &quot;pass3&quot;, &quot;u3@mail.com&quot;, &quot;mail_pass3&quot;, cookies=cookies)    # add account with PROXY    proxy = &quot;http://login:pass@example.com:8080&quot;    await api.pool.add_account(&quot;user4&quot;, &quot;pass4&quot;, &quot;u4@mail.com&quot;, &quot;mail_pass4&quot;, proxy=proxy)    # API USAGE    # search (latest tab)    await gather(api.search(&quot;elon musk&quot;, limit=20))  # list[Tweet]    # change search tab (product), can be: Top, Latest (default), Media    await gather(api.search(&quot;elon musk&quot;, limit=20, kv={&quot;product&quot;: &quot;Top&quot;}))    # tweet info    tweet_id = 20    await api.tweet_details(tweet_id)  # Tweet    await gather(api.retweeters(tweet_id, limit=20))  # list[User]    await gather(api.favoriters(tweet_id, limit=20))  # list[User]    # get user by login    user_login = &quot;xdevelopers&quot;    await api.user_by_login(user_login)  # User    # user info    user_id = 2244994945    await api.user_by_id(user_id)  # User    await gather(api.followers(user_id, limit=20))  # list[User]    await gather(api.following(user_id, limit=20))  # list[User]    await gather(api.user_tweets(user_id, limit=20))  # list[Tweet]    await gather(api.user_tweets_and_replies(user_id, limit=20))  # list[Tweet]    # list info    list_id = 123456789    await gather(api.list_timeline(list_id))    # NOTE 1: gather is a helper function to receive all data as list, FOR can be used as well:    async for tweet in api.search(&quot;elon musk&quot;):        print(tweet.id, tweet.user.username, tweet.rawContent)  # tweet is `Tweet` object    # NOTE 2: all methods have `raw` version (returns `httpx.Response` object):    async for rep in api.search_raw(&quot;elon musk&quot;):        print(rep.status_code, rep.json())  # rep is `httpx.Response` object    # change log level, default info    set_log_level(&quot;DEBUG&quot;)    # Tweet &amp; User model can be converted to regular dict or json, e.g.:    doc = await api.user_by_id(user_id)  # User    doc.dict()  # -&gt; python dict    doc.json()  # -&gt; json stringif __name__ == &quot;__main__&quot;:    asyncio.run(main())```### Stoping iteration with breakIn order to correctly release an account in case of `break` in loop, a special syntax must be used. Otherwise, Python's events loop will release lock on the account sometime in the future. See explanation [here](https://github.com/vladkens/twscrape/issues/27#issuecomment-1623395424).```pythonfrom contextlib import aclosingasync with aclosing(api.search(&quot;elon musk&quot;)) as gen:    async for tweet in gen:        if tweet.id &lt; 200:            break```## CLI### Get help on CLI commands```sh# show all commandstwscrape# help on specific comandtwscrape search --help```### Add accounts &amp; loginFirst add accounts from file:```sh# twscrape add_accounts &lt;file_path&gt; &lt;line_format&gt;# line_format should have &quot;username&quot;, &quot;password&quot;, &quot;email&quot;, &quot;email_password&quot; tokens# note: tokens delimeter should be same as an filetwscrape add_accounts ./accounts.txt username:password:email:email_password```Then call login:```shtwscrape login_accounts```Accounts and their sessions will be saved, so they can be reused for future requestsNote: Possible to use `_` in `line_format` to skip some value### Add accounts with cookiesUse `cookies` param in `line_format`, e.g.:```shtwscrape add_accounts ./accounts.txt username:password:email:email_password:cookies```In this case login not required.### Get list of accounts and their statuses```shtwscrape accounts# Output:# username  logged_in  active  last_used            total_req  error_msg# user1     True       True    2023-05-20 03:20:40  100        None# user2     True       True    2023-05-20 03:25:45  120        None# user3     False      False   None                 120        Login error```### Re-login accountsIt is possible to re-login specific accounts:```shtwscrape relogin user1 user2```Or retry login for all failed logins:```shtwscrape relogin_failed```### Use different accounts fileUseful if using a different set of accounts for different actions```twscrape --db test-accounts.db &lt;command&gt;```### Search commands```shtwscrape search &quot;QUERY&quot; --limit=20twscrape tweet_details TWEET_IDtwscrape retweeters TWEET_ID --limit=20twscrape favoriters TWEET_ID --limit=20twscrape user_by_id USER_IDtwscrape user_by_login USERNAMEtwscrape followers USER_ID --limit=20twscrape following USER_ID --limit=20twscrape user_tweets USER_ID --limit=20twscrape user_tweets_and_replies USER_ID --limit=20```The default output is in the console (stdout), one document per line. So it can be redirected to the file.```shtwscrape search &quot;elon mask lang:es&quot; --limit=20 &gt; data.txt```By default, parsed data is returned. The original tweet responses can be retrieved with `--raw` flag.```shtwscrape search &quot;elon mask lang:es&quot; --limit=20 --raw```## LimitationsAfter 1 July 2023 Twitter [introduced new limits](https://twitter.com/elonmusk/status/1675187969420828672) and still continue to update it periodically.The basic behaviour is as follows:- the reqest limit is updated every 15 minutes for each endpoint individually- e.g. each account have 50 search requests / 15 min, 50 profile requests / 15 min, etc.API data limits:- `user_tweets` &amp; `user_tweets_and_replies` – can return ~3200 tweets maximum## Articles- [How to still scrape millions of tweets in 2023](https://medium.com/@vladkens/how-to-still-scrape-millions-of-tweets-in-2023-using-twscrape-97f5d3881434)- [_(Add Article)_](https://github.com/vladkens/twscrape/edit/main/readme.md)## See also- [twitter-advanced-search](https://github.com/igorbrigadir/twitter-advanced-search) – guide on search filters- [twitter-api-client](https://github.com/trevorhobenshield/twitter-api-client) – Implementation of Twitter's v1, v2, and GraphQL APIs- [snscrape](https://github.com/JustAnotherArchivist/snscrape) – is a scraper for social networking services (SNS)- [twint](https://github.com/twintproject/twint) – Twitter Intelligence Tool</longdescription>
</pkgmetadata>